!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=!!e&&"length"in e&&e.length,n=re.type(e);return"function"!==n&&!re.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function r(e,t,n){if(re.isFunction(t))return re.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return re.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(he.test(t))return re.filter(t,e,n);t=re.filter(t,e)}return re.grep(e,function(e){return K.call(t,e)>-1!==n})}function o(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function a(e){var t={};return re.each(e.match(ye)||[],function(e,n){t[n]=!0}),t}function i(){Y.removeEventListener("DOMContentLoaded",i),e.removeEventListener("load",i),re.ready()}function s(){this.expando=re.expando+s.uid++}function l(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(Me,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Pe.test(n)?re.parseJSON(n):n)}catch(e){}Ce.set(e,t,n)}else n=void 0;return n}function u(e,t,n,r){var o,a=1,i=20,s=r?function(){return r.cur()}:function(){return re.css(e,t,"")},l=s(),u=n&&n[3]||(re.cssNumber[t]?"":"px"),c=(re.cssNumber[t]||"px"!==u&&+l)&&Ie.exec(re.css(e,t));if(c&&c[3]!==u){u=u||c[3],n=n||[],c=+l||1;do{c/=a=a||".5",re.style(e,t,c+u)}while(a!==(a=s()/l)&&1!==a&&--i)}return n&&(c=+c||+l||0,o=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=c,r.end=o)),o}function c(e,t){var n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&re.nodeName(e,t)?re.merge([e],n):n}function d(e,t){for(var n=0,r=e.length;n<r;n++)Te.set(e[n],"globalEval",!t||Te.get(t[n],"globalEval"))}function f(e,t,n,r,o){for(var a,i,s,l,u,f,h=t.createDocumentFragment(),m=[],p=0,g=e.length;p<g;p++)if((a=e[p])||0===a)if("object"===re.type(a))re.merge(m,a.nodeType?[a]:a);else if(je.test(a)){for(i=i||h.appendChild(t.createElement("div")),s=(_e.exec(a)||["",""])[1].toLowerCase(),l=Ae[s]||Ae._default,i.innerHTML=l[1]+re.htmlPrefilter(a)+l[2],f=l[0];f--;)i=i.lastChild;re.merge(m,i.childNodes),(i=h.firstChild).textContent=""}else m.push(t.createTextNode(a));for(h.textContent="",p=0;a=m[p++];)if(r&&re.inArray(a,r)>-1)o&&o.push(a);else if(u=re.contains(a.ownerDocument,a),i=c(h.appendChild(a),"script"),u&&d(i),n)for(f=0;a=i[f++];)ke.test(a.type||"")&&n.push(a);return h}function h(){return!0}function m(){return!1}function p(){try{return Y.activeElement}catch(e){}}function g(e,t,n,r,o,a){var i,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)g(e,s,n,r,t[s],a);return e}if(null==r&&null==o?(o=n,r=n=void 0):null==o&&("string"==typeof n?(o=r,r=void 0):(o=r,r=n,n=void 0)),!1===o)o=m;else if(!o)return e;return 1===a&&(i=o,(o=function(e){return re().off(e),i.apply(this,arguments)}).guid=i.guid||(i.guid=re.guid++)),e.each(function(){re.event.add(this,t,o,r,n)})}function v(e,t){return re.nodeName(e,"table")&&re.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function y(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function b(e){var t=Ue.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function x(e,t){var n,r,o,a,i,s,l,u;if(1===t.nodeType){if(Te.hasData(e)&&(a=Te.access(e),i=Te.set(t,a),u=a.events)){delete i.handle,i.events={};for(o in u)for(n=0,r=u[o].length;n<r;n++)re.event.add(t,o,u[o][n])}Ce.hasData(e)&&(s=Ce.access(e),l=re.extend({},s),Ce.set(t,l))}}function w(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Oe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function T(e,t,n,r){t=J.apply([],t);var o,a,i,s,l,u,d=0,h=e.length,m=h-1,p=t[0],g=re.isFunction(p);if(g||h>1&&"string"==typeof p&&!ne.checkClone&&Fe.test(p))return e.each(function(o){var a=e.eq(o);g&&(t[0]=p.call(this,o,a.html())),T(a,t,n,r)});if(h&&(o=f(t,e[0].ownerDocument,!1,e,r),a=o.firstChild,1===o.childNodes.length&&(o=a),a||r)){for(s=(i=re.map(c(o,"script"),y)).length;d<h;d++)l=o,d!==m&&(l=re.clone(l,!0,!0),s&&re.merge(i,c(l,"script"))),n.call(e[d],l,d);if(s)for(u=i[i.length-1].ownerDocument,re.map(i,b),d=0;d<s;d++)l=i[d],ke.test(l.type||"")&&!Te.access(l,"globalEval")&&re.contains(u,l)&&(l.src?re._evalUrl&&re._evalUrl(l.src):re.globalEval(l.textContent.replace(ze,"")))}return e}function C(e,t,n){for(var r,o=t?re.filter(t,e):e,a=0;null!=(r=o[a]);a++)n||1!==r.nodeType||re.cleanData(c(r)),r.parentNode&&(n&&re.contains(r.ownerDocument,r)&&d(c(r,"script")),r.parentNode.removeChild(r));return e}function P(e,t){var n=re(t.createElement(e)).appendTo(t.body),r=re.css(n[0],"display");return n.detach(),r}function M(e){var t=Y,n=Ve[e];return n||("none"!==(n=P(e,t))&&n||((t=(qe=(qe||re("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=P(e,t),qe.detach()),Ve[e]=n),n}function S(e,t,n){var r,o,a,i,s=e.style;return n=n||Ge(e),""!==(i=n?n.getPropertyValue(t)||n[t]:void 0)&&void 0!==i||re.contains(e.ownerDocument,e)||(i=re.style(e,t)),n&&!ne.pixelMarginRight()&&We.test(i)&&He.test(t)&&(r=s.width,o=s.minWidth,a=s.maxWidth,s.minWidth=s.maxWidth=s.width=i,i=n.width,s.width=r,s.minWidth=o,s.maxWidth=a),void 0!==i?i+"":i}function I(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}function D(e){if(e in et)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=Ze.length;n--;)if((e=Ze[n]+t)in et)return e}function E(e,t,n){var r=Ie.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function O(e,t,n,r,o){for(var a=n===(r?"border":"content")?4:"width"===t?1:0,i=0;a<4;a+=2)"margin"===n&&(i+=re.css(e,n+De[a],!0,o)),r?("content"===n&&(i-=re.css(e,"padding"+De[a],!0,o)),"margin"!==n&&(i-=re.css(e,"border"+De[a]+"Width",!0,o))):(i+=re.css(e,"padding"+De[a],!0,o),"padding"!==n&&(i+=re.css(e,"border"+De[a]+"Width",!0,o)));return i}function _(e,t,n){var r=!0,o="width"===t?e.offsetWidth:e.offsetHeight,a=Ge(e),i="border-box"===re.css(e,"boxSizing",!1,a);if(o<=0||null==o){if(((o=S(e,t,a))<0||null==o)&&(o=e.style[t]),We.test(o))return o;r=i&&(ne.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+O(e,t,n||(i?"border":"content"),r,a)+"px"}function k(e,t){for(var n,r,o,a=[],i=0,s=e.length;i<s;i++)(r=e[i]).style&&(a[i]=Te.get(r,"olddisplay"),n=r.style.display,t?(a[i]||"none"!==n||(r.style.display=""),""===r.style.display&&Ee(r)&&(a[i]=Te.access(r,"olddisplay",M(r.nodeName)))):(o=Ee(r),"none"===n&&o||Te.set(r,"olddisplay",o?n:re.css(r,"display"))));for(i=0;i<s;i++)(r=e[i]).style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?a[i]||"":"none"));return e}function A(e,t,n,r,o){return new A.prototype.init(e,t,n,r,o)}function j(){return e.setTimeout(function(){tt=void 0}),tt=re.now()}function R(e,t){var n,r=0,o={height:e};for(t=t?1:0;r<4;r+=2-t)o["margin"+(n=De[r])]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function $(e,t,n){for(var r,o=(B.tweeners[t]||[]).concat(B.tweeners["*"]),a=0,i=o.length;a<i;a++)if(r=o[a].call(n,t,e))return r}function L(e,t){var n,r,o,a,i;for(n in e)if(r=re.camelCase(n),o=t[r],a=e[n],re.isArray(a)&&(o=a[1],a=e[n]=a[0]),n!==r&&(e[r]=a,delete e[n]),(i=re.cssHooks[r])&&"expand"in i){a=i.expand(a),delete e[r];for(n in a)n in e||(e[n]=a[n],t[n]=o)}else t[r]=o}function B(e,t,n){var r,o,a=0,i=B.prefilters.length,s=re.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=tt||j(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),a=0,i=u.tweens.length;a<i;a++)u.tweens[a].run(r);return s.notifyWith(e,[u,r,n]),r<1&&i?n:(s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:re.extend({},t),opts:re.extend(!0,{specialEasing:{},easing:re.easing._default},n),originalProperties:t,originalOptions:n,startTime:tt||j(),duration:n.duration,tweens:[],createTween:function(t,n){var r=re.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(o)return this;for(o=!0;n<r;n++)u.tweens[n].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),c=u.props;for(L(c,u.opts.specialEasing);a<i;a++)if(r=B.prefilters[a].call(u,e,c,u.opts))return re.isFunction(r.stop)&&(re._queueHooks(u.elem,u.opts.queue).stop=re.proxy(r.stop,r)),r;return re.map(c,$,u),re.isFunction(u.opts.start)&&u.opts.start.call(e,u),re.fx.timer(re.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function N(e){return e.getAttribute&&e.getAttribute("class")||""}function F(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,o=0,a=t.toLowerCase().match(ye)||[];if(re.isFunction(n))for(;r=a[o++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function U(e,t,n,r){function o(s){var l;return a[s]=!0,re.each(e[s]||[],function(e,s){var u=s(t,n,r);return"string"!=typeof u||i||a[u]?i?!(l=u):void 0:(t.dataTypes.unshift(u),o(u),!1)}),l}var a={},i=e===Ct;return o(t.dataTypes[0])||!a["*"]&&o("*")}function z(e,t){var n,r,o=re.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:r||(r={}))[n]=t[n]);return r&&re.extend(!0,e,r),e}function q(e,t,n){for(var r,o,a,i,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(o in s)if(s[o]&&s[o].test(r)){l.unshift(o);break}if(l[0]in n)a=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){a=o;break}i||(i=o)}a=a||i}if(a)return a!==l[0]&&l.unshift(a),n[a]}function V(e,t,n,r){var o,a,i,s,l,u={},c=e.dataTypes.slice();if(c[1])for(i in e.converters)u[i.toLowerCase()]=e.converters[i];for(a=c.shift();a;)if(e.responseFields[a]&&(n[e.responseFields[a]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=c.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(i=u[l+" "+a]||u["* "+a]))for(o in u)if((s=o.split(" "))[1]===a&&(i=u[l+" "+s[0]]||u["* "+s[0]])){!0===i?i=u[o]:!0!==u[o]&&(a=s[0],c.unshift(s[1]));break}if(!0!==i)if(i&&e.throws)t=i(t);else try{t=i(t)}catch(e){return{state:"parsererror",error:i?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}function H(e,t,n,r){var o;if(re.isArray(t))re.each(t,function(t,o){n||It.test(e)?r(e,o):H(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,n,r)});else if(n||"object"!==re.type(t))r(e,t);else for(o in t)H(e+"["+o+"]",t[o],n,r)}function W(e){return re.isWindow(e)?e:9===e.nodeType&&e.defaultView}var G=[],Y=e.document,X=G.slice,J=G.concat,Q=G.push,K=G.indexOf,Z={},ee=Z.toString,te=Z.hasOwnProperty,ne={},re=function(e,t){return new re.fn.init(e,t)},oe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ae=/^-ms-/,ie=/-([\da-z])/gi,se=function(e,t){return t.toUpperCase()};re.fn=re.prototype={jquery:"2.2.4",constructor:re,selector:"",length:0,toArray:function(){return X.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:X.call(this)},pushStack:function(e){var t=re.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return re.each(this,e)},map:function(e){return this.pushStack(re.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(X.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:Q,sort:G.sort,splice:G.splice},re.extend=re.fn.extend=function(){var e,t,n,r,o,a,i=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof i&&(u=i,i=arguments[s]||{},s++),"object"==typeof i||re.isFunction(i)||(i={}),s===l&&(i=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)n=i[t],i!==(r=e[t])&&(u&&r&&(re.isPlainObject(r)||(o=re.isArray(r)))?(o?(o=!1,a=n&&re.isArray(n)?n:[]):a=n&&re.isPlainObject(n)?n:{},i[t]=re.extend(u,a,r)):void 0!==r&&(i[t]=r));return i},re.extend({expando:"jQuery"+("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===re.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!re.isArray(e)&&t-parseFloat(t)+1>=0},isPlainObject:function(e){var t;if("object"!==re.type(e)||e.nodeType||re.isWindow(e))return!1;if(e.constructor&&!te.call(e,"constructor")&&!te.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;for(t in e);return void 0===t||te.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Z[ee.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=re.trim(e))&&(1===e.indexOf("use strict")?((t=Y.createElement("script")).text=e,Y.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(ae,"ms-").replace(ie,se)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var r,o=0;if(n(e))for(r=e.length;o<r&&!1!==t.call(e[o],o,e[o]);o++);else for(o in e)if(!1===t.call(e[o],o,e[o]))break;return e},trim:function(e){return null==e?"":(e+"").replace(oe,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?re.merge(r,"string"==typeof e?[e]:e):Q.call(r,e)),r},inArray:function(e,t,n){return null==t?-1:K.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,o=e.length;r<n;r++)e[o++]=t[r];return e.length=o,e},grep:function(e,t,n){for(var r=[],o=0,a=e.length,i=!n;o<a;o++)!t(e[o],o)!==i&&r.push(e[o]);return r},map:function(e,t,r){var o,a,i=0,s=[];if(n(e))for(o=e.length;i<o;i++)null!=(a=t(e[i],i,r))&&s.push(a);else for(i in e)null!=(a=t(e[i],i,r))&&s.push(a);return J.apply([],s)},guid:1,proxy:function(e,t){var n,r,o;if("string"==typeof t&&(n=e[t],t=e,e=n),re.isFunction(e))return r=X.call(arguments,2),o=function(){return e.apply(t||this,r.concat(X.call(arguments)))},o.guid=e.guid=e.guid||re.guid++,o},now:Date.now,support:ne}),"function"==typeof Symbol&&(re.fn[Symbol.iterator]=G[Symbol.iterator]),re.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()});var le=function(e){function t(e,t,n,r){var o,a,i,s,u,d,f,h,m=t&&t.ownerDocument,p=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==p&&9!==p&&11!==p)return n;if(!r&&((t?t.ownerDocument||t:B)!==O&&E(t),t=t||O,k)){if(11!==p&&(d=pe.exec(e)))if(o=d[1]){if(9===p){if(!(i=t.getElementById(o)))return n;if(i.id===o)return n.push(i),n}else if(m&&(i=m.getElementById(o))&&$(t,i)&&i.id===o)return n.push(i),n}else{if(d[2])return J.apply(n,t.getElementsByTagName(e)),n;if((o=d[3])&&b.getElementsByClassName&&t.getElementsByClassName)return J.apply(n,t.getElementsByClassName(o)),n}if(b.qsa&&!q[e+" "]&&(!A||!A.test(e))){if(1!==p)m=t,h=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(ve,"\\$&"):t.setAttribute("id",s=L),a=(f=C(e)).length,u=ce.test(s)?"#"+s:"[id='"+s+"']";a--;)f[a]=u+" "+c(f[a]);h=f.join(","),m=ge.test(e)&&l(t.parentNode)||t}if(h)try{return J.apply(n,m.querySelectorAll(h)),n}catch(e){}finally{s===L&&t.removeAttribute("id")}}}return M(e.replace(ae,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>x.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[L]=!0,e}function o(e){var t=O.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var n=e.split("|"),r=n.length;r--;)x.attrHandle[n[r]]=t}function i(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||H)-(~e.sourceIndex||H);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return r(function(t){return t=+t,r(function(n,r){for(var o,a=e([],n.length,t),i=a.length;i--;)n[o=a[i]]&&(n[o]=!(r[o]=n[o]))})})}function l(e){return e&&void 0!==e.getElementsByTagName&&e}function u(){}function c(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,o=n&&"parentNode"===r,a=F++;return t.first?function(t,n,a){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,a)}:function(t,n,i){var s,l,u,c=[N,a];if(i){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,i))return!0}else for(;t=t[r];)if(1===t.nodeType||o){if(u=t[L]||(t[L]={}),l=u[t.uniqueID]||(u[t.uniqueID]={}),(s=l[r])&&s[0]===N&&s[1]===a)return c[2]=s[2];if(l[r]=c,c[2]=e(t,n,i))return!0}}}function f(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function h(e,n,r){for(var o=0,a=n.length;o<a;o++)t(e,n[o],r);return r}function m(e,t,n,r,o){for(var a,i=[],s=0,l=e.length,u=null!=t;s<l;s++)(a=e[s])&&(n&&!n(a,r,o)||(i.push(a),u&&t.push(s)));return i}function p(e,t,n,o,a,i){return o&&!o[L]&&(o=p(o)),a&&!a[L]&&(a=p(a,i)),r(function(r,i,s,l){var u,c,d,f=[],p=[],g=i.length,v=r||h(t||"*",s.nodeType?[s]:s,[]),y=!e||!r&&t?v:m(v,f,e,s,l),b=n?a||(r?e:g||o)?[]:i:y;if(n&&n(y,b,s,l),o)for(u=m(b,p),o(u,[],s,l),c=u.length;c--;)(d=u[c])&&(b[p[c]]=!(y[p[c]]=d));if(r){if(a||e){if(a){for(u=[],c=b.length;c--;)(d=b[c])&&u.push(y[c]=d);a(null,b=[],u,l)}for(c=b.length;c--;)(d=b[c])&&(u=a?K(r,d):f[c])>-1&&(r[u]=!(i[u]=d))}}else b=m(b===i?b.splice(g,b.length):b),a?a(null,i,b,l):J.apply(i,b)})}function g(e){for(var t,n,r,o=e.length,a=x.relative[e[0].type],i=a||x.relative[" "],s=a?1:0,l=d(function(e){return e===t},i,!0),u=d(function(e){return K(t,e)>-1},i,!0),h=[function(e,n,r){var o=!a&&(r||n!==S)||((t=n).nodeType?l(e,n,r):u(e,n,r));return t=null,o}];s<o;s++)if(n=x.relative[e[s].type])h=[d(f(h),n)];else{if((n=x.filter[e[s].type].apply(null,e[s].matches))[L]){for(r=++s;r<o&&!x.relative[e[r].type];r++);return p(s>1&&f(h),s>1&&c(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ae,"$1"),n,s<r&&g(e.slice(s,r)),r<o&&g(e=e.slice(r)),r<o&&c(e))}h.push(n)}return f(h)}function v(e,n){var o=n.length>0,a=e.length>0,i=function(r,i,s,l,u){var c,d,f,h=0,p="0",g=r&&[],v=[],y=S,b=r||a&&x.find.TAG("*",u),w=N+=null==y?1:Math.random()||.1,T=b.length;for(u&&(S=i===O||i||u);p!==T&&null!=(c=b[p]);p++){if(a&&c){for(d=0,i||c.ownerDocument===O||(E(c),s=!k);f=e[d++];)if(f(c,i||O,s)){l.push(c);break}u&&(N=w)}o&&((c=!f&&c)&&h--,r&&g.push(c))}if(h+=p,o&&p!==h){for(d=0;f=n[d++];)f(g,v,i,s);if(r){if(h>0)for(;p--;)g[p]||v[p]||(v[p]=Y.call(l));v=m(v)}J.apply(l,v),u&&!r&&v.length>0&&h+n.length>1&&t.uniqueSort(l)}return u&&(N=w,S=y),g};return o?r(i):i}var y,b,x,w,T,C,P,M,S,I,D,E,O,_,k,A,j,R,$,L="sizzle"+1*new Date,B=e.document,N=0,F=0,U=n(),z=n(),q=n(),V=function(e,t){return e===t&&(D=!0),0},H=1<<31,W={}.hasOwnProperty,G=[],Y=G.pop,X=G.push,J=G.push,Q=G.slice,K=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ne="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+te+"))|)"+ee+"*\\]",re=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ne+")*)|.*)\\)|)",oe=new RegExp(ee+"+","g"),ae=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),ie=new RegExp("^"+ee+"*,"+ee+"*"),se=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),le=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),ue=new RegExp(re),ce=new RegExp("^"+te+"$"),de={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te+"|[*])"),ATTR:new RegExp("^"+ne),PSEUDO:new RegExp("^"+re),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+Z+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,he=/^h\d$/i,me=/^[^{]+\{\s*\[native \w/,pe=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ge=/[+~]/,ve=/'|\\/g,ye=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),be=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},xe=function(){E()};try{J.apply(G=Q.call(B.childNodes),B.childNodes),G[B.childNodes.length].nodeType}catch(e){J={apply:G.length?function(e,t){X.apply(e,Q.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}b=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},E=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:B;return r!==O&&9===r.nodeType&&r.documentElement?(O=r,_=O.documentElement,k=!T(O),(n=O.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",xe,!1):n.attachEvent&&n.attachEvent("onunload",xe)),b.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),b.getElementsByTagName=o(function(e){return e.appendChild(O.createComment("")),!e.getElementsByTagName("*").length}),b.getElementsByClassName=me.test(O.getElementsByClassName),b.getById=o(function(e){return _.appendChild(e).id=L,!O.getElementsByName||!O.getElementsByName(L).length}),b.getById?(x.find.ID=function(e,t){if(void 0!==t.getElementById&&k){var n=t.getElementById(e);return n?[n]:[]}},x.filter.ID=function(e){var t=e.replace(ye,be);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(ye,be);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),x.find.TAG=b.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):b.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],o=0,a=t.getElementsByTagName(e);if("*"===e){for(;n=a[o++];)1===n.nodeType&&r.push(n);return r}return a},x.find.CLASS=b.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&k)return t.getElementsByClassName(e)},j=[],A=[],(b.qsa=me.test(O.querySelectorAll))&&(o(function(e){_.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&A.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||A.push("\\["+ee+"*(?:value|"+Z+")"),e.querySelectorAll("[id~="+L+"-]").length||A.push("~="),e.querySelectorAll(":checked").length||A.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||A.push(".#.+[+~]")}),o(function(e){var t=O.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&A.push("name"+ee+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||A.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),A.push(",.*:")})),(b.matchesSelector=me.test(R=_.matches||_.webkitMatchesSelector||_.mozMatchesSelector||_.oMatchesSelector||_.msMatchesSelector))&&o(function(e){b.disconnectedMatch=R.call(e,"div"),R.call(e,"[s!='']:x"),j.push("!=",re)}),A=A.length&&new RegExp(A.join("|")),j=j.length&&new RegExp(j.join("|")),t=me.test(_.compareDocumentPosition),$=t||me.test(_.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return D=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!b.sortDetached&&t.compareDocumentPosition(e)===n?e===O||e.ownerDocument===B&&$(B,e)?-1:t===O||t.ownerDocument===B&&$(B,t)?1:I?K(I,e)-K(I,t):0:4&n?-1:1)}:function(e,t){if(e===t)return D=!0,0;var n,r=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(!o||!a)return e===O?-1:t===O?1:o?-1:a?1:I?K(I,e)-K(I,t):0;if(o===a)return i(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;s[r]===l[r];)r++;return r?i(s[r],l[r]):s[r]===B?-1:l[r]===B?1:0},O):O},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==O&&E(e),n=n.replace(le,"='$1']"),b.matchesSelector&&k&&!q[n+" "]&&(!j||!j.test(n))&&(!A||!A.test(n)))try{var r=R.call(e,n);if(r||b.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return t(n,O,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==O&&E(e),$(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==O&&E(e);var n=x.attrHandle[t.toLowerCase()],r=n&&W.call(x.attrHandle,t.toLowerCase())?n(e,t,!k):void 0;return void 0!==r?r:b.attributes||!k?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,o=0;if(D=!b.detectDuplicates,I=!b.sortStable&&e.slice(0),e.sort(V),D){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return I=null,e},w=t.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=w(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=w(t);return n},(x=t.selectors={cacheLength:50,createPseudo:r,match:de,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ye,be),e[3]=(e[3]||e[4]||e[5]||"").replace(ye,be),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return de.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ue.test(n)&&(t=C(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ye,be).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=U[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&U(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(o){var a=t.attr(o,e);return null==a?"!="===n:!n||(a+="","="===n?a===r:"!="===n?a!==r:"^="===n?r&&0===a.indexOf(r):"*="===n?r&&a.indexOf(r)>-1:"$="===n?r&&a.slice(-r.length)===r:"~="===n?(" "+a.replace(oe," ")+" ").indexOf(r)>-1:"|="===n&&(a===r||a.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,n,r,o){var a="nth"!==e.slice(0,3),i="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,f,h,m,p=a!==i?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s,b=!1;if(g){if(a){for(;p;){for(f=t;f=f[p];)if(s?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;m=p="only"===e&&!m&&"nextSibling"}return!0}if(m=[i?g.firstChild:g.lastChild],i&&y){for(b=(h=(u=(c=(d=(f=g)[L]||(f[L]={}))[f.uniqueID]||(d[f.uniqueID]={}))[e]||[])[0]===N&&u[1])&&u[2],f=h&&g.childNodes[h];f=++h&&f&&f[p]||(b=h=0)||m.pop();)if(1===f.nodeType&&++b&&f===t){c[e]=[N,h,b];break}}else if(y&&(b=h=(u=(c=(d=(f=t)[L]||(f[L]={}))[f.uniqueID]||(d[f.uniqueID]={}))[e]||[])[0]===N&&u[1]),!1===b)for(;(f=++h&&f&&f[p]||(b=h=0)||m.pop())&&((s?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++b||(y&&((c=(d=f[L]||(f[L]={}))[f.uniqueID]||(d[f.uniqueID]={}))[e]=[N,b]),f!==t)););return(b-=o)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,n){var o,a=x.pseudos[e]||x.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return a[L]?a(n):a.length>1?(o=[e,e,"",n],x.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,o=a(e,n),i=o.length;i--;)e[r=K(e,o[i])]=!(t[r]=o[i])}):function(e){return a(e,0,o)}):a}},pseudos:{not:r(function(e){var t=[],n=[],o=P(e.replace(ae,"$1"));return o[L]?r(function(e,t,n,r){for(var a,i=o(e,null,r,[]),s=e.length;s--;)(a=i[s])&&(e[s]=!(t[s]=a))}):function(e,r,a){return t[0]=e,o(t,null,a,n),t[0]=null,!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(ye,be),function(t){return(t.textContent||t.innerText||w(t)).indexOf(e)>-1}}),lang:r(function(e){return ce.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(ye,be).toLowerCase(),function(t){var n;do{if(n=k?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===_},focus:function(e){return e===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return he.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:s(function(){return[0]}),last:s(function(e,t){return[t-1]}),eq:s(function(e,t,n){return[n<0?n+t:n]}),even:s(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:s(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:s(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:s(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=x.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[y]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(y);for(y in{submit:!0,reset:!0})x.pseudos[y]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(y);return u.prototype=x.filters=x.pseudos,x.setFilters=new u,C=t.tokenize=function(e,n){var r,o,a,i,s,l,u,c=z[e+" "];if(c)return n?0:c.slice(0);for(s=e,l=[],u=x.preFilter;s;){r&&!(o=ie.exec(s))||(o&&(s=s.slice(o[0].length)||s),l.push(a=[])),r=!1,(o=se.exec(s))&&(r=o.shift(),a.push({value:r,type:o[0].replace(ae," ")}),s=s.slice(r.length));for(i in x.filter)!(o=de[i].exec(s))||u[i]&&!(o=u[i](o))||(r=o.shift(),a.push({value:r,type:i,matches:o}),s=s.slice(r.length));if(!r)break}return n?s.length:s?t.error(e):z(e,l).slice(0)},P=t.compile=function(e,t){var n,r=[],o=[],a=q[e+" "];if(!a){for(t||(t=C(e)),n=t.length;n--;)(a=g(t[n]))[L]?r.push(a):o.push(a);(a=q(e,v(o,r))).selector=e}return a},M=t.select=function(e,t,n,r){var o,a,i,s,u,d="function"==typeof e&&e,f=!r&&C(e=d.selector||e);if(n=n||[],1===f.length){if((a=f[0]=f[0].slice(0)).length>2&&"ID"===(i=a[0]).type&&b.getById&&9===t.nodeType&&k&&x.relative[a[1].type]){if(!(t=(x.find.ID(i.matches[0].replace(ye,be),t)||[])[0]))return n;d&&(t=t.parentNode),e=e.slice(a.shift().value.length)}for(o=de.needsContext.test(e)?0:a.length;o--&&(i=a[o],!x.relative[s=i.type]);)if((u=x.find[s])&&(r=u(i.matches[0].replace(ye,be),ge.test(a[0].type)&&l(t.parentNode)||t))){if(a.splice(o,1),!(e=r.length&&c(a)))return J.apply(n,r),n;break}}return(d||P(e,f))(r,t,!k,n,!t||ge.test(e)&&l(t.parentNode)||t),n},b.sortStable=L.split("").sort(V).join("")===L,b.detectDuplicates=!!D,E(),b.sortDetached=o(function(e){return 1&e.compareDocumentPosition(O.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),b.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||a(Z,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e);re.find=le,re.expr=le.selectors,re.expr[":"]=re.expr.pseudos,re.uniqueSort=re.unique=le.uniqueSort,re.text=le.getText,re.isXMLDoc=le.isXML,re.contains=le.contains;var ue=function(e,t,n){for(var r=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&re(e).is(n))break;r.push(e)}return r},ce=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},de=re.expr.match.needsContext,fe=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,he=/^.[^:#\[\.,]*$/;re.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?re.find.matchesSelector(r,e)?[r]:[]:re.find.matches(e,re.grep(t,function(e){return 1===e.nodeType}))},re.fn.extend({find:function(e){var t,n=this.length,r=[],o=this;if("string"!=typeof e)return this.pushStack(re(e).filter(function(){for(t=0;t<n;t++)if(re.contains(o[t],this))return!0}));for(t=0;t<n;t++)re.find(e,o[t],r);return r=this.pushStack(n>1?re.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(r(this,e||[],!1))},not:function(e){return this.pushStack(r(this,e||[],!0))},is:function(e){return!!r(this,"string"==typeof e&&de.test(e)?re(e):e||[],!1).length}});var me,pe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(re.fn.init=function(e,t,n){var r,o;if(!e)return this;if(n=n||me,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:pe.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof re?t[0]:t,re.merge(this,re.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:Y,!0)),fe.test(r[1])&&re.isPlainObject(t))for(r in t)re.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(o=Y.getElementById(r[2]))&&o.parentNode&&(this.length=1,this[0]=o),this.context=Y,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):re.isFunction(e)?void 0!==n.ready?n.ready(e):e(re):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),re.makeArray(e,this))}).prototype=re.fn,me=re(Y);var ge=/^(?:parents|prev(?:Until|All))/,ve={children:!0,contents:!0,next:!0,prev:!0};re.fn.extend({has:function(e){var t=re(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(re.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,r=0,o=this.length,a=[],i=de.test(e)||"string"!=typeof e?re(e,t||this.context):0;r<o;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(i?i.index(n)>-1:1===n.nodeType&&re.find.matchesSelector(n,e))){a.push(n);break}return this.pushStack(a.length>1?re.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?K.call(re(e),this[0]):K.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(re.uniqueSort(re.merge(this.get(),re(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),re.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ue(e,"parentNode")},parentsUntil:function(e,t,n){return ue(e,"parentNode",n)},next:function(e){return o(e,"nextSibling")},prev:function(e){return o(e,"previousSibling")},nextAll:function(e){return ue(e,"nextSibling")},prevAll:function(e){return ue(e,"previousSibling")},nextUntil:function(e,t,n){return ue(e,"nextSibling",n)},prevUntil:function(e,t,n){return ue(e,"previousSibling",n)},siblings:function(e){return ce((e.parentNode||{}).firstChild,e)},children:function(e){return ce(e.firstChild)},contents:function(e){return e.contentDocument||re.merge([],e.childNodes)}},function(e,t){re.fn[e]=function(n,r){var o=re.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(o=re.filter(r,o)),this.length>1&&(ve[e]||re.uniqueSort(o),ge.test(e)&&o.reverse()),this.pushStack(o)}});var ye=/\S+/g;re.Callbacks=function(e){e="string"==typeof e?a(e):re.extend({},e);var t,n,r,o,i=[],s=[],l=-1,u=function(){for(o=e.once,r=t=!0;s.length;l=-1)for(n=s.shift();++l<i.length;)!1===i[l].apply(n[0],n[1])&&e.stopOnFalse&&(l=i.length,n=!1);e.memory||(n=!1),t=!1,o&&(i=n?[]:"")},c={add:function(){return i&&(n&&!t&&(l=i.length-1,s.push(n)),function t(n){re.each(n,function(n,r){re.isFunction(r)?e.unique&&c.has(r)||i.push(r):r&&r.length&&"string"!==re.type(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return re.each(arguments,function(e,t){for(var n;(n=re.inArray(t,i,n))>-1;)i.splice(n,1),n<=l&&l--}),this},has:function(e){return e?re.inArray(e,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return o=s=[],i=n="",this},disabled:function(){return!i},lock:function(){return o=s=[],n||(i=n=""),this},locked:function(){return!!o},fireWith:function(e,n){return o||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},re.extend({Deferred:function(e){var t=[["resolve","done",re.Callbacks("once memory"),"resolved"],["reject","fail",re.Callbacks("once memory"),"rejected"],["notify","progress",re.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return re.Deferred(function(n){re.each(t,function(t,a){var i=re.isFunction(e[t])&&e[t];o[a[1]](function(){var e=i&&i.apply(this,arguments);e&&re.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[a[0]+"With"](this===r?n.promise():this,i?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?re.extend(e,r):r}},o={};return r.pipe=r.then,re.each(t,function(e,a){var i=a[2],s=a[3];r[a[1]]=i.add,s&&i.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),o[a[0]]=function(){return o[a[0]+"With"](this===o?r:this,arguments),this},o[a[0]+"With"]=i.fireWith}),r.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,r,o=0,a=X.call(arguments),i=a.length,s=1!==i||e&&re.isFunction(e.promise)?i:0,l=1===s?e:re.Deferred(),u=function(e,n,r){return function(o){n[e]=this,r[e]=arguments.length>1?X.call(arguments):o,r===t?l.notifyWith(n,r):--s||l.resolveWith(n,r)}};if(i>1)for(t=new Array(i),n=new Array(i),r=new Array(i);o<i;o++)a[o]&&re.isFunction(a[o].promise)?a[o].promise().progress(u(o,n,t)).done(u(o,r,a)).fail(l.reject):--s;return s||l.resolveWith(r,a),l.promise()}});var be;re.fn.ready=function(e){return re.ready.promise().done(e),this},re.extend({isReady:!1,readyWait:1,holdReady:function(e){e?re.readyWait++:re.ready(!0)},ready:function(e){(!0===e?--re.readyWait:re.isReady)||(re.isReady=!0,!0!==e&&--re.readyWait>0||(be.resolveWith(Y,[re]),re.fn.triggerHandler&&(re(Y).triggerHandler("ready"),re(Y).off("ready"))))}}),re.ready.promise=function(t){return be||(be=re.Deferred(),"complete"===Y.readyState||"loading"!==Y.readyState&&!Y.documentElement.doScroll?e.setTimeout(re.ready):(Y.addEventListener("DOMContentLoaded",i),e.addEventListener("load",i))),be.promise(t)},re.ready.promise();var xe=function(e,t,n,r,o,a,i){var s=0,l=e.length,u=null==n;if("object"===re.type(n)){o=!0;for(s in n)xe(e,t,s,n[s],!0,a,i)}else if(void 0!==r&&(o=!0,re.isFunction(r)||(i=!0),u&&(i?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(re(e),n)})),t))for(;s<l;s++)t(e[s],n,i?r:r.call(e[s],s,t(e[s],n)));return o?e:u?t.call(e):l?t(e[0],n):a},we=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};s.uid=1,s.prototype={register:function(e,t){var n=t||{};return e.nodeType?e[this.expando]=n:Object.defineProperty(e,this.expando,{value:n,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!we(e))return{};var t=e[this.expando];return t||(t={},we(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,o=this.cache(e);if("string"==typeof t)o[t]=n;else for(r in t)o[r]=t[r];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,n){var r;return void 0===t||t&&"string"==typeof t&&void 0===n?void 0!==(r=this.get(e,t))?r:this.get(e,re.camelCase(t)):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r,o,a=e[this.expando];if(void 0!==a){if(void 0===t)this.register(e);else{re.isArray(t)?r=t.concat(t.map(re.camelCase)):(o=re.camelCase(t),r=t in a?[t,o]:(r=o)in a?[r]:r.match(ye)||[]),n=r.length;for(;n--;)delete a[r[n]]}(void 0===t||re.isEmptyObject(a))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!re.isEmptyObject(t)}};var Te=new s,Ce=new s,Pe=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Me=/[A-Z]/g;re.extend({hasData:function(e){return Ce.hasData(e)||Te.hasData(e)},data:function(e,t,n){return Ce.access(e,t,n)},removeData:function(e,t){Ce.remove(e,t)},_data:function(e,t,n){return Te.access(e,t,n)},_removeData:function(e,t){Te.remove(e,t)}}),re.fn.extend({data:function(e,t){var n,r,o,a=this[0],i=a&&a.attributes;if(void 0===e){if(this.length&&(o=Ce.get(a),1===a.nodeType&&!Te.get(a,"hasDataAttrs"))){for(n=i.length;n--;)i[n]&&0===(r=i[n].name).indexOf("data-")&&(r=re.camelCase(r.slice(5)),l(a,r,o[r]));Te.set(a,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){Ce.set(this,e)}):xe(this,function(t){var n,r;if(a&&void 0===t){if(void 0!==(n=Ce.get(a,e)||Ce.get(a,e.replace(Me,"-$&").toLowerCase())))return n;if(r=re.camelCase(e),void 0!==(n=Ce.get(a,r)))return n;if(void 0!==(n=l(a,r,void 0)))return n}else r=re.camelCase(e),this.each(function(){var n=Ce.get(this,r);Ce.set(this,r,t),e.indexOf("-")>-1&&void 0!==n&&Ce.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Ce.remove(this,e)})}}),re.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Te.get(e,t),n&&(!r||re.isArray(n)?r=Te.access(e,t,re.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=re.queue(e,t),r=n.length,o=n.shift(),a=re._queueHooks(e,t);"inprogress"===o&&(o=n.shift(),r--),o&&("fx"===t&&n.unshift("inprogress"),delete a.stop,o.call(e,function(){re.dequeue(e,t)},a)),!r&&a&&a.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Te.get(e,n)||Te.access(e,n,{empty:re.Callbacks("once memory").add(function(){Te.remove(e,[t+"queue",n])})})}}),re.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?re.queue(this[0],e):void 0===t?this:this.each(function(){var n=re.queue(this,e,t);re._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&re.dequeue(this,e)})},dequeue:function(e){return this.each(function(){re.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,o=re.Deferred(),a=this,i=this.length,s=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";i--;)(n=Te.get(a[i],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),o.promise(t)}});var Se=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ie=new RegExp("^(?:([+-])=|)("+Se+")([a-z%]*)$","i"),De=["Top","Right","Bottom","Left"],Ee=function(e,t){return e=t||e,"none"===re.css(e,"display")||!re.contains(e.ownerDocument,e)},Oe=/^(?:checkbox|radio)$/i,_e=/<([\w:-]+)/,ke=/^$|\/(?:java|ecma)script/i,Ae={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ae.optgroup=Ae.option,Ae.tbody=Ae.tfoot=Ae.colgroup=Ae.caption=Ae.thead,Ae.th=Ae.td;var je=/<|&#?\w+;/;!function(){var e=Y.createDocumentFragment().appendChild(Y.createElement("div")),t=Y.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),ne.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",ne.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Re=/^key/,$e=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Le=/^([^.]*)(?:\.(.+)|)/;re.event={global:{},add:function(e,t,n,r,o){var a,i,s,l,u,c,d,f,h,m,p,g=Te.get(e);if(g)for(n.handler&&(n=(a=n).handler,o=a.selector),n.guid||(n.guid=re.guid++),(l=g.events)||(l=g.events={}),(i=g.handle)||(i=g.handle=function(t){return void 0!==re&&re.event.triggered!==t.type?re.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(ye)||[""]).length;u--;)h=p=(s=Le.exec(t[u])||[])[1],m=(s[2]||"").split(".").sort(),h&&(d=re.event.special[h]||{},h=(o?d.delegateType:d.bindType)||h,d=re.event.special[h]||{},c=re.extend({type:h,origType:p,data:r,handler:n,guid:n.guid,selector:o,needsContext:o&&re.expr.match.needsContext.test(o),namespace:m.join(".")},a),(f=l[h])||((f=l[h]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,r,m,i)||e.addEventListener&&e.addEventListener(h,i)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),o?f.splice(f.delegateCount++,0,c):f.push(c),re.event.global[h]=!0)},remove:function(e,t,n,r,o){var a,i,s,l,u,c,d,f,h,m,p,g=Te.hasData(e)&&Te.get(e);if(g&&(l=g.events)){for(u=(t=(t||"").match(ye)||[""]).length;u--;)if(s=Le.exec(t[u])||[],h=p=s[1],m=(s[2]||"").split(".").sort(),h){for(d=re.event.special[h]||{},f=l[h=(r?d.delegateType:d.bindType)||h]||[],s=s[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=a=f.length;a--;)c=f[a],!o&&p!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(a,1),c.selector&&f.delegateCount--,d.remove&&d.remove.call(e,c));i&&!f.length&&(d.teardown&&!1!==d.teardown.call(e,m,g.handle)||re.removeEvent(e,h,g.handle),delete l[h])}else for(h in l)re.event.remove(e,h+t[u],n,r,!0);re.isEmptyObject(l)&&Te.remove(e,"handle events")}},dispatch:function(e){e=re.event.fix(e);var t,n,r,o,a,i=[],s=X.call(arguments),l=(Te.get(this,"events")||{})[e.type]||[],u=re.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(i=re.event.handlers.call(this,e,l),t=0;(o=i[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(a=o.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(a.namespace)||(e.handleObj=a,e.data=a.data,void 0!==(r=((re.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,s))&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,o,a,i=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(r=[],n=0;n<s;n++)void 0===r[o=(a=t[n]).selector+" "]&&(r[o]=a.needsContext?re(o,this).index(l)>-1:re.find(o,this,null,[l]).length),r[o]&&r.push(a);r.length&&i.push({elem:l,handlers:r})}return s<t.length&&i.push({elem:this,handlers:t.slice(s)}),i},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,o,a=t.button;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||Y).documentElement,o=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[re.expando])return e;var t,n,r,o=e.type,a=e,i=this.fixHooks[o];for(i||(this.fixHooks[o]=i=$e.test(o)?this.mouseHooks:Re.test(o)?this.keyHooks:{}),r=i.props?this.props.concat(i.props):this.props,e=new re.Event(a),t=r.length;t--;)e[n=r[t]]=a[n];return e.target||(e.target=Y),3===e.target.nodeType&&(e.target=e.target.parentNode),i.filter?i.filter(e,a):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==p()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===p()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&re.nodeName(this,"input"))return this.click(),!1},_default:function(e){return re.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},re.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},re.Event=function(e,t){if(!(this instanceof re.Event))return new re.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?h:m):this.type=e,t&&re.extend(this,t),this.timeStamp=e&&e.timeStamp||re.now(),this[re.expando]=!0},re.Event.prototype={constructor:re.Event,isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=h,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},re.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){re.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,o=e.relatedTarget,a=e.handleObj;return o&&(o===r||re.contains(r,o))||(e.type=a.origType,n=a.handler.apply(this,arguments),e.type=t),n}}}),re.fn.extend({on:function(e,t,n,r){return g(this,e,t,n,r)},one:function(e,t,n,r){return g(this,e,t,n,r,1)},off:function(e,t,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,re(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=m),this.each(function(){re.event.remove(this,e,n,t)})}});var Be=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Ne=/<script|<style|<link/i,Fe=/checked\s*(?:[^=]|=\s*.checked.)/i,Ue=/^true\/(.*)/,ze=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;re.extend({htmlPrefilter:function(e){return e.replace(Be,"<$1></$2>")},clone:function(e,t,n){var r,o,a,i,s=e.cloneNode(!0),l=re.contains(e.ownerDocument,e);if(!(ne.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||re.isXMLDoc(e)))for(i=c(s),r=0,o=(a=c(e)).length;r<o;r++)w(a[r],i[r]);if(t)if(n)for(a=a||c(e),i=i||c(s),r=0,o=a.length;r<o;r++)x(a[r],i[r]);else x(e,s);return(i=c(s,"script")).length>0&&d(i,!l&&c(e,"script")),s},cleanData:function(e){for(var t,n,r,o=re.event.special,a=0;void 0!==(n=e[a]);a++)if(we(n)){if(t=n[Te.expando]){if(t.events)for(r in t.events)o[r]?re.event.remove(n,r):re.removeEvent(n,r,t.handle);n[Te.expando]=void 0}n[Ce.expando]&&(n[Ce.expando]=void 0)}}}),re.fn.extend({domManip:T,detach:function(e){return C(this,e,!0)},remove:function(e){return C(this,e)},text:function(e){return xe(this,function(e){return void 0===e?re.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return T(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||v(this,e).appendChild(e)})},prepend:function(){return T(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=v(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return T(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return T(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(re.cleanData(c(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return re.clone(this,e,t)})},html:function(e){return xe(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ne.test(e)&&!Ae[(_e.exec(e)||["",""])[1].toLowerCase()]){e=re.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(re.cleanData(c(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return T(this,arguments,function(t){var n=this.parentNode;re.inArray(this,e)<0&&(re.cleanData(c(this)),n&&n.replaceChild(t,this))},e)}}),re.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){re.fn[e]=function(e){for(var n,r=[],o=re(e),a=o.length-1,i=0;i<=a;i++)n=i===a?this:this.clone(!0),re(o[i])[t](n),Q.apply(r,n.get());return this.pushStack(r)}});var qe,Ve={HTML:"block",BODY:"block"},He=/^margin/,We=new RegExp("^("+Se+")(?!px)[a-z%]+$","i"),Ge=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Ye=function(e,t,n,r){var o,a,i={};for(a in t)i[a]=e.style[a],e.style[a]=t[a];o=n.apply(e,r||[]);for(a in t)e.style[a]=i[a];return o},Xe=Y.documentElement;!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",Xe.appendChild(i);var t=e.getComputedStyle(s);n="1%"!==t.top,a="2px"===t.marginLeft,r="4px"===t.width,s.style.marginRight="50%",o="4px"===t.marginRight,Xe.removeChild(i)}var n,r,o,a,i=Y.createElement("div"),s=Y.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===s.style.backgroundClip,i.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",i.appendChild(s),re.extend(ne,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==r&&t(),r},pixelMarginRight:function(){return null==r&&t(),o},reliableMarginLeft:function(){return null==r&&t(),a},reliableMarginRight:function(){var t,n=s.appendChild(Y.createElement("div"));return n.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",s.style.width="1px",Xe.appendChild(i),t=!parseFloat(e.getComputedStyle(n).marginRight),Xe.removeChild(i),s.removeChild(n),t}}))}();var Je=/^(none|table(?!-c[ea]).+)/,Qe={position:"absolute",visibility:"hidden",display:"block"},Ke={letterSpacing:"0",fontWeight:"400"},Ze=["Webkit","O","Moz","ms"],et=Y.createElement("div").style;re.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=S(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,i,s=re.camelCase(t),l=e.style;if(t=re.cssProps[s]||(re.cssProps[s]=D(s)||s),i=re.cssHooks[t]||re.cssHooks[s],void 0===n)return i&&"get"in i&&void 0!==(o=i.get(e,!1,r))?o:l[t];"string"==(a=typeof n)&&(o=Ie.exec(n))&&o[1]&&(n=u(e,t,o),a="number"),null!=n&&n===n&&("number"===a&&(n+=o&&o[3]||(re.cssNumber[s]?"":"px")),ne.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),i&&"set"in i&&void 0===(n=i.set(e,n,r))||(l[t]=n))}},css:function(e,t,n,r){var o,a,i,s=re.camelCase(t);return t=re.cssProps[s]||(re.cssProps[s]=D(s)||s),(i=re.cssHooks[t]||re.cssHooks[s])&&"get"in i&&(o=i.get(e,!0,n)),void 0===o&&(o=S(e,t,r)),"normal"===o&&t in Ke&&(o=Ke[t]),""===n||n?(a=parseFloat(o),!0===n||isFinite(a)?a||0:o):o}}),re.each(["height","width"],function(e,t){re.cssHooks[t]={get:function(e,n,r){if(n)return Je.test(re.css(e,"display"))&&0===e.offsetWidth?Ye(e,Qe,function(){return _(e,t,r)}):_(e,t,r)},set:function(e,n,r){var o,a=r&&Ge(e),i=r&&O(e,t,r,"border-box"===re.css(e,"boxSizing",!1,a),a);return i&&(o=Ie.exec(n))&&"px"!==(o[3]||"px")&&(e.style[t]=n,n=re.css(e,t)),E(0,n,i)}}}),re.cssHooks.marginLeft=I(ne.reliableMarginLeft,function(e,t){if(t)return(parseFloat(S(e,"marginLeft"))||e.getBoundingClientRect().left-Ye(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),re.cssHooks.marginRight=I(ne.reliableMarginRight,function(e,t){if(t)return Ye(e,{display:"inline-block"},S,[e,"marginRight"])}),re.each({margin:"",padding:"",border:"Width"},function(e,t){re.cssHooks[e+t]={expand:function(n){for(var r=0,o={},a="string"==typeof n?n.split(" "):[n];r<4;r++)o[e+De[r]+t]=a[r]||a[r-2]||a[0];return o}},He.test(e)||(re.cssHooks[e+t].set=E)}),re.fn.extend({css:function(e,t){return xe(this,function(e,t,n){var r,o,a={},i=0;if(re.isArray(t)){for(r=Ge(e),o=t.length;i<o;i++)a[t[i]]=re.css(e,t[i],!1,r);return a}return void 0!==n?re.style(e,t,n):re.css(e,t)},e,t,arguments.length>1)},show:function(){return k(this,!0)},hide:function(){return k(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ee(this)?re(this).show():re(this).hide()})}}),re.Tween=A,A.prototype={constructor:A,init:function(e,t,n,r,o,a){this.elem=e,this.prop=n,this.easing=o||re.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=a||(re.cssNumber[n]?"":"px")},cur:function(){var e=A.propHooks[this.prop];return e&&e.get?e.get(this):A.propHooks._default.get(this)},run:function(e){var t,n=A.propHooks[this.prop];return this.options.duration?this.pos=t=re.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=re.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){re.fx.step[e.prop]?re.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[re.cssProps[e.prop]]&&!re.cssHooks[e.prop]?e.elem[e.prop]=e.now:re.style(e.elem,e.prop,e.now+e.unit)}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},re.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},re.fx=A.prototype.init,re.fx.step={};var tt,nt,rt=/^(?:toggle|show|hide)$/,ot=/queueHooks$/;re.Animation=re.extend(B,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return u(n.elem,e,Ie.exec(t),n),n}]},tweener:function(e,t){re.isFunction(e)?(t=e,e=["*"]):e=e.match(ye);for(var n,r=0,o=e.length;r<o;r++)n=e[r],B.tweeners[n]=B.tweeners[n]||[],B.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,o,a,i,s,l,u,c=this,d={},f=e.style,h=e.nodeType&&Ee(e),m=Te.get(e,"fxshow");n.queue||(null==(s=re._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,c.always(function(){c.always(function(){s.unqueued--,re.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(u=re.css(e,"display"))?Te.get(e,"olddisplay")||M(e.nodeName):u)&&"none"===re.css(e,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",c.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(r in t)if(o=t[r],rt.exec(o)){if(delete t[r],a=a||"toggle"===o,o===(h?"hide":"show")){if("show"!==o||!m||void 0===m[r])continue;h=!0}d[r]=m&&m[r]||re.style(e,r)}else u=void 0;if(re.isEmptyObject(d))"inline"===("none"===u?M(e.nodeName):u)&&(f.display=u);else{m?"hidden"in m&&(h=m.hidden):m=Te.access(e,"fxshow",{}),a&&(m.hidden=!h),h?re(e).show():c.done(function(){re(e).hide()}),c.done(function(){var t;Te.remove(e,"fxshow");for(t in d)re.style(e,t,d[t])});for(r in d)i=$(h?m[r]:0,r,c),r in m||(m[r]=i.start,h&&(i.end=i.start,i.start="width"===r||"height"===r?1:0))}}],prefilter:function(e,t){t?B.prefilters.unshift(e):B.prefilters.push(e)}}),re.speed=function(e,t,n){var r=e&&"object"==typeof e?re.extend({},e):{complete:n||!n&&t||re.isFunction(e)&&e,duration:e,easing:n&&t||t&&!re.isFunction(t)&&t};return r.duration=re.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in re.fx.speeds?re.fx.speeds[r.duration]:re.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){re.isFunction(r.old)&&r.old.call(this),r.queue&&re.dequeue(this,r.queue)},r},re.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Ee).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var o=re.isEmptyObject(e),a=re.speed(t,n,r),i=function(){var t=B(this,re.extend({},e),a);(o||Te.get(this,"finish"))&&t.stop(!0)};return i.finish=i,o||!1===a.queue?this.each(i):this.queue(a.queue,i)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",a=re.timers,i=Te.get(this);if(o)i[o]&&i[o].stop&&r(i[o]);else for(o in i)i[o]&&i[o].stop&&ot.test(o)&&r(i[o]);for(o=a.length;o--;)a[o].elem!==this||null!=e&&a[o].queue!==e||(a[o].anim.stop(n),t=!1,a.splice(o,1));!t&&n||re.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=Te.get(this),r=n[e+"queue"],o=n[e+"queueHooks"],a=re.timers,i=r?r.length:0;for(n.finish=!0,re.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<i;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),re.each(["toggle","show","hide"],function(e,t){var n=re.fn[t];re.fn[t]=function(e,r,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(R(t,!0),e,r,o)}}),re.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){re.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),re.timers=[],re.fx.tick=function(){var e,t=0,n=re.timers;for(tt=re.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||re.fx.stop(),tt=void 0},re.fx.timer=function(e){re.timers.push(e),e()?re.fx.start():re.timers.pop()},re.fx.interval=13,re.fx.start=function(){nt||(nt=e.setInterval(re.fx.tick,re.fx.interval))},re.fx.stop=function(){e.clearInterval(nt),nt=null},re.fx.speeds={slow:600,fast:200,_default:400},re.fn.delay=function(t,n){return t=re.fx?re.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var o=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(o)}})},function(){var e=Y.createElement("input"),t=Y.createElement("select"),n=t.appendChild(Y.createElement("option"));e.type="checkbox",ne.checkOn=""!==e.value,ne.optSelected=n.selected,t.disabled=!0,ne.optDisabled=!n.disabled,(e=Y.createElement("input")).value="t",e.type="radio",ne.radioValue="t"===e.value}();var at,it=re.expr.attrHandle;re.fn.extend({attr:function(e,t){return xe(this,re.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){re.removeAttr(this,e)})}}),re.extend({attr:function(e,t,n){var r,o,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?re.prop(e,t,n):(1===a&&re.isXMLDoc(e)||(t=t.toLowerCase(),o=re.attrHooks[t]||(re.expr.match.bool.test(t)?at:void 0)),void 0!==n?null===n?void re.removeAttr(e,t):o&&"set"in o&&void 0!==(r=o.set(e,n,t))?r:(e.setAttribute(t,n+""),n):o&&"get"in o&&null!==(r=o.get(e,t))?r:null==(r=re.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!ne.radioValue&&"radio"===t&&re.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r,o=0,a=t&&t.match(ye);if(a&&1===e.nodeType)for(;n=a[o++];)r=re.propFix[n]||n,re.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)}}),at={set:function(e,t,n){return!1===t?re.removeAttr(e,n):e.setAttribute(n,n),n}},re.each(re.expr.match.bool.source.match(/\w+/g),function(e,t){var n=it[t]||re.find.attr;it[t]=function(e,t,r){var o,a;return r||(a=it[t],it[t]=o,o=null!=n(e,t,r)?t.toLowerCase():null,it[t]=a),o}});var st=/^(?:input|select|textarea|button)$/i,lt=/^(?:a|area)$/i;re.fn.extend({prop:function(e,t){return xe(this,re.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[re.propFix[e]||e]})}}),re.extend({prop:function(e,t,n){var r,o,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&re.isXMLDoc(e)||(t=re.propFix[t]||t,o=re.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(r=o.set(e,n,t))?r:e[t]=n:o&&"get"in o&&null!==(r=o.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=re.find.attr(e,"tabindex");return t?parseInt(t,10):st.test(e.nodeName)||lt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),ne.optSelected||(re.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),re.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){re.propFix[this.toLowerCase()]=this});var ut=/[\t\r\n\f]/g;re.fn.extend({addClass:function(e){var t,n,r,o,a,i,s,l=0;if(re.isFunction(e))return this.each(function(t){re(this).addClass(e.call(this,t,N(this)))});if("string"==typeof e&&e)for(t=e.match(ye)||[];n=this[l++];)if(o=N(n),r=1===n.nodeType&&(" "+o+" ").replace(ut," ")){for(i=0;a=t[i++];)r.indexOf(" "+a+" ")<0&&(r+=a+" ");o!==(s=re.trim(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,o,a,i,s,l=0;if(re.isFunction(e))return this.each(function(t){re(this).removeClass(e.call(this,t,N(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(ye)||[];n=this[l++];)if(o=N(n),r=1===n.nodeType&&(" "+o+" ").replace(ut," ")){for(i=0;a=t[i++];)for(;r.indexOf(" "+a+" ")>-1;)r=r.replace(" "+a+" "," ");o!==(s=re.trim(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):re.isFunction(e)?this.each(function(n){re(this).toggleClass(e.call(this,n,N(this),t),t)}):this.each(function(){var t,r,o,a;if("string"===n)for(r=0,o=re(this),a=e.match(ye)||[];t=a[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||((t=N(this))&&Te.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Te.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+N(n)+" ").replace(ut," ").indexOf(t)>-1)return!0;return!1}});var ct=/\r/g,dt=/[\x20\t\r\n\f]+/g;re.fn.extend({val:function(e){var t,n,r,o=this[0];{if(arguments.length)return r=re.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(null==(o=r?e.call(this,n,re(this).val()):e)?o="":"number"==typeof o?o+="":re.isArray(o)&&(o=re.map(o,function(e){return null==e?"":e+""})),(t=re.valHooks[this.type]||re.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return(t=re.valHooks[o.type]||re.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:"string"==typeof(n=o.value)?n.replace(ct,""):null==n?"":n}}}),re.extend({valHooks:{option:{get:function(e){var t=re.find.attr(e,"value");return null!=t?t:re.trim(re.text(e)).replace(dt," ")}},select:{get:function(e){for(var t,n,r=e.options,o=e.selectedIndex,a="select-one"===e.type||o<0,i=a?null:[],s=a?o+1:r.length,l=o<0?s:a?o:0;l<s;l++)if(((n=r[l]).selected||l===o)&&(ne.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!re.nodeName(n.parentNode,"optgroup"))){if(t=re(n).val(),a)return t;i.push(t)}return i},set:function(e,t){for(var n,r,o=e.options,a=re.makeArray(t),i=o.length;i--;)((r=o[i]).selected=re.inArray(re.valHooks.option.get(r),a)>-1)&&(n=!0);return n||(e.selectedIndex=-1),a}}}}),re.each(["radio","checkbox"],function(){re.valHooks[this]={set:function(e,t){if(re.isArray(t))return e.checked=re.inArray(re(e).val(),t)>-1}},ne.checkOn||(re.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var ft=/^(?:focusinfocus|focusoutblur)$/;re.extend(re.event,{trigger:function(t,n,r,o){var a,i,s,l,u,c,d,f=[r||Y],h=te.call(t,"type")?t.type:t,m=te.call(t,"namespace")?t.namespace.split("."):[];if(i=s=r=r||Y,3!==r.nodeType&&8!==r.nodeType&&!ft.test(h+re.event.triggered)&&(h.indexOf(".")>-1&&(h=(m=h.split(".")).shift(),m.sort()),u=h.indexOf(":")<0&&"on"+h,t=t[re.expando]?t:new re.Event(h,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:re.makeArray(n,[t]),d=re.event.special[h]||{},o||!d.trigger||!1!==d.trigger.apply(r,n))){if(!o&&!d.noBubble&&!re.isWindow(r)){for(l=d.delegateType||h,ft.test(l+h)||(i=i.parentNode);i;i=i.parentNode)f.push(i),s=i;s===(r.ownerDocument||Y)&&f.push(s.defaultView||s.parentWindow||e)}for(a=0;(i=f[a++])&&!t.isPropagationStopped();)t.type=a>1?l:d.bindType||h,(c=(Te.get(i,"events")||{})[t.type]&&Te.get(i,"handle"))&&c.apply(i,n),(c=u&&i[u])&&c.apply&&we(i)&&(t.result=c.apply(i,n),!1===t.result&&t.preventDefault());return t.type=h,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),n)||!we(r)||u&&re.isFunction(r[h])&&!re.isWindow(r)&&((s=r[u])&&(r[u]=null),re.event.triggered=h,r[h](),re.event.triggered=void 0,s&&(r[u]=s)),t.result}},simulate:function(e,t,n){var r=re.extend(new re.Event,n,{type:e,isSimulated:!0});re.event.trigger(r,null,t)}}),re.fn.extend({trigger:function(e,t){return this.each(function(){re.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return re.event.trigger(e,t,n,!0)}}),re.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){re.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),re.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ne.focusin="onfocusin"in e,ne.focusin||re.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){re.event.simulate(t,e.target,re.event.fix(e))};re.event.special[t]={setup:function(){var r=this.ownerDocument||this,o=Te.access(r,t);o||r.addEventListener(e,n,!0),Te.access(r,t,(o||0)+1)},teardown:function(){var r=this.ownerDocument||this,o=Te.access(r,t)-1;o?Te.access(r,t,o):(r.removeEventListener(e,n,!0),Te.remove(r,t))}}});var ht=e.location,mt=re.now(),pt=/\?/;re.parseJSON=function(e){return JSON.parse(e+"")},re.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||re.error("Invalid XML: "+t),n};var gt=/#.*$/,vt=/([?&])_=[^&]*/,yt=/^(.*?):[ \t]*([^\r\n]*)$/gm,bt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,xt=/^(?:GET|HEAD)$/,wt=/^\/\//,Tt={},Ct={},Pt="*/".concat("*"),Mt=Y.createElement("a");Mt.href=ht.href,re.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ht.href,type:"GET",isLocal:bt.test(ht.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Pt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":re.parseJSON,"text xml":re.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?z(z(e,re.ajaxSettings),t):z(re.ajaxSettings,e)},ajaxPrefilter:F(Tt),ajaxTransport:F(Ct),ajax:function(t,n){function r(t,n,r,s){var u,d,y,b,w,C=n;2!==x&&(x=2,l&&e.clearTimeout(l),o=void 0,i=s||"",T.readyState=t>0?4:0,u=t>=200&&t<300||304===t,r&&(b=q(f,T,r)),b=V(f,b,T,u),u?(f.ifModified&&((w=T.getResponseHeader("Last-Modified"))&&(re.lastModified[a]=w),(w=T.getResponseHeader("etag"))&&(re.etag[a]=w)),204===t||"HEAD"===f.type?C="nocontent":304===t?C="notmodified":(C=b.state,d=b.data,u=!(y=b.error))):(y=C,!t&&C||(C="error",t<0&&(t=0))),T.status=t,T.statusText=(n||C)+"",u?p.resolveWith(h,[d,C,T]):p.rejectWith(h,[T,C,y]),T.statusCode(v),v=void 0,c&&m.trigger(u?"ajaxSuccess":"ajaxError",[T,f,u?d:y]),g.fireWith(h,[T,C]),c&&(m.trigger("ajaxComplete",[T,f]),--re.active||re.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=void 0),n=n||{};var o,a,i,s,l,u,c,d,f=re.ajaxSetup({},n),h=f.context||f,m=f.context&&(h.nodeType||h.jquery)?re(h):re.event,p=re.Deferred(),g=re.Callbacks("once memory"),v=f.statusCode||{},y={},b={},x=0,w="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!s)for(s={};t=yt.exec(i);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=b[n]=b[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(x<2)for(t in e)v[t]=[v[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||w;return o&&o.abort(t),r(0,t),this}};if(p.promise(T).complete=g.add,T.success=T.done,T.error=T.fail,f.url=((t||f.url||ht.href)+"").replace(gt,"").replace(wt,ht.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=re.trim(f.dataType||"*").toLowerCase().match(ye)||[""],null==f.crossDomain){u=Y.createElement("a");try{u.href=f.url,u.href=u.href,f.crossDomain=Mt.protocol+"//"+Mt.host!=u.protocol+"//"+u.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=re.param(f.data,f.traditional)),U(Tt,f,n,T),2===x)return T;(c=re.event&&f.global)&&0==re.active++&&re.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!xt.test(f.type),a=f.url,f.hasContent||(f.data&&(a=f.url+=(pt.test(a)?"&":"?")+f.data,delete f.data),!1===f.cache&&(f.url=vt.test(a)?a.replace(vt,"$1_="+mt++):a+(pt.test(a)?"&":"?")+"_="+mt++)),f.ifModified&&(re.lastModified[a]&&T.setRequestHeader("If-Modified-Since",re.lastModified[a]),re.etag[a]&&T.setRequestHeader("If-None-Match",re.etag[a])),(f.data&&f.hasContent&&!1!==f.contentType||n.contentType)&&T.setRequestHeader("Content-Type",f.contentType),T.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Pt+"; q=0.01":""):f.accepts["*"]);for(d in f.headers)T.setRequestHeader(d,f.headers[d]);if(f.beforeSend&&(!1===f.beforeSend.call(h,T,f)||2===x))return T.abort();w="abort";for(d in{success:1,error:1,complete:1})T[d](f[d]);if(o=U(Ct,f,n,T)){if(T.readyState=1,c&&m.trigger("ajaxSend",[T,f]),2===x)return T;f.async&&f.timeout>0&&(l=e.setTimeout(function(){T.abort("timeout")},f.timeout));try{x=1,o.send(y,r)}catch(e){if(!(x<2))throw e;r(-1,e)}}else r(-1,"No Transport");return T},getJSON:function(e,t,n){return re.get(e,t,n,"json")},getScript:function(e,t){return re.get(e,void 0,t,"script")}}),re.each(["get","post"],function(e,t){re[t]=function(e,n,r,o){return re.isFunction(n)&&(o=o||r,r=n,n=void 0),re.ajax(re.extend({url:e,type:t,dataType:o,data:n,success:r},re.isPlainObject(e)&&e))}}),re._evalUrl=function(e){return re.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},re.fn.extend({wrapAll:function(e){var t;return re.isFunction(e)?this.each(function(t){re(this).wrapAll(e.call(this,t))}):(this[0]&&(t=re(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return re.isFunction(e)?this.each(function(t){re(this).wrapInner(e.call(this,t))}):this.each(function(){var t=re(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=re.isFunction(e);return this.each(function(n){re(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){re.nodeName(this,"body")||re(this).replaceWith(this.childNodes)}).end()}}),re.expr.filters.hidden=function(e){return!re.expr.filters.visible(e)},re.expr.filters.visible=function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0};var St=/%20/g,It=/\[\]$/,Dt=/\r?\n/g,Et=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;re.param=function(e,t){var n,r=[],o=function(e,t){t=re.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=re.ajaxSettings&&re.ajaxSettings.traditional),re.isArray(e)||e.jquery&&!re.isPlainObject(e))re.each(e,function(){o(this.name,this.value)});else for(n in e)H(n,e[n],t,o);return r.join("&").replace(St,"+")},re.fn.extend({serialize:function(){return re.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=re.prop(this,"elements");return e?re.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!re(this).is(":disabled")&&Ot.test(this.nodeName)&&!Et.test(e)&&(this.checked||!Oe.test(e))}).map(function(e,t){var n=re(this).val();return null==n?null:re.isArray(n)?re.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}}),re.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var _t={0:200,1223:204},kt=re.ajaxSettings.xhr();ne.cors=!!kt&&"withCredentials"in kt,ne.ajax=kt=!!kt,re.ajaxTransport(function(t){var n,r;if(ne.cors||kt&&!t.crossDomain)return{send:function(o,a){var i,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(i in t.xhrFields)s[i]=t.xhrFields[i];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(i in o)s.setRequestHeader(i,o[i]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?a(0,"error"):a(s.status,s.statusText):a(_t[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),re.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return re.globalEval(e),e}}}),re.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),re.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,o){t=re("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),Y.head.appendChild(t[0])},abort:function(){n&&n()}}}});var At=[],jt=/(=)\?(?=&|$)|\?\?/;re.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=At.pop()||re.expando+"_"+mt++;return this[e]=!0,e}}),re.ajaxPrefilter("json jsonp",function(t,n,r){var o,a,i,s=!1!==t.jsonp&&(jt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&jt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=re.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(jt,"$1"+o):!1!==t.jsonp&&(t.url+=(pt.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return i||re.error(o+" was not called"),i[0]},t.dataTypes[0]="json",a=e[o],e[o]=function(){i=arguments},r.always(function(){void 0===a?re(e).removeProp(o):e[o]=a,t[o]&&(t.jsonpCallback=n.jsonpCallback,At.push(o)),i&&re.isFunction(a)&&a(i[0]),i=a=void 0}),"script"}),re.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||Y;var r=fe.exec(e),o=!n&&[];return r?[t.createElement(r[1])]:(r=f([e],t,o),o&&o.length&&re(o).remove(),re.merge([],r.childNodes))};var Rt=re.fn.load;re.fn.load=function(e,t,n){if("string"!=typeof e&&Rt)return Rt.apply(this,arguments);var r,o,a,i=this,s=e.indexOf(" ");return s>-1&&(r=re.trim(e.slice(s)),e=e.slice(0,s)),re.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),i.length>0&&re.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){a=arguments,i.html(r?re("<div>").append(re.parseHTML(e)).find(r):e)}).always(n&&function(e,t){i.each(function(){n.apply(this,a||[e.responseText,t,e])})}),this},re.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){re.fn[t]=function(e){return this.on(t,e)}}),re.expr.filters.animated=function(e){return re.grep(re.timers,function(t){return e===t.elem}).length},re.offset={setOffset:function(e,t,n){var r,o,a,i,s,l,u=re.css(e,"position"),c=re(e),d={};"static"===u&&(e.style.position="relative"),s=c.offset(),a=re.css(e,"top"),l=re.css(e,"left"),("absolute"===u||"fixed"===u)&&(a+l).indexOf("auto")>-1?(i=(r=c.position()).top,o=r.left):(i=parseFloat(a)||0,o=parseFloat(l)||0),re.isFunction(t)&&(t=t.call(e,n,re.extend({},s))),null!=t.top&&(d.top=t.top-s.top+i),null!=t.left&&(d.left=t.left-s.left+o),"using"in t?t.using.call(e,d):c.css(d)}},re.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){re.offset.setOffset(this,e,t)});var t,n,r=this[0],o={top:0,left:0},a=r&&r.ownerDocument;if(a)return t=a.documentElement,re.contains(t,r)?(o=r.getBoundingClientRect(),n=W(a),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===re.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),re.nodeName(e[0],"html")||(r=e.offset()),r.top+=re.css(e[0],"borderTopWidth",!0),r.left+=re.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-re.css(n,"marginTop",!0),left:t.left-r.left-re.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===re.css(e,"position");)e=e.offsetParent;return e||Xe})}}),re.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;re.fn[e]=function(r){return xe(this,function(e,r,o){var a=W(e);if(void 0===o)return a?a[t]:e[r];a?a.scrollTo(n?a.pageXOffset:o,n?o:a.pageYOffset):e[r]=o},e,r,arguments.length)}}),re.each(["top","left"],function(e,t){re.cssHooks[t]=I(ne.pixelPosition,function(e,n){if(n)return n=S(e,t),We.test(n)?re(e).position()[t]+"px":n})}),re.each({Height:"height",Width:"width"},function(e,t){re.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){re.fn[r]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),i=n||(!0===r||!0===o?"margin":"border");return xe(this,function(t,n,r){var o;return re.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===r?re.css(t,n,i):re.style(t,n,r,i)},t,a?r:void 0,a,null)}})}),re.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},size:function(){return this.length}}),re.fn.andSelf=re.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return re});var $t=e.jQuery,Lt=e.$;return re.noConflict=function(t){return e.$===re&&(e.$=Lt),t&&e.jQuery===re&&(e.jQuery=$t),re},t||(e.jQuery=e.$=re),re}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstone",[],t):"object"==typeof exports?exports.cornerstone=t():e.cornerstone=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=53)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnabledElement=function(e){if(void 0===e)throw new Error("getEnabledElement: parameter element must not be undefined");for(var t=0;t<r.length;t++)if(r[t].element===e)return r[t];throw new Error("element not enabled")},t.addEnabledElement=function(e){if(void 0===e)throw new Error("getEnabledElement: enabledElement element must not be undefined");r.push(e)},t.getEnabledElementsByImageId=function(e){var t=[];return r.forEach(function(n){n.image&&n.image.imageId===e&&t.push(n)}),t},t.getEnabledElements=function(){return r};var r=[]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,r.getEnabledElement)(e);if(void 0===n.image&&!n.layers.length)throw new Error("updateImage: image has not been loaded yet");(0,o.default)(n,t)};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.needsRedraw=!0,t&&(e.invalid=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("getDefaultViewport: parameter canvas must not be undefined");if(void 0===t)throw new Error("getDefaultViewport: parameter image must not be undefined");var n={scale:1,translation:{x:0,y:0},voi:{windowWidth:t.windowWidth,windowCenter:t.windowCenter},invert:t.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT},r=e.height/t.rows,o=e.width/t.columns;return n.scale=Math.min(o,r),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return window.performance?performance.now():Date.now()}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e.renderingTools.colorRenderCanvas;n.width=t.width,n.height=t.height;var r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,n.width,n.height);var o=r.getImageData(0,0,t.width,t.height);e.renderingTools.colorRenderCanvasContext=r,e.renderingTools.colorRenderCanvasData=o}function a(e,t){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&e.cachedLut.invert===t.invert?e.cachedLut.lutArray:((0,l.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.lutArray)}function i(e,t){var n=e.renderingTools.lastRenderedImageId,r=e.renderingTools.lastRenderedViewport;return t.imageId!==n||!r||r.windowCenter!==e.viewport.voi.windowCenter||r.windowWidth!==e.viewport.voi.windowWidth||r.invert!==e.viewport.invert||r.rotation!==e.viewport.rotation||r.hflip!==e.viewport.hflip||r.vflip!==e.viewport.vflip}function s(e,t,n){e.renderingTools.colorRenderCanvas||(e.renderingTools.colorRenderCanvas=document.createElement("canvas"));var r=e.renderingTools.colorRenderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&t.getCanvas&&t.getCanvas())return t.getCanvas();if(!1===i(e,t)&&!0!==n)return r;r.width===t.width&&r.height===t.height||o(e,t);var s=window.performance?performance.now():Date.now(),l=a(t,e.viewport);t.stats=t.stats||{},t.stats.lastLutGenerateTime=(window.performance?performance.now():Date.now())-s;var d=e.renderingTools.colorRenderCanvasData,f=e.renderingTools.colorRenderCanvasContext;return t.rgba?(0,c.default)(t,l,d.data):(0,u.default)(t,l,d.data),s=window.performance?performance.now():Date.now(),f.putImageData(d,0,0),t.stats.lastPutImageDataTime=(window.performance?performance.now():Date.now())-s,r}Object.defineProperty(t,"__esModule",{value:!0}),t.renderColorImage=function(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),!0===e.viewport.pixelReplication?(r.imageSmoothingEnabled=!1,r.mozImageSmoothingEnabled=!1):(r.imageSmoothingEnabled=!0,r.mozImageSmoothingEnabled=!0),r.save(),(0,d.default)(e,r);var o=void 0;o=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?f.default.renderer.render(e):s(e,n,t),r.drawImage(o,0,0,n.width,n.height,0,0,n.width,n.height),r.restore(),e.renderingTools.lastRenderedImageId=n.imageId;var a={};a.windowCenter=e.viewport.voi.windowCenter,a.windowWidth=e.viewport.voi.windowWidth,a.invert=e.viewport.invert,a.rotation=e.viewport.rotation,a.hflip=e.viewport.hflip,a.vflip=e.viewport.vflip,e.renderingTools.lastRenderedViewport=a},t.addColorLayer=function(e,t){if(void 0===e)throw new Error("addColorLayer: layer parameter must not be undefined");var n=e.image;if(n.rgba=!0,void 0===n)throw new Error("addColorLayer: image must be loaded before it can be drawn");e.renderingTools=e.renderingTools||{},e.canvas=s(e,n,t);var r=e.canvas.getContext("2d");!0===e.viewport.pixelReplication?(r.imageSmoothingEnabled=!1,r.mozImageSmoothingEnabled=!1):(r.imageSmoothingEnabled=!0,r.mozImageSmoothingEnabled=!0);var o={windowCenter:e.viewport.voi.windowCenter,windowWidth:e.viewport.voi.windowWidth,invert:e.viewport.invert,rotation:e.viewport.rotation,hflip:e.viewport.hflip,vflip:e.viewport.vflip};e.renderingTools.lastRenderedImageId=n.imageId,e.renderingTools.lastRenderedViewport=o};var l=r(n(8)),u=r(n(14)),c=r(n(58)),d=r(n(6)),f=r(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");var o=(0,r.default)(e,n);t.setTransform(o.m[0],o.m[1],o.m[2],o.m[3],o.m[4],o.m[5])};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(17))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={name:"cornerstone-core"};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,i){if(a||i)return(0,r.default)(e,t,n,o,a,i);if(void 0===e.cachedLut){var s=e.maxPixelValue-Math.min(e.minPixelValue,0)+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(s)}var l=e.cachedLut.lutArray,u=e.maxPixelValue,c=e.minPixelValue,d=e.slope,f=e.intercept,h=void 0,m=0;if(c<0&&(m=c),!0===o)for(var p=e.minPixelValue;p<=u;p++)h=255*((p*d+f-n)/t+.5),l[p+-m]=255-h;else for(var g=e.minPixelValue;g<=u;g++)h=255*((g*d+f-n)/t+.5),l[g+-m]=h;return l};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(12))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e.renderingTools.grayscaleRenderCanvas;n.width=t.width,n.height=t.height;var r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,n.width,n.height);var o=r.getImageData(0,0,t.width,t.height);e.renderingTools.grayscaleRenderCanvasContext=r,e.renderingTools.grayscaleRenderCanvasData=o}function a(e,t){return!e&&!t||!(!e||!t)&&e.id===t.id}function i(e,t,n){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&a(e.cachedLut.modalityLUT,t.modalityLUT)&&a(e.cachedLut.voiLUT,t.voiLUT)&&e.cachedLut.invert===t.invert&&!0!==n?e.cachedLut.lutArray:((0,u.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert,t.modalityLUT,t.voiLUT),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.voiLUT=t.voiLUT,e.cachedLut.modalityLUT=t.modalityLUT,e.cachedLut.lutArray)}function s(e,t){var n=e.renderingTools.lastRenderedImageId,r=e.renderingTools.lastRenderedViewport;return t.imageId!==n||!r||r.windowCenter!==e.viewport.voi.windowCenter||r.windowWidth!==e.viewport.voi.windowWidth||r.invert!==e.viewport.invert||r.rotation!==e.viewport.rotation||r.hflip!==e.viewport.hflip||r.vflip!==e.viewport.vflip||r.modalityLUT!==e.viewport.modalityLUT||r.voiLUT!==e.viewport.voiLUT}function l(e,t,n){e.renderingTools.grayscaleRenderCanvas||(e.renderingTools.grayscaleRenderCanvas=document.createElement("canvas"));var r=e.renderingTools.grayscaleRenderCanvas;if(!1===s(e,t)&&!0!==n)return r;r.width===t.width&&r.height===t.height||o(e,t);var a=(0,f.default)(),l=i(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=(0,f.default)()-a;var u=e.renderingTools.grayscaleRenderCanvasData,d=e.renderingTools.grayscaleRenderCanvasContext;return(0,c.default)(t,l,u.data),a=(0,f.default)(),d.putImageData(u,0,0),t.stats.lastPutImageDataTime=(0,f.default)()-a,r}Object.defineProperty(t,"__esModule",{value:!0}),t.renderGrayscaleImage=function(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),!0===e.viewport.pixelReplication?(r.imageSmoothingEnabled=!1,r.mozImageSmoothingEnabled=!1):(r.imageSmoothingEnabled=!0,r.mozImageSmoothingEnabled=!0),(0,d.default)(e,r),e.renderingTools||(e.renderingTools={});var o=void 0;o=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?h.default.renderer.render(e):l(e,n,t),r.drawImage(o,0,0,n.width,n.height,0,0,n.width,n.height),e.renderingTools.lastRenderedImageId=n.imageId;var a={};a.windowCenter=e.viewport.voi.windowCenter,a.windowWidth=e.viewport.voi.windowWidth,a.invert=e.viewport.invert,a.rotation=e.viewport.rotation,a.hflip=e.viewport.hflip,a.vflip=e.viewport.vflip,a.modalityLUT=e.viewport.modalityLUT,a.voiLUT=e.viewport.voiLUT,e.renderingTools.lastRenderedViewport=a},t.addGrayscaleLayer=function(e,t){if(void 0===e)throw new Error("addGrayscaleLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");e.renderingTools=e.renderingTools||{},e.canvas=l(e,n,t);var r=e.canvas.getContext("2d");!0===e.viewport.pixelReplication?(r.imageSmoothingEnabled=!1,r.mozImageSmoothingEnabled=!1):(r.imageSmoothingEnabled=!0,r.mozImageSmoothingEnabled=!0);var o={windowCenter:e.viewport.voi.windowCenter,windowWidth:e.viewport.voi.windowWidth,invert:e.viewport.invert,rotation:e.viewport.rotation,hflip:e.viewport.hflip,vflip:e.viewport.vflip};e.renderingTools.lastRenderedImageId=n.imageId,e.renderingTools.lastRenderedViewport=o};var u=r(n(8)),c=r(n(15)),d=r(n(6)),f=r(n(4)),h=r(n(10))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),a=r(n(31)),i=r(n(32));t.default={createProgramFromString:a.default,renderer:{render:o.render,initRenderer:o.initRenderer,getRenderCanvas:o.getRenderCanvas,isWebGLAvailable:o.isWebGLAvailable},textureCache:i.default,isWebGLInitialized:o.isWebGLInitialized}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(17))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i,s){if(void 0===e.cachedLut){var l=e.maxPixelValue-Math.min(e.minPixelValue,0)+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(l)}var u=e.cachedLut.lutArray,c=e.maxPixelValue,d=e.minPixelValue,f=(0,o.default)(e.slope,e.intercept,i),h=(0,a.default)(t,n,s),m=0;if(d<0&&(m=d),!0===r)for(var p=e.minPixelValue;p<=c;p++)u[p+-m]=255-h(f(p));else for(var g=e.minPixelValue;g<=c;g++)u[g+-m]=h(f(g));return u};var o=r(n(29)),a=r(n(56))},function(e,t,n){"use strict";function r(e){window.setTimeout(e,1e3/60)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return window.requestAnimationFrame(e)||window.webkitRequestAnimationFrame(e)||window.mozRequestAnimationFrame(e)||window.oRequestAnimationFrame(e)||window.msRequestAnimationFrame(e)||r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var o=(0,r.default)(),a=e.getPixelData();e.stats.lastGetPixelDataTime=(0,r.default)()-o;var i=e.minPixelValue,s=0,l=0,u=a.length;if(o=(0,r.default)(),i<0)for(;l<u;)n[s++]=t[a[l++]+-i],n[s++]=t[a[l++]+-i],n[s]=t[a[l]+-i],l+=2,s+=2;else for(;l<u;)n[s++]=t[a[l++]],n[s++]=t[a[l++]],n[s]=t[a[l]],l+=2,s+=2;e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.default)()-o};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var o=(0,r.default)(),a=e.getPixelData();e.stats.lastGetPixelDataTime=(0,r.default)()-o;var i=a.length,s=e.minPixelValue,l=3,u=0;if(o=(0,r.default)(),a instanceof Int16Array)if(s<0)for(;u<i;)n[l]=t[a[u++]+-s],l+=4;else for(;u<i;)n[l]=t[a[u++]],l+=4;else if(a instanceof Uint16Array)for(;u<i;)n[l]=t[a[u++]],l+=4;else if(s<0)for(;u<i;)n[l]=t[a[u++]+-s],l+=4;else for(;u<i;)n[l]=t[a[u++]],l+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.default)()-o};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(4))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r=t.element,o={viewport:t.viewport,element:t.element,image:t.image,enabledElement:t,layerId:n};$(r).trigger(e,o)}function a(e,t){var n=e.image,r=t.image;if(n.imageId&&r.imageId){var o=u.default.get("imagePlane",n.imageId),a=u.default.get("imagePlane",r.imageId);if(o&&o.columnPixelSpacing&&a&&a.columnPixelSpacing){var i=a.columnPixelSpacing*r.width/(o.columnPixelSpacing*n.width),s=t.viewport.scale/e.viewport.scale*i;t.viewport.scale=e.viewport.scale*s}}}function i(e,t){var n=(0,l.getEnabledElement)(e);if(n.activeLayerId!==t){var r=n.layers.findIndex(function(e){return e.layerId===t});if(-1===r)throw new Error("setActiveLayer: layer not found in layers array");var a=n.layers[r];n.activeLayerId=t,n.image=a.image,n.viewport=a.viewport,(0,d.default)(e),o("CornerstoneActiveLayerChanged",n,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.addLayer=function(e,t,n){var r=(0,s.default)(),u=(0,l.getEnabledElement)(e),d=u.layers,f=(0,c.default)(u.canvas,t);!1!==u.syncViewports&&(u.syncViewports=!0);var h={image:t,layerId:r,viewport:f,options:n||{}};return d.length&&a(d[0],h),d.push(h),1===d.length&&i(e,r),o("CornerstoneLayerAdded",u,r),r},t.removeLayer=function(e,t){var n=(0,l.getEnabledElement)(e),r=n.layers,a=n.layers.findIndex(function(e){return e.layerId===t});-1!==a&&(r.splice(a,1),t===n.activeLayerId&&r.length&&i(e,r[0].layerId),o("CornerstoneLayerRemoved",n,t))},t.getLayer=function(e,t){return(0,l.getEnabledElement)(e).layers.find(function(e){return e.layerId===t})},t.getLayers=function(e){return(0,l.getEnabledElement)(e).layers},t.getVisibleLayers=function(e){return(0,l.getEnabledElement)(e).layers.filter(function(e){return e.options&&!1!==e.options.visible&&0!==e.options.opacity})},t.setActiveLayer=i,t.getActiveLayer=function(e){var t=(0,l.getEnabledElement)(e);return t.layers.find(function(e){return e.layerId===t.activeLayerId})};var s=r(n(57)),l=n(0),u=r(n(23)),c=r(n(3)),d=r(n(1));n(68),n(67)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=new r.Transform;n.translate(e.canvas.width/2,e.canvas.height/2);var o=e.viewport.rotation;0!==o&&n.rotate(o*Math.PI/180);var a=e.viewport.scale,i=e.viewport.scale;return e.image.rowPixelSpacing<e.image.columnPixelSpacing?a*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(i*=e.image.rowPixelSpacing/e.image.columnPixelSpacing),n.scale(a,i),0!==o&&n.rotate(-o*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==o&&n.rotate(o*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-e.image.width/2,-e.image.height/2),n};var r=n(30)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27),o=function(e){return e&&e.__esModule?e:{default:e}}(n(28));t.default={getColormap:r.getColormap,getColormapsList:r.getColormapsList,LookupTable:o.default}},function(e,t,n){"use strict";function r(e){for(var t=Number.MAX_VALUE,n=Number.MIN_VALUE,r=e.length,o=void 0,a=0;a<r;a++)t=t<(o=e[a])?t:o,n=n>o?n:o;return{minPixelValue:t,maxPixelValue:n}}function o(e){if(e.restore)return e.restore;var t=e.color,n=e.rgba,r=e.cachedLut,o=e.slope,a=e.windowWidth,i=e.windowCenter,s=e.minPixelValue,l=e.maxPixelValue;return function(){if(e.color=t,e.rgba=n,e.cachedLut=r,e.slope=o,e.windowWidth=a,e.windowCenter=i,e.minPixelValue=s,e.maxPixelValue=l,e.origPixelData){var u=e.origPixelData;e.getPixelData=function(){return u}}e.origPixelData=void 0,e.colormapId=void 0,e.falseColor=void 0}}function a(e){return e&&"string"==typeof e&&(e=(0,c.getColormap)(e)),e}function i(e){return!(!e.restore||"function"!=typeof e.restore)&&(e.restore(),!0)}function s(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n=(t=a(t)).getId();if(e.colormapId===n)return!1;if(i(e),n){var s=e.minPixelValue||0,l=e.maxPixelValue||255;e.restore=o(e);var c=t.createLookupTable();c.setTableRange(s,l),(0,u.default)(e,c);var d=r(e.getPixelData());e.minPixelValue=d.minPixelValue,e.maxPixelValue=d.maxPixelValue,e.colormapId=n}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.restoreImage=t.convertToFalseColorImage=t.convertImageToFalseColorImage=void 0;var l=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(n(24)),c=n(27);t.convertImageToFalseColorImage=s,t.convertToFalseColorImage=function(e,t){return s((0,l.getEnabledElement)(e).image,t)},t.restoreImage=i},function(e,t,n){"use strict";function r(e){return 0===e.viewport.rotation||180===e.viewport.rotation?{width:e.image.columns,height:e.image.rows}:{width:e.image.rows,height:e.image.columns}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,o.getEnabledElement)(e),n=r(t),i=t.canvas.height/n.height,s=t.canvas.width/n.width;t.viewport.scale=Math.min(s,i),t.viewport.translation.x=0,t.viewport.translation.y=0,(0,a.default)(e)};var o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(n(1))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a){if(void 0===e)throw new Error("getStoredPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);for(var i=(0,r.getEnabledElement)(e),s=[],l=0,u=i.image.getPixelData(),c=0;c<a;c++)for(var d=0;d<o;d++){var f=(c+n)*i.image.columns+(d+t);s[l++]=u[f]}return s};var r=n(0)},function(e,t,n){"use strict";function r(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");h=e,o()}function o(){if(!(m<=h)){for(g.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});m>h;){var e=g[g.length-1].imageId;s(e),$(f.default).trigger("CornerstoneImageCachePromiseRemoved",{imageId:e})}var t=l();$(f.default).trigger("CornerstoneImageCacheFull",t)}}function a(e,t){if(void 0===e)throw new Error("getImagePromise: imageId must not be undefined");if(void 0===t)throw new Error("getImagePromise: imagePromise must not be undefined");if(!0===p.hasOwnProperty(e))throw new Error("putImagePromise: imageId already in cache");var n={loaded:!1,imageId:e,sharedCacheKey:void 0,imagePromise:t,timeStamp:new Date,sizeInBytes:0};p[e]=n,g.push(n),t.then(function(e){if(n.loaded=!0,n.image=e,void 0===e.sizeInBytes)throw new Error("putImagePromise: sizeInBytes must not be undefined");if(void 0===e.sizeInBytes.toFixed)throw new Error("putImagePromise: image.sizeInBytes is not a number");n.sizeInBytes=e.sizeInBytes,m+=n.sizeInBytes,n.sharedCacheKey=e.sharedCacheKey,o()})}function i(e){if(void 0===e)throw new Error("getImagePromise: imageId must not be undefined");var t=p[e];if(void 0!==t)return t.timeStamp=new Date,t.imagePromise}function s(e){if(void 0===e)throw new Error("removeImagePromise: imageId must not be undefined");var t=p[e];if(void 0===t)throw new Error("removeImagePromise: imageId was not present in imageCache");t.imagePromise.reject(),g.splice(g.indexOf(t),1),m-=t.sizeInBytes,u(t.imagePromise,t.imageId),delete p[e]}function l(){return{maximumSizeInBytes:h,cacheSizeInBytes:m,numberOfImagesCached:g.length}}function u(e,t){e.then(function(e){e.decache&&e.decache()}).always(function(){delete p[t]})}function c(){for(;g.length>0;)s(g[0].imageId)}function d(e,t){var n=p[e];n&&n.imagePromise.then(function(e){var r=t-e.sizeInBytes;e.sizeInBytes=t,n.sizeInBytes=t,m+=r})}Object.defineProperty(t,"__esModule",{value:!0}),t.cachedImages=void 0,t.setMaximumSizeBytes=r,t.putImagePromise=a,t.getImagePromise=i,t.removeImagePromise=s,t.getCacheInfo=l,t.purgeCache=c,t.changeImageIdCacheSize=d;var f=function(e){return e&&e.__esModule?e:{default:e}}(n(7)),h=1073741824,m=0,p={},g=t.cachedImages=[];t.default={imageCache:p,cachedImages:g,setMaximumSizeBytes:r,putImagePromise:a,getImagePromise:i,removeImagePromise:s,getCacheInfo:l,purgeCache:c,changeImageIdCacheSize:d}},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=void 0;for(n=0;n<a.length&&!(a[n].priority<=t);n++);a.splice(n,0,{priority:t,provider:e})}function o(e){for(var t=0;t<a.length;t++)if(a[t].provider===e){a.splice(t,1);break}}Object.defineProperty(t,"__esModule",{value:!0}),t.addProvider=r,t.removeProvider=o;var a=[];t.default={addProvider:r,removeProvider:o,get:function(e,t){for(var n=0;n<a.length;n++){var r=a[n].provider(e,t);if(void 0!==r)return r}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n=e.minPixelValue,o=0,a=0,i=e.width*e.height,s=e.origPixelData||e.getPixelData(),l=new Uint8Array(4*i),u=t,c=void 0,d=void 0;if(e.color=!0,e.falseColor=!0,e.origPixelData=s,t instanceof r.default.LookupTable)for(t.build();a<i;)c=s[a++],d=t.mapValue(c),l[o++]=d[0],l[o++]=d[1],l[o++]=d[2],l[o++]=d[3];else if(n<0)for(;a<i;)c=s[a++],l[o++]=u[c+-n][0],l[o++]=u[c+-n][1],l[o++]=u[c+-n][2],l[o++]=u[c+-n][3];else for(;a<i;)c=s[a++],l[o++]=u[c][0],l[o++]=u[c][1],l[o++]=u[c][2],l[o++]=u[c][3];e.rgba=!0,e.lut=void 0,e.slope=1,e.minPixelValue=0,e.maxPixelValue=255,e.windowWidth=255,e.windowCenter=128,e.getPixelData=function(){return l}};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(18))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderWebImage=function(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var a=e.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0),a.fillStyle="black",a.fillRect(0,0,e.canvas.width,e.canvas.height),!0===e.viewport.pixelReplication?(a.imageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1):(a.imageSmoothingEnabled=!0,a.mozImageSmoothingEnabled=!0),(0,r.default)(e,a),e.viewport.voi.windowWidth===e.image.windowWidth&&e.viewport.voi.windowCenter===e.image.windowCenter&&!1===e.viewport.invert?a.drawImage(n.getImage(),0,0,n.width,n.height,0,0,n.width,n.height):(0,o.renderColorImage)(e,t)};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(6)),o=n(5)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){t.width=e.clientWidth,t.height=e.clientHeight,t.style.width=e.clientWidth+"px",t.style.height=e.clientHeight+"px"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,a.getEnabledElement)(e);o(e,n.canvas);var r={element:e};$(e).trigger("CornerstoneElementResized",r),void 0!==n.image&&(!0===t?(0,i.default)(e):(0,s.default)(e))};var a=n(0),i=r(n(20)),s=r(n(1))},function(e,t,n){"use strict";function r(e,t,n){for(var r=(t-e)/((n=null===n?100:n)-1),o=[];n-- >0;)o.push(e),e+=r;return o[o.length-1]=t,o}function o(e,t){for(var n=0,r=e.length-1;n<=r;){var o=n+Math.floor((r-n)/2),a=e[o];if(a===t)return o;t<a?r=o-1:n=o+1}return n}function a(e,t){var n=void 0,r=[],a=t.length;for(e.sort(function(e,t){return e-t}),n=0;n<a;n++)r[n]=o(e,t[n]);return r}function i(e,t,n){var o=void 0,i=[],s=[],l=[],u=[];for(n=null===n?1:n,o=0;o<t.length;o++){var c=t[o];i.push((e-1)*c[0]),s.push(c[1]),l.push(c[1])}var d=r(0,1,e);for(o=0;o<e;o++)d[o]=(e-1)*Math.pow(d[o],n);var f=a(i,d);for(o=1;o<e-1;o++){var h=f[o],m=(d[o]-i[h-1])/(i[h]-i[h-1]),p=s[h]-l[h-1];u[o]=m*p+l[h-1]}return u[0]=l[0],u[e-1]=s[t.length-1],u}function s(e,t,n){var r=void 0,o=[];t=null===t?256:t,n=null===n?1:n;var a=i(t,e.red,n),s=i(t,e.green,n),l=i(t,e.blue,n);for(r=0;r<t;r++){var u=[Math.round(255*a[r]),Math.round(255*s[r]),Math.round(255*l[r]),255];o.push(u)}return o}Object.defineProperty(t,"__esModule",{value:!0}),t.getColormapsList=function(){var e=[];return Object.keys(c).forEach(function(t){if(c.hasOwnProperty(t)){var n=c[t];e.push({id:t,name:n.name})}}),e.sort(function(e,t){var n=e.name.toLowerCase(),r=t.name.toLowerCase();return n===r?0:n<r?-1:1}),e},t.getColormap=function(e,t){var n=c[e];return n||(n=c[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=s(n.segmentedData,n.numColors,n.gamma)),{getId:function(){return e},getColorSchemeName:function(){return n.name},setColorSchemeName:function(e){n.name=e},getNumberOfColors:function(){return n.colors.length},setNumberOfColors:function(e){for(;n.colors.length<e;)n.colors.push(u);n.colors.length=e},getColor:function(e){return this.isValidIndex(e)?n.colors[e]:u},getColorRepeating:function(e){var t=n.colors.length;return e=t?e%t:0,this.getColor(e)},setColor:function(e,t){this.isValidIndex(e)&&(n.colors[e]=t)},addColor:function(e){n.colors.push(e)},insertColor:function(e,t){this.isValidIndex(e)&&n.colors.splice(e,1,t)},removeColor:function(e){this.isValidIndex(e)&&n.colors.splice(e,1)},clearColors:function(){n.colors=[]},buildLookupTable:function(e){if(e){var t=void 0,r=n.colors.length;for(e.setNumberOfTableValues(r),t=0;t<r;t++)e.setTableValue(t,n.colors[t])}},createLookupTable:function(){var e=new l.default;return this.buildLookupTable(e),e},isValidIndex:function(e){return e>=0&&e<n.colors.length}}};var l=function(e){return e&&e.__esModule?e:{default:e}}(n(28)),u=[0,0,0,255],c={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[],this.setNumberOfTableValues=function(e){this.NumberOfColors=e},this.setRamp=function(e){this.Ramp=e},this.setTableRange=function(e,t){this.TableRange[0]=e,this.TableRange[1]=t},this.setHueRange=function(e,t){this.HueRange[0]=e,this.HueRange[1]=t},this.setSaturationRange=function(e,t){this.SaturationRange[0]=e,this.SaturationRange[1]=t},this.setValueRange=function(e,t){this.ValueRange[0]=e,this.ValueRange[1]=t},this.setRange=function(e,t){this.InputRange[0]=e,this.InputRange[1]=t},this.setAlphaRange=function(e,t){this.AlphaRange[0]=e,this.AlphaRange[1]=t},this.getColor=function(e){return this.mapValue(e)},this.HSVToRGB=function(e,t,n){if(e>1)throw new Error("HSVToRGB expects hue < 1");var r=[];if(0===t)return r[0]=n,r[1]=n,r[2]=n,r;var o=Math.floor(6*e),a=6*e-o,i=n*(1-t),s=n*(1-t*a),l=n*(1-t*(1-a));switch(o){case 0:case 6:r[0]=n,r[1]=l,r[2]=i;break;case 1:r[0]=s,r[1]=n,r[2]=i;break;case 2:r[0]=i,r[1]=n,r[2]=l;break;case 3:r[0]=i,r[1]=s,r[2]=n;break;case 4:r[0]=l,r[1]=i,r[2]=n;break;case 5:r[0]=n,r[1]=i,r[2]=s}return r},this.build=function(e){if(!(this.Table.length>1)||e){this.Table=[];var t=this.NumberOfColors-1,n=void 0,r=void 0,o=void 0,a=void 0;t?(n=(this.HueRange[1]-this.HueRange[0])/t,r=(this.SaturationRange[1]-this.SaturationRange[0])/t,o=(this.ValueRange[1]-this.ValueRange[0])/t,a=(this.AlphaRange[1]-this.AlphaRange[0])/t):n=r=o=a=0;for(var i=0;i<=t;i++){var s=this.HueRange[0]+i*n,l=this.SaturationRange[0]+i*r,u=this.ValueRange[0]+i*o,c=this.AlphaRange[0]+i*a,d=this.HSVToRGB(s,l,u),f=[];switch(this.Ramp){case"scurve":f[0]=Math.floor(127.5*(1+Math.cos((1-d[0])*Math.PI))),f[1]=Math.floor(127.5*(1+Math.cos((1-d[1])*Math.PI))),f[2]=Math.floor(127.5*(1+Math.cos((1-d[2])*Math.PI))),f[3]=Math.floor(255*c);break;case"linear":f[0]=Math.floor(255*d[0]+.5),f[1]=Math.floor(255*d[1]+.5),f[2]=Math.floor(255*d[2]+.5),f[3]=Math.floor(255*c+.5);break;case"sqrt":f[0]=Math.floor(255*Math.sqrt(d[0])+.5),f[1]=Math.floor(255*Math.sqrt(d[1])+.5),f[2]=Math.floor(255*Math.sqrt(d[2])+.5),f[3]=Math.floor(255*Math.sqrt(c)+.5);break;default:throw new Error("Invalid Ramp value ("+this.Ramp+")")}this.Table.push(f)}this.buildSpecialColors()}},this.buildSpecialColors=function(){var e=this.NumberOfColors,t=e+r,n=e+o,i=e+a;this.UseBelowRangeColor||0===e?this.Table[t]=this.BelowRangeColor:this.Table[t]=this.Table[0],this.UseAboveRangeColor||0===e?this.Table[n]=this.AboveRangeColor:this.Table[n]=this.Table[e-1],this.Table[i]=this.NaNColor},this.mapValue=function(e){var t=this.getIndex(e);if(t<0)return this.NaNColor;if(0===t){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(t===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[t]},this.linearIndexLookupMain=function(e,t){var n=void 0;return n=e<t.Range[0]?t.MaxIndex+r+1.5:e>t.Range[1]?t.MaxIndex+o+1.5:(e+t.Shift)*t.Scale,Math.round(n)},this.getIndex=function(e){var t={};if(t.Range=[],t.MaxIndex=this.NumberOfColors-1,t.Shift=-this.TableRange[0],this.TableRange[1]<=this.TableRange[0]?t.Scale=Number.MAX_VALUE:t.Scale=t.MaxIndex/(this.TableRange[1]-this.TableRange[0]),t.Range[0]=this.TableRange[0],t.Range[1]=this.TableRange[1],isNaN(e))return-1;var n=this.linearIndexLookupMain(e,t);return n===this.NumberOfColors+r?n=0:n===this.NumberOfColors+o&&(n=this.NumberOfColors-1),n},this.setTableValue=function(e,t){if(5===arguments.length&&(t=Array.prototype.slice.call(arguments,1)),e<0)throw new Error("Can't set the table value for negative index ("+e+")");e>=this.NumberOfColors&&new Error("Index "+e+" is greater than the number of colors "+this.NumberOfColors),this.Table[e]=t,0!==e&&e!==this.NumberOfColors-1||this.buildSpecialColors()}};var r=0,o=1,a=2},function(e,t,n){"use strict";function r(e,t){var n=e,r=t;return function(e){return e*n+r}}function o(e){var t=e.lut[0],n=e.lut[e.lut.length-1],r=e.firstValueMapped+e.lut.length;return function(o){return o<e.firstValueMapped?t:o>=r?n:e.lut[o]}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return n?o(n):r(e,t)}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Transform=function(){function e(){r(this,e),this.reset()}return o(e,[{key:"reset",value:function(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function(){var t=new e;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}},{key:"multiply",value:function(e){var t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],r=this.m[0]*e.m[2]+this.m[2]*e.m[3],o=this.m[1]*e.m[2]+this.m[3]*e.m[3],a=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],i=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=a,this.m[5]=i}},{key:"invert",value:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,r=-this.m[2]*e,o=this.m[0]*e,a=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),i=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=a,this.m[5]=i}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.m[0]*t+this.m[2]*n,o=this.m[1]*t+this.m[3]*n,a=this.m[0]*-n+this.m[2]*t,i=this.m[1]*-n+this.m[3]*t;this.m[0]=r,this.m[1]=o,this.m[2]=a,this.m[3]=i}},{key:"translate",value:function(e,t){this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t}},{key:"scale",value:function(e,t){this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t}},{key:"transformPoint",value:function(e,t){var n=e,r=t;return e=n*this.m[0]+r*this.m[2]+this.m[4],t=n*this.m[1]+r*this.m[3]+this.m[5],{x:e,y:t}}}]),e}()},function(e,t,n){"use strict";function r(e,t,n){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)&&!e.isContextLost()){var o=e.getShaderInfoLog(r);console.error("Could not compile shader:\n"+o)}return r}function o(e,t,n){var r=e.createProgram();if(e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS)&&!e.isContextLost()){var o=e.getProgramInfoLog(r);console.error("WebGL program filed to link:\n"+o)}return r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return o(e,r(e,t,e.VERTEX_SHADER),r(e,n,e.FRAGMENT_SHADER))}},function(e,t,n){"use strict";function r(){return{maximumSizeInBytes:l,cacheSizeInBytes:u,numberOfImagesCached:s.length}}function o(){if(!(u<=l)){for(s.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});u>l;){var e=s[s.length-1];u-=e.sizeInBytes,delete i[e.imageId],s.pop(),$(a.default).trigger("CornerstoneWebGLTextureRemoved",{imageId:e.imageId})}var t=r();$(a.default).trigger("CornerstoneWebGLTextureCacheFull",t)}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(7)),i={},s=[],l=268435456,u=0;t.default={purgeCache:function(){for(;s.length>0;){var e=s.pop();delete i[e.imageId]}u=0},getImageTexture:function(e){if(void 0===e)throw new Error("getImageTexture: imageId must not be undefined");var t=i[e];if(void 0!==t)return t.timeStamp=new Date,t.imageTexture},putImageTexture:function(e,t){var n=e.imageId;if(void 0===e)throw new Error("putImageTexture: image must not be undefined");if(void 0===n)throw new Error("putImageTexture: imageId must not be undefined");if(void 0===t)throw new Error("putImageTexture: imageTexture must not be undefined");if(!0===Object.prototype.hasOwnProperty.call(i,n))throw new Error("putImageTexture: imageId already in cache");var r={imageId:n,imageTexture:t,timeStamp:new Date,sizeInBytes:t.sizeInBytes};if(i[n]=r,s.push(r),void 0===t.sizeInBytes)throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===t.sizeInBytes.toFixed)throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");u+=r.sizeInBytes,o()},removeImageTexture:function(e){if(void 0===e)throw new Error("removeImageTexture: imageId must not be undefined");var t=i[e];if(void 0===t)throw new Error("removeImageTexture: imageId must not be undefined");return s.splice(s.indexOf(t),1),u-=t.sizeInBytes,delete i[e],t.imageTexture},setMaximumSizeBytes:function(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");l=e,o()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,r.getEnabledElement)(e),a=(0,o.default)(n);return a.invert(),a.transformPoint(t.x,t.y)};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(void 0===e)throw new Error("disable: element must not be undefined");for(var t=(0,r.getEnabledElements)(),n=0;n<t.length;n++)if(t[n].element===e){var o={element:e};$(e).trigger("CornerstoneElementDisabled",o),t[n].element.removeChild(t[n].canvas),t[n].canvas=void 0,t.splice(n,1);break}};var r=n(0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw new Error("displayImage: parameter element must not be undefined");if(void 0===t)throw new Error("displayImage: parameter image must not be undefined");var r=(0,o.getEnabledElement)(e),u=r.image;if(r.image=t,r.layers&&r.layers.length&&((0,l.getActiveLayer)(e).image=t),void 0===r.viewport&&(r.viewport=(0,a.default)(r.canvas,t)),n)for(var c in n)null!==n[c]&&(r.viewport[c]=n[c]);var d=void 0;void 0!==r.lastImageTimeStamp&&(d=(1e3/((0,s.default)()-r.lastImageTimeStamp)).toFixed()),r.lastImageTimeStamp=(0,s.default)();var f={viewport:r.viewport,element:r.element,image:r.image,oldImage:u,enabledElement:r,frameRate:d};$(r.element).trigger("CornerstoneNewImage",f),(0,i.default)(e)};var o=n(0),a=r(n(3)),i=r(n(1)),s=r(n(4)),l=n(16)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,r.getEnabledElement)(e);if(void 0===t.image)throw new Error("draw: image has not been loaded yet");(0,o.default)(t)};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=(0,r.getEnabledElements)(),t=0;t<e.length;t++){var n=e[t];!0===n.invalid&&(0,o.default)(n,!0)}};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return void 0!==e.image||e.layers.length}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(e){void 0!==c.canvas&&($(c.element).trigger("CornerstonePreRender",{enabledElement:c,timestamp:e}),c.needsRedraw&&o(c)&&(0,s.default)(c,c.invalid),(0,l.default)(n))}if(void 0===e)throw new Error("enable: parameter element cannot be undefined");t&&t.renderer&&"webgl"===t.renderer.toLowerCase()&&(u.default.renderer.isWebGLAvailable()?(u.default.renderer.initRenderer(),t.renderer="webgl"):(console.error("WebGL not available, falling back to Canvas renderer"),delete t.renderer));var r=document.createElement("canvas");e.appendChild(r);var c={element:e,canvas:r,image:void 0,invalid:!1,needsRedraw:!0,options:t,layers:[],data:{},renderingTools:{}};(0,a.addEnabledElement)(c),(0,i.default)(e,!0),n()};var a=n(0),i=r(n(26)),s=r(n(55)),l=r(n(13)),u=r(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementData=function(e,t){var n=(0,r.getEnabledElement)(e);return!1===n.data.hasOwnProperty(t)&&(n.data[t]={}),n.data[t]},t.removeElementData=function(e,t){delete(0,r.getEnabledElement)(e).data[t]};var r=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,r.getEnabledElement)(e);return(0,o.default)(n.canvas,t)};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(3))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.getEnabledElement)(e).image};var r=n(0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,s){var l=(0,a.default)(e,t,n,r,s),u=(0,o.getEnabledElement)(e),c=(0,i.default)(u.image.slope,u.image.intercept,u.viewport.modalityLUT);return l.map(c)};var o=n(0),a=r(n(21)),i=r(n(29))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,r.getEnabledElement)(e).viewport;if(void 0!==t)return{scale:t.scale,translation:{x:t.translation.x,y:t.translation.y},voi:{windowWidth:t.voi.windowWidth,windowCenter:t.voi.windowCenter},invert:t.invert,pixelReplication:t.pixelReplication,rotation:t.rotation,hflip:t.hflip,vflip:t.vflip,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT}};var r=n(0)},function(e,t,n){"use strict";function r(e,t){var n=e.indexOf(":"),r=e.substring(0,n),o=i[r],l=void 0;if(void 0===o||null===o){if(void 0!==s)return l=s(e);throw new Error("loadImageFromImageLoader: no image loader for imageId")}return(l=o(e,t)).then(function(e){$(a.default).trigger("CornerstoneImageLoaded",{image:e})}),l}Object.defineProperty(t,"__esModule",{value:!0}),t.loadImage=function(e,t){if(void 0===e)throw new Error("loadImage: parameter imageId must not be undefined");var n=(0,o.getImagePromise)(e);return void 0!==n?n:n=r(e,t)},t.loadAndCacheImage=function(e,t){if(void 0===e)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");var n=(0,o.getImagePromise)(e);return void 0!==n?n:(n=r(e,t),(0,o.putImagePromise)(e,n),n)},t.registerImageLoader=function(e,t){i[e]=t},t.registerUnknownImageLoader=function(e){var t=s;return s=e,t};var o=n(22),a=function(e){return e&&e.__esModule?e:{default:e}}(n(7)),i={},s=void 0},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(2)),a=r(n(8)),i=r(n(12)),s=r(n(3)),l=r(n(13)),u=r(n(15)),c=r(n(14)),d=r(n(11)),f=r(n(17)),h=n(30);t.default={drawImage:o.default,generateLut:a.default,generateLutNew:i.default,getDefaultViewport:s.default,requestAnimationFrame:l.default,storedPixelDataToCanvasImageData:u.default,storedColorPixelDataToCanvasImageData:c.default,getTransform:d.default,calculateTransform:f.default,Transform:h.Transform}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,r.getEnabledElement)(e);t.invalid=!0,t.needsRedraw=!0;var n={element:e};$(e).trigger("CornerstoneInvalidated",n)};var r=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,r.getEnabledElementsByImageId)(e).forEach(function(e){(0,o.default)(e,!0)})};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var a=(0,r.getEnabledElement)(e);if(void 0===a.image)throw new Error("image has not been loaded yet");var i=e.getBoundingClientRect(),s={x:t-i.left-window.pageXOffset,y:n-i.top-window.pageYOffset},l=(0,o.default)(a);return l.invert(),l.transformPoint(s.x,s.y)};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,r.getEnabledElement)(e);return(0,o.default)(n).transformPoint(t.x,t.y)};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),o=n(9),a=n(25);t.default={colorImage:r.renderColorImage,grayscaleImage:o.renderGrayscaleImage,webImage:a.renderWebImage}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,o.getEnabledElement)(e);t.viewport=(0,a.default)(t.canvas,t.image),(0,i.default)(e)};var o=n(0),a=r(n(3)),i=r(n(1))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,r.getEnabledElement)(e);n.viewport.scale=t.scale,n.viewport.translation.x=t.translation.x,n.viewport.translation.y=t.translation.y,n.viewport.voi.windowWidth=t.voi.windowWidth,n.viewport.voi.windowCenter=t.voi.windowCenter,n.viewport.invert=t.invert,n.viewport.pixelReplication=t.pixelReplication,n.viewport.rotation=t.rotation,n.viewport.hflip=t.hflip,n.viewport.vflip=t.vflip,n.viewport.modalityLUT=t.modalityLUT,n.viewport.voiLUT=t.voiLUT,n.viewport.voi.windowWidth=Math.max(n.viewport.voi.windowWidth,a),n.viewport.scale=Math.max(n.viewport.scale,i),n.viewport.rotation%=360,n.viewport.rotation<0&&(n.viewport.rotation+=360),(0,o.default)(e)};var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),a=1e-6,i=1e-4},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2);Object.defineProperty(t,"drawImage",{enumerable:!0,get:function(){return r(o).default}});var a=n(8);Object.defineProperty(t,"generateLut",{enumerable:!0,get:function(){return r(a).default}});var i=n(12);Object.defineProperty(t,"generateLutNew",{enumerable:!0,get:function(){return r(i).default}});var s=n(3);Object.defineProperty(t,"getDefaultViewport",{enumerable:!0,get:function(){return r(s).default}});var l=n(13);Object.defineProperty(t,"requestAnimationFrame",{enumerable:!0,get:function(){return r(l).default}});var u=n(15);Object.defineProperty(t,"storedPixelDataToCanvasImageData",{enumerable:!0,get:function(){return r(u).default}});var c=n(14);Object.defineProperty(t,"storedColorPixelDataToCanvasImageData",{enumerable:!0,get:function(){return r(c).default}});var d=n(45);Object.defineProperty(t,"internal",{enumerable:!0,get:function(){return r(d).default}});var f=n(5);Object.defineProperty(t,"renderColorImage",{enumerable:!0,get:function(){return f.renderColorImage}});var h=n(9);Object.defineProperty(t,"renderGrayscaleImage",{enumerable:!0,get:function(){return h.renderGrayscaleImage}});var m=n(25);Object.defineProperty(t,"renderWebImage",{enumerable:!0,get:function(){return m.renderWebImage}});var p=n(33);Object.defineProperty(t,"canvasToPixel",{enumerable:!0,get:function(){return r(p).default}});var g=n(34);Object.defineProperty(t,"disable",{enumerable:!0,get:function(){return r(g).default}});var v=n(35);Object.defineProperty(t,"displayImage",{enumerable:!0,get:function(){return r(v).default}});var y=n(36);Object.defineProperty(t,"draw",{enumerable:!0,get:function(){return r(y).default}});var b=n(37);Object.defineProperty(t,"drawInvalidated",{enumerable:!0,get:function(){return r(b).default}});var x=n(38);Object.defineProperty(t,"enable",{enumerable:!0,get:function(){return r(x).default}});var w=n(39);Object.defineProperty(t,"getElementData",{enumerable:!0,get:function(){return w.getElementData}}),Object.defineProperty(t,"removeElementData",{enumerable:!0,get:function(){return w.removeElementData}});var T=n(0);Object.defineProperty(t,"getEnabledElement",{enumerable:!0,get:function(){return T.getEnabledElement}}),Object.defineProperty(t,"addEnabledElement",{enumerable:!0,get:function(){return T.addEnabledElement}}),Object.defineProperty(t,"getEnabledElementsByImageId",{enumerable:!0,get:function(){return T.getEnabledElementsByImageId}}),Object.defineProperty(t,"getEnabledElements",{enumerable:!0,get:function(){return T.getEnabledElements}});var C=n(16);Object.defineProperty(t,"addLayer",{enumerable:!0,get:function(){return C.addLayer}}),Object.defineProperty(t,"removeLayer",{enumerable:!0,get:function(){return C.removeLayer}}),Object.defineProperty(t,"getLayer",{enumerable:!0,get:function(){return C.getLayer}}),Object.defineProperty(t,"getLayers",{enumerable:!0,get:function(){return C.getLayers}}),Object.defineProperty(t,"getVisibleLayers",{enumerable:!0,get:function(){return C.getVisibleLayers}}),Object.defineProperty(t,"setActiveLayer",{enumerable:!0,get:function(){return C.setActiveLayer}}),Object.defineProperty(t,"getActiveLayer",{enumerable:!0,get:function(){return C.getActiveLayer}});var P=n(20);Object.defineProperty(t,"fitToWindow",{enumerable:!0,get:function(){return r(P).default}});var M=n(40);Object.defineProperty(t,"getDefaultViewportForImage",{enumerable:!0,get:function(){return r(M).default}});var S=n(41);Object.defineProperty(t,"getImage",{enumerable:!0,get:function(){return r(S).default}});var I=n(42);Object.defineProperty(t,"getPixels",{enumerable:!0,get:function(){return r(I).default}});var D=n(21);Object.defineProperty(t,"getStoredPixels",{enumerable:!0,get:function(){return r(D).default}});var E=n(43);Object.defineProperty(t,"getViewport",{enumerable:!0,get:function(){return r(E).default}});var O=n(44);Object.defineProperty(t,"loadImage",{enumerable:!0,get:function(){return O.loadImage}}),Object.defineProperty(t,"loadAndCacheImage",{enumerable:!0,get:function(){return O.loadAndCacheImage}}),Object.defineProperty(t,"registerImageLoader",{enumerable:!0,get:function(){return O.registerImageLoader}}),Object.defineProperty(t,"registerUnknownImageLoader",{enumerable:!0,get:function(){return O.registerUnknownImageLoader}});var _=n(46);Object.defineProperty(t,"invalidate",{enumerable:!0,get:function(){return r(_).default}});var k=n(47);Object.defineProperty(t,"invalidateImageId",{enumerable:!0,get:function(){return r(k).default}});var A=n(48);Object.defineProperty(t,"pageToPixel",{enumerable:!0,get:function(){return r(A).default}});var j=n(49);Object.defineProperty(t,"pixelToCanvas",{enumerable:!0,get:function(){return r(j).default}});var R=n(51);Object.defineProperty(t,"reset",{enumerable:!0,get:function(){return r(R).default}});var $=n(26);Object.defineProperty(t,"resize",{enumerable:!0,get:function(){return r($).default}});var L=n(6);Object.defineProperty(t,"setToPixelCoordinateSystem",{enumerable:!0,get:function(){return r(L).default}});var B=n(52);Object.defineProperty(t,"setViewport",{enumerable:!0,get:function(){return r(B).default}});var N=n(1);Object.defineProperty(t,"updateImage",{enumerable:!0,get:function(){return r(N).default}});var F=n(24);Object.defineProperty(t,"pixelDataToFalseColorData",{enumerable:!0,get:function(){return r(F).default}});var U=n(50);Object.defineProperty(t,"rendering",{enumerable:!0,get:function(){return r(U).default}});var z=n(22);Object.defineProperty(t,"imageCache",{enumerable:!0,get:function(){return r(z).default}});var q=n(23);Object.defineProperty(t,"metaData",{enumerable:!0,get:function(){return r(q).default}});var V=n(10);Object.defineProperty(t,"webGL",{enumerable:!0,get:function(){return r(V).default}});var H=n(18);Object.defineProperty(t,"colors",{enumerable:!0,get:function(){return r(H).default}});var W=n(19);Object.defineProperty(t,"convertImageToFalseColorImage",{enumerable:!0,get:function(){return W.convertImageToFalseColorImage}}),Object.defineProperty(t,"convertToFalseColorImage",{enumerable:!0,get:function(){return W.convertToFalseColorImage}}),Object.defineProperty(t,"restoreImage",{enumerable:!0,get:function(){return W.restoreImage}});var G=n(7);Object.defineProperty(t,"events",{enumerable:!0,get:function(){return r(G).default}})},function(e,t,n){"use strict";function r(e){return{rotation:e.rotation,scale:e.scale,translation:{x:e.translation.x,y:e.translation.y}}}function o(e,t){e.forEach(function(e){if(e!==t){var n=d[t.layerId],r=(d[e.layerId]||e.viewport).scale/n.scale;e.viewport.scale=t.viewport.scale*r,e.viewport.rotation=t.viewport.rotation,e.viewport.translation={x:t.viewport.translation.x/r,y:t.viewport.translation.y/r}}})}function a(e,t,n,r){var o=e.canvas;n.forEach(function(t){e.save(),t.canvas=o,(0,c.default)(t,e);var n=void 0;n=t.options.colormap?(0,u.convertImageToFalseColorImage)(t.image,t.options.colormap):(0,u.restoreImage)(t.image),r=r||n,!0===t.image.color?(0,s.addColorLayer)(t,r):(0,l.addGrayscaleLayer)(t,r),t.options&&t.options.opacity?e.globalAlpha=t.options.opacity:e.globalAlpha=1,t.options&&t.options.fillStyle&&(e.fillStyle=t.options.fillStyle),e.drawImage(t.canvas,0,0,t.image.width,t.image.height,0,0,t.image.width,t.image.height),e.restore()})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.element,s=(0,i.getLayers)(n),l=(0,i.getActiveLayer)(n),u=(0,i.getVisibleLayers)(n),c=!e.lastSyncViewportsState&&e.syncViewports;e.lastSyncViewportsState=e.syncViewports,c&&s.forEach(function(e){d[e.layerId]=r(e.viewport)}),!0===e.syncViewports&&o(u,l);var f=e.canvas.getContext("2d");f.setTransform(1,0,0,1,0,0),f.fillStyle="black",f.fillRect(0,0,e.canvas.width,e.canvas.height),a(f,0,u,t)};var i=n(16),s=n(5),l=n(9),u=n(19),c=function(e){return e&&e.__esModule?e:{default:e}}(n(6)),d={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.image,r=e.element,l=e.layers||[];if(e.canvas&&(e.image||l.length)){var u=(0,o.default)();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},l&&l.length)(0,a.default)(e,t);else if(n){var c=n.render;c||(c=n.color?i.renderColorImage:s.renderGrayscaleImage),c(e,t)}var d=(0,o.default)()-u,f={viewport:e.viewport,element:r,image:n,enabledElement:e,canvasContext:e.canvas.getContext("2d"),renderTimeInMs:d};n.stats.lastRenderTime=d,e.invalid=!1,e.needsRedraw=!1,$(r).trigger("CornerstoneImageRendered",f)}};var o=r(n(4)),a=r(n(54)),i=n(5),s=n(9)},function(e,t,n){"use strict";function r(e,t){return function(n){return 255*((n-t)/e+.5)}}function o(e){var t=e.numBitsPerEntry-8,n=e.lut[0]>>t,r=e.lut[e.lut.length-1]>>t,o=e.firstValueMapped+e.lut.length-1;return function(a){return a<e.firstValueMapped?n:a>=o?r:e.lut[a-e.firstValueMapped]>>t}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return n?o(n):r(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var o=(0,r.default)(),a=e.getPixelData();e.stats.lastGetPixelDataTime=(0,r.default)()-o;var i=e.minPixelValue,s=0,l=0,u=a.length;if(o=(0,r.default)(),i<0)for(;l<u;)n[s++]=t[a[l++]+-i],n[s++]=t[a[l++]+-i],n[s++]=t[a[l++]+-i],n[s++]=a[l++];else for(;l<u;)n[s++]=t[a[l++]],n[s++]=t[a[l++]],n[s++]=t[a[l++]],n[s++]=a[l++];e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.default)()-o};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(4))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){for(var e in g.shaders){var t=g.shaders[e];t.attributes={},t.uniforms={},t.vert=v.vertexShader,t.program=(0,b.default)(w,t.vert,t.frag),t.attributes.texCoordLocation=w.getAttribLocation(t.program,"a_texCoord"),w.enableVertexAttribArray(t.attributes.texCoordLocation),t.attributes.positionLocation=w.getAttribLocation(t.program,"a_position"),w.enableVertexAttribArray(t.attributes.positionLocation),t.uniforms.resolutionLocation=w.getUniformLocation(t.program,"u_resolution")}}function a(){!0!==P&&u(x)&&(m(),o(),t.isWebGLInitialized=P=!0)}function i(e,t,n){e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,n,0,n,t,0,0,0]),e.STATIC_DRAW)}function s(e){e.preventDefault(),console.warn("WebGL Context Lost!")}function l(e){e.preventDefault(),t.isWebGLInitialized=P=!1,y.default.purgeCache(),a()}function u(e){w=null;try{var t={preserveDrawingBuffer:!0};w=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),e.removeEventListener("webglcontextlost",s,!1),e.addEventListener("webglcontextlost",s,!1),e.removeEventListener("webglcontextrestored",l,!1),e.addEventListener("webglcontextrestored",l,!1)}catch(e){throw new Error("Error creating WebGL context")}return w||(console.error("Unable to initialize WebGL. Your browser may not support it."),w=null),w}function c(e){if(e.color)return"rgb";var t="int";return e.minPixelValue>=0&&(t="u"+t),e.maxPixelValue>255?t+="16":t+="8",t}function d(e){var t=c(e);return g.shaders.hasOwnProperty(t)?g.shaders[t]:g.shaders.rgb}function f(e){var t={uint8:w.LUMINANCE,int8:w.LUMINANCE_ALPHA,uint16:w.LUMINANCE_ALPHA,int16:w.RGB,rgb:w.RGB},n={int8:1,uint16:2,int16:3,rgb:3},r=c(e),o=t[r],a=w.createTexture();w.bindTexture(w.TEXTURE_2D,a),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.pixelStorei(w.UNPACK_ALIGNMENT,1);var i=g.dataUtilities[r].storedPixelDataToImageData(e,e.width,e.height);return w.texImage2D(w.TEXTURE_2D,0,o,e.width,e.height,0,o,w.UNSIGNED_BYTE,i),{texture:a,sizeInBytes:e.width*e.height*n[r]}}function h(e){var t=y.default.getImageTexture(e.imageId);return t||(t=f(e),y.default.putImageTexture(e,t)),t.texture}function m(){C=w.createBuffer(),w.bindBuffer(w.ARRAY_BUFFER,C),w.bufferData(w.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),w.STATIC_DRAW),T=w.createBuffer(),w.bindBuffer(w.ARRAY_BUFFER,T),w.bufferData(w.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),w.STATIC_DRAW)}function p(e,t,n,r,o){w.clearColor(1,0,0,1),w.viewport(0,0,r,o),w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT),w.useProgram(e.program),w.bindBuffer(w.ARRAY_BUFFER,T),w.vertexAttribPointer(e.attributes.texCoordLocation,2,w.FLOAT,!1,0,0),w.bindBuffer(w.ARRAY_BUFFER,C),w.vertexAttribPointer(e.attributes.positionLocation,2,w.FLOAT,!1,0,0);for(var a in t){var s=w.getUniformLocation(e.program,a);if(s){var l=t[a],u=l.type,c=l.value;"i"===u?w.uniform1i(s,c):"f"===u?w.uniform1f(s,c):"2f"===u&&w.uniform2f(s,c[0],c[1])}}i(w,r,o),w.activeTexture(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,n),w.drawArrays(w.TRIANGLE_STRIP,0,4)}Object.defineProperty(t,"__esModule",{value:!0}),t.isWebGLInitialized=void 0,t.getRenderCanvas=function(){return x},t.initRenderer=a,t.render=function(e){var t=e.image;x.width=t.width,x.height=t.height;var n=e.viewport,r=d(t),o=h(t);return p(r,{u_resolution:{type:"2f",value:[t.width,t.height]},wc:{type:"f",value:n.voi.windowCenter},ww:{type:"f",value:n.voi.windowWidth},slope:{type:"f",value:t.slope},intercept:{type:"f",value:t.intercept},minPixelValue:{type:"f",value:t.minPixelValue},invert:{type:"i",value:n.invert?1:0}},o,t.width,t.height),x},t.isWebGLAvailable=function(){var e={failIfMajorPerformanceCaveat:!0};try{var t=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(t.getContext("webgl",e)||t.getContext("experimental-webgl",e))}catch(e){return!1}};var g=n(60),v=n(66),y=r(n(32)),b=r(n(31)),x=document.createElement("canvas"),w=void 0,T=void 0,C=void 0,P=!1;t.isWebGLInitialized=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataUtilities=t.shaders=void 0;var r=n(61),o=n(62),a=n(63),i=n(64),s=n(65),l={int16:r.int16Shader,int8:o.int8Shader,rgb:a.rgbShader,uint16:i.uint16Shader,uint8:s.uint8Shader},u={int16:r.int16DataUtilities,int8:o.int8DataUtilities,rgb:a.rgbDataUtilities,uint16:i.uint16DataUtilities,uint8:s.uint8DataUtilities};t.shaders=l,t.dataUtilities=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};t.int16DataUtilities={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*3),r=0,o=0;o<t.length;o++){var a=Math.abs(t[o]);n[r++]=parseInt(255&a,10),n[r++]=parseInt(a>>8,10),n[r++]=t[o]<0?0:1}return n}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",t.int16Shader=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};t.int8DataUtilities={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),r=0,o=0;o<t.length;o++)n[r++]=parseInt(t[o],10),n[r++]=t[o]<0?0:1;return n}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",t.int8Shader=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};t.rgbDataUtilities={storedPixelDataToImageData:function(e){var t=e.minPixelValue,n=0,r=0,o=e.width*e.height*4,a=e.width*e.height*3,i=e.getPixelData(),s=new Uint8Array(a);if(t<0)for(;r<o;)s[n++]=i[r++]+-t,s[n++]=i[r++]+-t,s[n++]=i[r++]+-t,r+=1;else for(;r<o;)s[n++]=i[r++],s[n++]=i[r++],s[n++]=i[r++],r+=1;return s}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}",t.rgbShader=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};t.uint16DataUtilities={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),r=0,o=0;o<t.length;o++){var a=t[o];n[r++]=parseInt(255&a,10),n[r++]=parseInt(a>>8,10)}return n}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",t.uint16Shader=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};t.uint8DataUtilities={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=parseInt(t[r],10);return n}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",t.uint8Shader=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.vertexShader="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"},function(e,t){Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],a=0;a<r;a++)if(t=n[a],e.call(o,t,a,n))return a;return-1})},function(e,t){Array.prototype.find||(Array.prototype.find=function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],a=0;a<r;a++)if(t=n[a],e.call(o,t,a,n))return t})}])}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneMath",[],t):"object"==typeof exports?exports.cornerstoneMath=t():e.cornerstoneMath=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.degToRad=function(e){return e*(Math.PI/180)},t.radToDeg=function(e){return e*(180/Math.PI)},t.sign=function(e){return"number"==typeof e?e?e<0?-1:1:e===e?0:NaN:NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(3)),o=n(0),a=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};a.prototype={constructor:a,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyAxisAngle:function(){var e=void 0;return function(t,n){return void 0===e&&(e=new r.default),this.applyQuaternion(e.setFromAxisAngle(t,n)),this}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*r,this.y=o[1]*t+o[4]*n+o[7]*r,this.z=o[2]*t+o[5]*n+o[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12],this.y=o[1]*t+o[5]*n+o[9]*r+o[13],this.z=o[2]*t+o[6]*n+o[10]*r+o[14],this},applyProjection:function(e){var t=this.x,n=this.y,r=this.z,o=e.elements,a=1/(o[3]*t+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*r+o[12])*a,this.y=(o[1]*t+o[5]*n+o[9]*r+o[13])*a,this.z=(o[2]*t+o[6]*n+o[10]*r+o[14])*a,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,o=e.x,a=e.y,i=e.z,s=e.w,l=s*t+a*r-i*n,u=s*n+i*t-o*r,c=s*r+o*n-a*t,d=-o*t-a*n-i*r;return this.x=l*s+d*-o+u*-i-c*-a,this.y=u*s+d*-a+c*-o-l*-i,this.z=c*s+d*-i+l*-a-u*-o,this},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r,this.y=o[1]*t+o[5]*n+o[9]*r,this.z=o[2]*t+o[6]*n+o[10]*r,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e=void 0,t=void 0;return function(n,r){return void 0===e&&(e=new a,t=new a),e.set(n,n,n),t.set(r,r,r),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,r=this.y,o=this.z;return this.x=r*e.z-o*e.y,this.y=o*e.x-n*e.z,this.z=n*e.y-r*e.x,this},crossVectors:function(e,t){var n=e.x,r=e.y,o=e.z,a=t.x,i=t.y,s=t.z;return this.x=r*s-o*i,this.y=o*a-n*s,this.z=n*i-r*a,this},projectOnVector:function(){var e=void 0,t=void 0;return function(n){return void 0===e&&(e=new a),e.copy(n).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e=void 0;return function(t){return void 0===e&&(e=new a),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=void 0;return function(t){return void 0===e&&(e=new a),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos((0,o.clamp)(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),r=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){var n=4*e,r=t.elements;return this.x=r[n],this.y=r[n+1],this.z=r[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new a(this.x,this.y,this.z)}},t.default=a},function(e,t,n){"use strict";function r(e){return e*e}function o(e,t){return r(e.x-t.x)+r(e.y-t.y)}function a(e,t){var n=o(e.start,e.end);if(0===n)return o(t,e.start);var r=((t.x-e.start.x)*(e.end.x-e.start.x)+(t.y-e.start.y)*(e.end.y-e.start.y))/n;return r<0?o(t,e.start):r>1?o(t,e.end):o(t,{x:e.start.x+r*(e.end.x-e.start.x),y:e.start.y+r*(e.end.y-e.start.y)})}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s={distanceToPoint:function(e,t){return Math.sqrt(a(e,t))},intersectLine:function(e,t){var n={},r=e.start.x,o=e.start.y,a=e.end.x,s=e.end.y,l=t.start.x,u=t.start.y,c=t.end.x,d=t.end.y,f=void 0,h=void 0,m=void 0,p=void 0,g=void 0,v=void 0,y=void 0,b=void 0,x=void 0,w=void 0,T=void 0,C=void 0;if(f=s-o,m=r-a,g=a*o-r*s,x=f*l+m*u+g,w=f*c+m*d+g,(0===x||0===w||(0,i.sign)(x)!==(0,i.sign)(w))&&(h=d-u,p=l-c,v=c*u-l*d,y=h*r+p*o+v,b=h*a+p*s+v,0===y||0===b||(0,i.sign)(y)!==(0,i.sign)(b))){T=f*p-h*m,C=m*v-p*g;var P=parseFloat(C/T);C=h*g-f*v;var M=parseFloat(C/T);return n.x=P,n.y=M,n}}};t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1};r.prototype.setFromAxisAngle=function(e,t){var n=t/2,r=Math.sin(n);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(n),this},r.prototype.multiplyQuaternions=function(e,t){var n=e.x,r=e.y,o=e.z,a=e.w,i=t.x,s=t.y,l=t.z,u=t.w;return this.x=n*u+a*i+r*l-o*s,this.y=r*u+a*s+o*i-n*l,this.z=o*u+a*l+n*s-r*i,this.w=a*u-n*i-r*s-o*l,this},r.prototype.setFromRotationMatrix=function(e){var t=e.elements,n=t[0],r=t[4],o=t[8],a=t[1],i=t[5],s=t[9],l=t[2],u=t[6],c=t[10],d=n+i+c,f=void 0;return d>0?(f=.5/Math.sqrt(d+1),this.w=.25/f,this.x=(u-s)*f,this.y=(o-l)*f,this.z=(a-r)*f):n>i&&n>c?(f=2*Math.sqrt(1+n-i-c),this.w=(u-s)/f,this.x=.25*f,this.y=(r+a)/f,this.z=(o+l)/f):i>c?(f=2*Math.sqrt(1+i-n-c),this.w=(o-l)/f,this.x=(r+a)/f,this.y=.25*f,this.z=(s+u)/f):(f=2*Math.sqrt(1+c-n-i),this.w=(a-r)/f,this.x=(o+l)/f,this.y=(s+u)/f,this.z=.25*f),this},t.default=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=n(0),s=function(){function e(t,n){r(this,e),this.start=void 0!==t?t:new a.default,this.end=void 0!==n?n:new a.default}return o(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"center",value:function(e){return(e||new a.default).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return(e||new a.default).subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){var n=t||new a.default;return this.delta(n).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(){var e=new a.default,t=new a.default;return function(n,r){e.subVectors(n,this.start),t.subVectors(this.end,this.start);var o=t.dot(t),a=t.dot(e)/o;return r&&(a=(0,i.clamp)(a,0,1)),a}}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t),o=n||new a.default;return this.delta(o).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"intersectLine",value:function(e){var t=this.end.clone().sub(this.start),n=e.end.clone().sub(e.start),r=e.start.clone().sub(this.start),o=t.clone().cross(n),a=r.clone().cross(n);if(0!==r.dot(t)){var i=a.dot(o)/o.lengthSq();if(!(i>1||isNaN(i))){var s=this.start.clone().add(t.clone().multiplyScalar(i));return s.clone().sub(e.start).lengthSq()+s.clone().sub(e.end).lengthSq()<=e.distanceSq()?s:void 0}}}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),o=function(e,t,n,r,o,a,i,s,l,u,c,d,f,h,m,p){this.elements=new Float32Array(16);var g=this.elements;g[0]=void 0!==e?e:1,g[4]=t||0,g[8]=n||0,g[12]=r||0,g[1]=o||0,g[5]=void 0!==a?a:1,g[9]=i||0,g[13]=s||0,g[2]=l||0,g[6]=u||0,g[10]=void 0!==c?c:1,g[14]=d||0,g[3]=f||0,g[7]=h||0,g[11]=m||0,g[15]=void 0!==p?p:1};o.prototype.makeRotationFromQuaternion=function(e){var t=this.elements,n=e.x,r=e.y,o=e.z,a=e.w,i=n+n,s=r+r,l=o+o,u=n*i,c=n*s,d=n*l,f=r*s,h=r*l,m=o*l,p=a*i,g=a*s,v=a*l;return t[0]=1-(f+m),t[4]=c-v,t[8]=d+g,t[1]=c+v,t[5]=1-(u+m),t[9]=h-p,t[2]=d-g,t[6]=h+p,t[10]=1-(u+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},o.prototype.multiplyMatrices=function(e,t){var n=e.elements,r=t.elements,o=this.elements,a=n[0],i=n[4],s=n[8],l=n[12],u=n[1],c=n[5],d=n[9],f=n[13],h=n[2],m=n[6],p=n[10],g=n[14],v=n[3],y=n[7],b=n[11],x=n[15],w=r[0],T=r[4],C=r[8],P=r[12],M=r[1],S=r[5],I=r[9],D=r[13],E=r[2],O=r[6],_=r[10],k=r[14],A=r[3],j=r[7],R=r[11],$=r[15];return o[0]=a*w+i*M+s*E+l*A,o[4]=a*T+i*S+s*O+l*j,o[8]=a*C+i*I+s*_+l*R,o[12]=a*P+i*D+s*k+l*$,o[1]=u*w+c*M+d*E+f*A,o[5]=u*T+c*S+d*O+f*j,o[9]=u*C+c*I+d*_+f*R,o[13]=u*P+c*D+d*k+f*$,o[2]=h*w+m*M+p*E+g*A,o[6]=h*T+m*S+p*O+g*j,o[10]=h*C+m*I+p*_+g*R,o[14]=h*P+m*D+p*k+g*$,o[3]=v*w+y*M+b*E+x*A,o[7]=v*T+y*S+b*O+x*j,o[11]=v*C+y*I+b*_+x*R,o[15]=v*P+y*D+b*k+x*$,this},o.prototype.multiply=function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},o.prototype.getInverse=function(e,t){var n=this.elements,r=e.elements,o=r[0],a=r[4],i=r[8],s=r[12],l=r[1],u=r[5],c=r[9],d=r[13],f=r[2],h=r[6],m=r[10],p=r[14],g=r[3],v=r[7],y=r[11],b=r[15];n[0]=c*p*v-d*m*v+d*h*y-u*p*y-c*h*b+u*m*b,n[4]=s*m*v-i*p*v-s*h*y+a*p*y+i*h*b-a*m*b,n[8]=i*d*v-s*c*v+s*u*y-a*d*y-i*u*b+a*c*b,n[12]=s*c*h-i*d*h-s*u*m+a*d*m+i*u*p-a*c*p,n[1]=d*m*g-c*p*g-d*f*y+l*p*y+c*f*b-l*m*b,n[5]=i*p*g-s*m*g+s*f*y-o*p*y-i*f*b+o*m*b,n[9]=s*c*g-i*d*g-s*l*y+o*d*y+i*l*b-o*c*b,n[13]=i*d*f-s*c*f+s*l*m-o*d*m-i*l*p+o*c*p,n[2]=u*p*g-d*h*g+d*f*v-l*p*v-u*f*b+l*h*b,n[6]=s*h*g-a*p*g-s*f*v+o*p*v+a*f*b-o*h*b,n[10]=a*d*g-s*u*g+s*l*v-o*d*v-a*l*b+o*u*b,n[14]=s*u*f-a*d*f-s*l*h+o*d*h+a*l*p-o*u*p,n[3]=c*h*g-u*m*g-c*f*v+l*m*v+u*f*y-l*h*y,n[7]=a*m*g-i*h*g+i*f*v-o*m*v-a*f*y+o*h*y,n[11]=i*u*g-a*c*g-i*l*v+o*c*v+a*l*y-o*u*y,n[15]=a*c*f-i*u*f+i*l*h-o*c*h-a*l*m+o*u*m;var x=o*n[0]+l*n[4]+f*n[8]+g*n[12];if(0===x){var w="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(w);return console.warn(w),this.identity(),this}return this.multiplyScalar(1/x),this},o.prototype.applyToVector3Array=function(){var e=new r.default;return function(t,n,r){void 0===n&&(n=0),void 0===r&&(r=t.length);for(var o=0,a=n;o<r;o+=3,a+=3)e.x=t[a],e.y=t[a+1],e.z=t[a+2],e.applyMatrix4(this),t[a]=e.x,t[a+1]=e.y,t[a+2]=e.z;return t}},o.prototype.makeTranslation=function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},o.prototype.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},o.prototype.set=function(e,t,n,r,o,a,i,s,l,u,c,d,f,h,m,p){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=o,g[5]=a,g[9]=i,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=d,g[3]=f,g[7]=h,g[11]=m,g[15]=p,this},o.prototype.makeScale=function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),o=function(e,t){this.normal=void 0!==e?e:new r.default(1,0,0),this.constant=void 0!==t?t:0};o.prototype={constructor:o,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new r.default,t=new r.default;return function(n,r,o){var a=e.subVectors(o,r).cross(t.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(a,n),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e);return(t||new r.default).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectLine:function(){var e=new r.default;return function(t,n){var o=n||new r.default,a=t.delta(e),i=this.normal.dot(a);if(0!==i){var s=-(t.start.dot(this.normal)+this.constant)/i;if(!(s<0||s>1))return o.copy(a).multiplyScalar(s).add(t.start)}else if(0===this.distanceToPoint(t.start))return o.copy(t.start)}}(),intersectPlane:function(e){var t=this.normal.clone().cross(e.normal),n={origin:new r.default,direction:t};if(this.normal.clone().cross(e.normal).length<1e-10)return n.direction=new r.default,n;var o=this.constant,a=e.constant,i=this.normal.clone().dot(e.normal),s=-(o-a*i)/(1-i*i),l=-(a-o*i)/(1-i*i);return n.origin=this.normal.clone().multiplyScalar(s).add(e.normal.clone().multiplyScalar(l)),n},coplanarPoint:function(e){return(e||new r.default).copy(this.normal).multiplyScalar(-this.constant)},translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant},clone:function(){return(new o).copy(this)}},t.default=o},function(e,t,n){"use strict";function r(e,t){return{x:e.x-t.x,y:e.y-t.y}}function o(e,t){return Math.sqrt(a(e,t))}function a(e,t){var n=r(e,t);return n.x*n.x+n.y*n.y}Object.defineProperty(t,"__esModule",{value:!0});var i={subtract:r,copy:function(e){return{x:e.x,y:e.y}},pageToPoint:function(e){return{x:e.pageX,y:e.pageY}},distance:o,distanceSquared:a,insideRect:function(e,t){return!(e.x<t.left||e.x>t.left+t.width||e.y<t.top||e.y>t.top+t.height)},findClosestPoint:function(e,t){var n=[],r=void 0;return e.forEach(function(e,a){var i=o(e,t);n.push(i),r=0===a?i:Math.min(i,r)}),e[n.indexOf(r)]}};t.default=i},function(e,t,n){"use strict";function r(e){return[{start:{x:e.left,y:e.top},end:{x:e.left+e.width,y:e.top}},{start:{x:e.left+e.width,y:e.top},end:{x:e.left+e.width,y:e.top+e.height}},{start:{x:e.left+e.width,y:e.top+e.height},end:{x:e.left,y:e.top+e.height}},{start:{x:e.left,y:e.top+e.height},end:{x:e.left,y:e.top}}]}function o(e){return{topLeft:{x:e.left,y:e.top},bottomRight:{x:e.left+e.width,y:e.top+e.height}}}function a(e,t){var n=void 0,r=void 0,a=o(e),i=o(t);return n=e.width>=0?t.width>=0?!(a.bottomRight.x<=i.topLeft.x||i.bottomRight.x<=a.topLeft.x):!(a.bottomRight.x<=i.bottomRight.x||i.topLeft.x<=a.topLeft.x):t.width>=0?!(a.topLeft.x<=i.topLeft.x||i.bottomRight.x<=a.bottomRight.x):!(a.topLeft.x<=i.bottomRight.x||i.topLeft.x<=a.bottomRight.x),r=e.height>=0?t.height>=0?!(a.bottomRight.y<=i.topLeft.y||i.bottomRight.y<=a.topLeft.y):!(a.bottomRight.y<=i.bottomRight.y||i.topLeft.y<=a.topLeft.y):t.height>=0?!(a.topLeft.y<=i.topLeft.y||i.bottomRight.y<=a.bottomRight.y):!(a.topLeft.y<=i.bottomRight.y||i.top<=a.bottomRight.y),n&&r}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),s={distanceToPoint:function(e,t){var n=655535;return r(e).forEach(function(e){var r=i.default.distanceToPoint(e,t);r<n&&(n=r)}),n},getIntersectionRect:function(e,t){var n={topLeft:{},bottomRight:{}};if(a(e,t)){var r=o(e),i=o(t);return e.width>=0?t.width>=0?(n.topLeft.x=Math.max(r.topLeft.x,i.topLeft.x),n.bottomRight.x=Math.min(r.bottomRight.x,i.bottomRight.x)):(n.topLeft.x=Math.max(r.topLeft.x,i.bottomRight.x),n.bottomRight.x=Math.min(r.bottomRight.x,i.topLeft.x)):t.width>=0?(n.topLeft.x=Math.min(r.topLeft.x,i.bottomRight.x),n.bottomRight.x=Math.max(r.bottomRight.x,i.topLeft.x)):(n.topLeft.x=Math.min(r.topLeft.x,i.topLeft.x),n.bottomRight.x=Math.max(r.bottomRight.x,i.bottomRight.x)),e.height>=0?t.height>=0?(n.topLeft.y=Math.max(r.topLeft.y,i.topLeft.y),n.bottomRight.y=Math.min(r.bottomRight.y,i.bottomRight.y)):(n.topLeft.y=Math.max(r.topLeft.y,i.bottomRight.y),n.bottomRight.y=Math.min(r.bottomRight.y,i.topLeft.y)):t.height>=0?(n.topLeft.y=Math.min(r.topLeft.y,i.bottomRight.y),n.bottomRight.y=Math.max(r.bottomRight.y,i.topLeft.y)):(n.topLeft.y=Math.min(r.topLeft.y,i.topLeft.y),n.bottomRight.y=Math.max(r.bottomRight.y,i.bottomRight.y)),n}}};t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4);Object.defineProperty(t,"Line3",{enumerable:!0,get:function(){return r(o).default}});var a=n(2);Object.defineProperty(t,"lineSegment",{enumerable:!0,get:function(){return r(a).default}});var i=n(0);Object.defineProperty(t,"clamp",{enumerable:!0,get:function(){return i.clamp}}),Object.defineProperty(t,"degToRad",{enumerable:!0,get:function(){return i.degToRad}}),Object.defineProperty(t,"radToDeg",{enumerable:!0,get:function(){return i.radToDeg}}),Object.defineProperty(t,"sign",{enumerable:!0,get:function(){return i.sign}});var s=n(5);Object.defineProperty(t,"Matrix4",{enumerable:!0,get:function(){return r(s).default}});var l=n(6);Object.defineProperty(t,"Plane",{enumerable:!0,get:function(){return r(l).default}});var u=n(7);Object.defineProperty(t,"point",{enumerable:!0,get:function(){return r(u).default}});var c=n(3);Object.defineProperty(t,"quaternion",{enumerable:!0,get:function(){return r(c).default}});var d=n(8);Object.defineProperty(t,"rect",{enumerable:!0,get:function(){return r(d).default}});var f=n(1);Object.defineProperty(t,"Vector3",{enumerable:!0,get:function(){return r(f).default}})}])}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cornerstone-core"),require("cornerstone-math"),require("hammerjs")):"function"==typeof define&&define.amd?define("cornerstoneTools",["cornerstone-core","cornerstone-math","hammerjs"],t):"object"==typeof exports?exports.cornerstoneTools=t(require("cornerstone-core"),require("cornerstone-math"),require("hammerjs")):e.cornerstoneTools=t(e.cornerstone,e.cornerstoneMath,e.Hammer)}(this,function(e,t,n){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=109)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){var t=o.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=a.globalImageIdSpecificToolStateManager),t.toolStateManager}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=n(16);t.addToolState=function(e,t,n){r(e).add(e,t,n);var o={toolType:t,element:e,measurementData:n};$(e).trigger("CornerstoneToolsMeasurementAdded",o)},t.getToolState=function(e,t){return r(e).get(e,t)},t.removeToolState=function(e,t,n){for(var o=r(e).get(e,t),a=-1,i=0;i<o.data.length;i++)o.data[i]===n&&(a=i);if(-1!==a){o.data.splice(a,1);var s={toolType:t,element:e,measurementData:n};$(e).trigger("CornerstoneToolsMeasurementRemoved",s)}},t.clearToolState=function(e,t){var n=r(e).get(e,t);void 0!==n&&(n.data=[])},t.setElementToolStateManager=function(e,t){o.getEnabledElement(e).toolStateManager=t},t.getElementToolStateManager=r},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(t&1<<e-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="white",o="greenyellow",a="transparent",i={setFillColor:function(e){a=e},getFillColor:function(){return a},setToolColor:function(e){r=e},getToolColor:function(){return r},setActiveColor:function(e){o=e},getActiveColor:function(){return o},getColorIfActive:function(e){return e?o:r}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=1,o=2,a={setToolWidth:function(e){r=e},getToolWidth:function(){return r},setActiveWidth:function(e){o=e},getActiveWidth:function(){return o}};t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,i){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var s=r.default.getFont(),l=r.default.getFontSize(),u=r.default.getBackgroundColor();e.save(),e.font=s,e.textBaseline="top",e.strokeStyle=a;var c=0;t.forEach(function(t){var n=e.measureText(t).width;c=Math.max(c,n)}),e.fillStyle=u;var d={width:c+10,height:5+t.length*(l+5)};return i&&i.centering&&!0===i.centering.x&&(n-=d.width/2),i&&i.centering&&!0===i.centering.y&&(o-=d.height/2),d.left=n,d.top=o,i&&!0===i.debug&&(e.fillStyle="#FF0000"),e.fillRect(d.left,d.top,d.width,d.height),t.forEach(function(t,r){e.fillStyle=a,e.fillText(t,n+5,o+5+r*(l+5))}),e.restore(),d};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(14))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){var a=t.element,i=e.createNewMeasurement(t);if(i){var s={mouseButtonMask:t.which};(0,h.addToolState)(t.element,e.toolType,i),$(a).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||r),$(a).off("CornerstoneToolsMouseDown",e.mouseDownCallback||m),$(a).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&$(a).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),o.updateImage(a);var c=void 0;c=1===Object.keys(i.handles).length?l.default:u.default;var f=void 0;f=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,c(t,e.toolType,i,i.handles.end,function(){i.active=!1,i.invalidated=!0,(0,d.default)(t,i.handles)&&(0,h.removeToolState)(a,e.toolType,i),$(a).on("CornerstoneToolsMouseMove",s,e.mouseMoveCallback||r),$(a).on("CornerstoneToolsMouseDown",s,e.mouseDownCallback||m),$(a).on("CornerstoneToolsMouseDownActivate",s,e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&$(a).on("CornerstoneToolsMouseDoubleClick",s,e.mouseDoubleClickCallback),o.updateImage(a)},f)}}function n(n,r){if((0,f.default)(r.which,n.data.mouseButtonMask))return e.addNewMeasurement?e.addNewMeasurement(r):t(r),!1}function r(t,n){if(a.default.setCoords(n),0===n.which){var r=(0,h.getToolState)(n.element,e.toolType);if(r){for(var i=!1,l=0;l<r.data.length;l++){var u=n.currentPoints.canvas,c=r.data[l];!0===(0,s.default)(n.element,c.handles,u)&&(i=!0),(e.pointNearTool(n.element,c,u)&&!c.active||!e.pointNearTool(n.element,c,u)&&c.active)&&(c.active=!c.active,i=!0)}!0===i&&o.updateImage(n.element)}}}function m(t,n){function a(){s.invalidated=!0,(0,d.default)(n,s.handles)&&(0,h.removeToolState)(u,e.toolType,s),o.updateImage(u),$(u).on("CornerstoneToolsMouseMove",n,e.mouseMoveCallback||r)}var s=void 0,u=n.element;if((0,f.default)(n.which,t.data.mouseButtonMask)){var m=n.startPoints.canvas,p=(0,h.getToolState)(t.currentTarget,e.toolType);if(p){var g=void 0,v=void 0;for(v=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,g=0;g<p.data.length;g++){s=p.data[g];var y=(0,i.default)(u,s.handles,m,6);if(y)return $(u).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||r),s.active=!0,(0,l.default)(n,e.toolType,s,y,a,v),t.stopImmediatePropagation(),!1}if(e.pointNearTool){var b=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(g=0;g<p.data.length;g++)if(s=p.data[g],s.active=!1,e.pointNearTool(u,s,m))return s.active=!0,$(u).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||r),(0,c.default)(t,s,p,e.toolType,b,a),t.stopImmediatePropagation(),!1}}}}var p={},g={enable:function(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||r),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||m),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),$(t).on("CornerstoneImageRendered",e.onImageRendered),o.updateImage(t)},disable:function(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||r),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||m),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),o.updateImage(t)},activate:function(t,a){var i={mouseButtonMask:a};$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||r),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||m),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",i,e.mouseMoveCallback||r),$(t).on("CornerstoneToolsMouseDown",i,e.mouseDownCallback||m),$(t).on("CornerstoneToolsMouseDownActivate",i,e.mouseDownActivateCallback||n),e.mouseDoubleClickCallback&&($(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),$(t).on("CornerstoneToolsMouseDoubleClick",i,e.mouseDoubleClickCallback)),o.updateImage(t)},deactivate:function(t,a){var i={mouseButtonMask:a},s="CornerstoneToolsToolDeactivated",l={mouseButtonMask:a,toolType:e.toolType,type:s},u=$.Event(s,l);$(t).trigger(u,l),$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||r),$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||m),$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||n),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",i,e.mouseMoveCallback||r),$(t).on("CornerstoneToolsMouseDown",i,e.mouseDownCallback||m),e.mouseDoubleClickCallback&&($(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),$(t).on("CornerstoneToolsMouseDoubleClick",i,e.mouseDoubleClickCallback)),o.updateImage(t)},getConfiguration:function(){return p},setConfiguration:function(e){p=e},mouseDownCallback:m,mouseMoveCallback:r,mouseDownActivateCallback:n};return e.pointNearTool&&(g.pointNearTool=e.pointNearTool),e.mouseDoubleClickCallback&&(g.mouseDoubleClickCallback=e.mouseDoubleClickCallback),e.addNewMeasurement&&(g.addNewMeasurement=e.addNewMeasurement),g};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=r(n(29)),i=r(n(15)),s=r(n(26)),l=r(n(21)),u=r(n(22)),c=r(n(27)),d=r(n(12)),f=r(n(3)),h=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,s){e.strokeStyle=i,Object.keys(n).forEach(function(i){var l=n[i];if(!0!==l.drawnIndependently&&(!s||!0!==s.drawHandlesIfActive||l.active)){e.beginPath(),l.active?e.lineWidth=o.default.getActiveWidth():e.lineWidth=o.default.getToolWidth();var u=r.pixelToCanvas(t.element,l);e.arc(u.x,u.y,a,0,2*Math.PI),s&&s.fill&&(e.fillStyle=s.fill,e.fill()),e.stroke()}})};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=function(e){return e&&e.__esModule?e:{default:e}}(n(5)),a=6},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function a(e){if(e)for(var t=0;t<e.data.length;t++){var n=e.data[t];n.active=!1,n.handles&&o(n.handles)}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=r(n(12)),l=r(n(15)),u=r(n(44)),c=r(n(23)),d=r(n(43)),f=n(1);t.default=function(e){function t(t){var a=t.element,l=e.createNewMeasurement(t);if(l){if((0,f.addToolState)(a,e.toolType,l),1===Object.keys(l.handles).length&&"CornerstoneToolsTap"===t.type)return l.active=!1,l.handles.end.active=!1,l.handles.end.highlight=!1,l.invalidated=!0,(0,s.default)(t,l.handles)&&(0,f.removeToolState)(a,e.toolType,l),void i.updateImage(a);$(a).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),$(a).off("CornerstoneToolsTap",e.tapCallback||r),$(a).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),i.updateImage(a),(0,c.default)(t,e.toolType,l,l.handles.end,function(){l.active=!1,l.invalidated=!0,(0,s.default)(t,l.handles)&&(0,f.removeToolState)(a,e.toolType,l),$(a).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),$(a).on("CornerstoneToolsTap",e.tapCallback||r),$(a).on("CornerstoneToolsTouchStart",e.touchStartCallback||o),i.updateImage(a)})}}function n(n,r){return e.addNewMeasurement?e.addNewMeasurement(r):t(r),!1}function r(t,c){function h(){a(g),(0,s.default)(c,v.handles)&&(0,f.removeToolState)(m,e.toolType,v),i.updateImage(m),$(m).on("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(m).on("CornerstoneToolsTap",e.tapCallback||r)}var m=c.element,p=c.currentPoints.canvas,g=(0,f.getToolState)(t.currentTarget,e.toolType),v=void 0,y=void 0;if(a(g),g)for(y=0;y<g.data.length;y++){v=g.data[y];var b=(0,l.default)(m,v.handles,p,25);if(b)return $(m).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(m).off("CornerstoneToolsTap",e.tapCallback||r),v.active=!0,b.active=!0,i.updateImage(m),(0,u.default)(t,e.toolType,v,b,h),t.stopImmediatePropagation(),!1}if(g&&e.pointNearTool)for(y=0;y<g.data.length;y++)if(v=g.data[y],e.pointNearTool(m,v,p))return $(m).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(m).off("CornerstoneToolsTap",e.tapCallback||r),v.active=!0,i.updateImage(m),(0,d.default)(t,v,g,e.toolType,!0,h),t.stopImmediatePropagation(),!1;return e.touchDownActivateCallback?e.touchDownActivateCallback(t,c):n(t,c),!1}function o(t,n){function a(t,a){if(m.active=!1,m.invalidated=!0,(0,s.default)(n,m.handles)&&(0,f.removeToolState)(n.element,e.toolType,m),i.updateImage(n.element),$(c).on("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(c).on("CornerstoneToolsTap",e.tapCallback||r),e.pressCallback&&$(c).on("CornerstoneToolsTouchPress",e.pressCallback),t&&"CornerstoneToolsTouchPress"===t.type){var l=$.Event(t.type,a);$(c).trigger(l,a)}}var c=n.element,h=n.startPoints.canvas,m=void 0,p=(0,f.getToolState)(t.currentTarget,e.toolType),g=void 0;if(p){for(g=0;g<p.data.length;g++){m=p.data[g];var v=(0,l.default)(n.element,m.handles,h,28);if(v)return $(c).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(c).off("CornerstoneToolsTap",e.tapCallback||r),e.pressCallback&&$(c).off("CornerstoneToolsTouchPress",e.pressCallback),m.active=!0,(0,u.default)(t,e.toolType,m,v,a),t.stopImmediatePropagation(),!1}if(e.pointNearTool)for(g=0;g<p.data.length;g++)if(m=p.data[g],e.pointNearTool(n.element,m,h))return $(c).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(c).off("CornerstoneToolsTap",e.tapCallback||r),e.pressCallback&&$(c).off("CornerstoneToolsTouchPress",e.pressCallback),(0,d.default)(t,m,p,e.toolType,!0,a),t.stopImmediatePropagation(),!1}}var h={enable:function(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),$(t).off("CornerstoneToolsTap",e.tapCallback||r),$(t).on("CornerstoneImageRendered",e.onImageRendered),e.doubleTapCallback&&$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&$(t).off("CornerstoneToolsTouchPress",e.pressCallback),i.updateImage(t)},disable:function(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),$(t).off("CornerstoneToolsTap",e.tapCallback||r),e.doubleTapCallback&&$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&$(t).off("CornerstoneToolsTouchPress",e.pressCallback),i.updateImage(t)},activate:function(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),$(t).off("CornerstoneToolsTap",e.tapCallback||r),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(t).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),$(t).on("CornerstoneToolsTap",e.tapCallback||r),e.doubleTapCallback&&($(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),$(t).on("CornerstoneToolsDoubleTap",e.doubleTapCallback)),e.pressCallback&&($(t).off("CornerstoneToolsTouchPress",e.pressCallback),$(t).on("CornerstoneToolsTouchPress",e.pressCallback)),i.updateImage(t)},deactivate:function(t){var a="CornerstoneToolsToolDeactivated",s={toolType:e.toolType,type:a},l=$.Event(a,s);$(t).trigger(l,s),$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||o),$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||n),$(t).off("CornerstoneToolsTap",e.tapCallback||r),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||o),e.doubleTapCallback&&$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&$(t).off("CornerstoneToolsTouchPress",e.pressCallback),i.updateImage(t)},touchStartCallback:e.touchStartCallback||o,touchDownActivateCallback:e.touchDownActivateCallback||n,tapCallback:e.tapCallback||r};return e.pointNearTool&&(h.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(h.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(h.pressCallback=e.pressCallback),e.addNewMeasurement&&(h.addNewMeasurement=e.addNewMeasurement),h}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=void 0,o=void 0,a=void 0,i={setStartLoadHandler:function(e){r=e},getStartLoadHandler:function(){return r},setEndLoadHandler:function(e){o=e},getEndLoadHandler:function(){return o},setErrorLoadingHandler:function(e){a=e},getErrorLoadingHandler:function(){return a}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n="CornerstoneToolsTouchDrag";return t&&!0===t.fireOnTouchStart&&(n+=" CornerstoneToolsTouchStart"),{activate:function(r){$(r).off(n,e),t&&t.eventData?$(r).on(n,t.eventData,e):$(r).on(n,e),t&&t.activateCallback&&t.activateCallback(r)},disable:function(r){$(r).off(n,e),t&&t.disableCallback&&t.disableCallback(r)},enable:function(r){$(r).off(n,e),t&&t.enableCallback&&t.enableCallback(r)},deactivate:function(r){$(r).off(n,e),t&&t.deactivateCallback&&t.deactivateCallback(r)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.image,o={left:0,top:0,width:n.width,height:n.height},a=!1;return Object.keys(t).forEach(function(e){var n=t[e];!0!==n.allowedOutsideImage&&!1===r.point.insideRect(n,o)&&(a=!0)}),a};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t,n,r){$(t).off("CornerstoneToolsMouseDownActivate",e);var o={mouseButtonMask:n,options:r};$(t).on("CornerstoneToolsMouseDownActivate",o,e)},disable:function(t){$(t).off("CornerstoneToolsMouseDownActivate",e)},enable:function(t){$(t).off("CornerstoneToolsMouseDownActivate",e)},deactivate:function(t){$(t).off("CornerstoneToolsMouseDownActivate",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=15,o=r+"px Arial",a="transparent",i={setFont:function(e){o=e},getFont:function(){return o},setFontSize:function(e){r=e},getFontSize:function(){return r},setBackgroundColor:function(e){a=e},getBackgroundColor:function(){return a}};t.default=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){var s=void 0;if(t)return Object.keys(t).forEach(function(l){var u=t[l];if(u.hasOwnProperty("pointNearHandle")){if(u.pointNearHandle(e,u,n))return void(s=u)}else if(!0===u.hasBoundingBox){if((0,i.default)(u,n))return void(s=u)}else{var c=o.pixelToCanvas(e,u);if(a.point.distance(c,n)<=r)return void(s=u)}}),s};var o=r(n(0)),a=r(n(2)),i=function(e){return e&&e.__esModule?e:{default:e}}(n(18))},function(e,t,n){"use strict";function r(){var e={};return{get:function(t,n){var r=o.getEnabledElement(t);if(r.image&&!1!==e.hasOwnProperty(r.image.imageId)){var a=e[r.image.imageId];if(!1!==a.hasOwnProperty(n))return a[n]}},add:function(t,n,r){var a=o.getEnabledElement(t);a.image&&!1!==e.hasOwnProperty(a.image.imageId)||(e[a.image.imageId]={});var i=e[a.image.imageId];!1===i.hasOwnProperty(n)&&(i[n]={data:[]}),i[n].data.push(r)},clear:function(t){var n=o.getEnabledElement(t);n.image&&!1!==e.hasOwnProperty(n.image.imageId)&&delete e[n.image.imageId]},saveImageIdToolState:function(t){return e[t]},restoreImageIdToolState:function(t,n){e[t]=n},saveToolState:function(){return e},restoreToolState:function(t){e=t},toolState:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=r();t.newImageIdSpecificToolStateManager=r,t.globalImageIdSpecificToolStateManager=a},function(e,t,n){"use strict";function r(e){return parseFloat("."+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=o.metaData.get("patientStudyModule",e.imageId),a=o.metaData.get("generalSeriesModule",e.imageId);if(n&&a&&"PT"===a.modality){var i=t*e.slope+e.intercept,s=n.patientWeight;if(s){var l=o.metaData.get("petIsotopeModule",e.imageId);if(l){var u=l.radiopharmaceuticalInfo,c=u.radiopharmaceuticalStartTime,d=u.radionuclideTotalDose,f=u.radionuclideHalfLife,h=a.seriesTime;if(c&&d&&f&&h){var m=r(h.fractionalSeconds||0)+h.seconds+60*h.minutes+60*h.hours*60-(r(c.fractionalSeconds)+c.seconds+60*c.minutes+60*c.hours*60);return i*s/(d*Math.exp(-m*Math.log(2)/f))*1e3}}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return r.point.insideRect(t,e.boundingBox)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{disable:function(t){$(t).off("CornerstoneImageRendered",e)},enable:function(t){$(t).off("CornerstoneImageRendered",e),$(t).on("CornerstoneImageRendered",e),r.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){$(t).off("CornerstoneToolsMouseWheel",e);var n={};$(t).on("CornerstoneToolsMouseWheel",n,e)},disable:function(t){$(t).off("CornerstoneToolsMouseWheel",e)},enable:function(t){$(t).off("CornerstoneToolsMouseWheel",e)},deactivate:function(t){$(t).off("CornerstoneToolsMouseWheel",e)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,i){function s(e,a){!1===o.hasMoved&&(o.hasMoved=!0),o.active=!0,o.x=a.currentPoints.image.x+c.x,o.y=a.currentPoints.image.y+c.y,i&&(o.x=Math.max(o.x,0),o.x=Math.min(o.x,a.image.width),o.y=Math.max(o.y,0),o.y=Math.min(o.y,a.image.height)),r.updateImage(u);var s={toolType:t,element:u,measurementData:n};$(u).trigger("CornerstoneToolsMeasurementModified",s)}function l(){o.active=!1,$(u).off("CornerstoneToolsMouseDrag",s),$(u).off("CornerstoneToolsMouseUp",l),$(u).off("CornerstoneToolsMouseClick",l),r.updateImage(u),"function"==typeof a&&a()}var u=e.element,c={x:o.x-e.currentPoints.image.x,y:o.y-e.currentPoints.image.y};$(u).on("CornerstoneToolsMouseDrag",s),$(u).on("CornerstoneToolsMouseUp",l),$(u).on("CornerstoneToolsMouseClick",l)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,i){function s(e,a){o.active=!0,o.x=a.currentPoints.image.x,o.y=a.currentPoints.image.y,i&&(o.x=Math.max(o.x,0),o.x=Math.min(o.x,a.image.width),o.y=Math.max(o.y,0),o.y=Math.min(o.y,a.image.height)),r.updateImage(f);var s={toolType:t,element:f,measurementData:n};$(f).trigger("CornerstoneToolsMeasurementModified",s)}function l(e){$(f).off("CornerstoneToolsMouseMove",l),$(f).off("CornerstoneToolsMouseDrag",l),$(f).on("CornerstoneToolsMouseMove",s),$(f).on("CornerstoneToolsMouseDrag",s),$(f).on("CornerstoneToolsMouseClick",d),"CornerstoneToolsMouseDrag"===e.type&&$(f).on("CornerstoneToolsMouseUp",d)}function u(e,t){t.measurementData===n&&d()}function c(e,n){n.toolType===t&&($(f).off("CornerstoneToolsMouseMove",s),$(f).off("CornerstoneToolsMouseDrag",s),$(f).off("CornerstoneToolsMouseClick",d),$(f).off("CornerstoneToolsMouseUp",d),$(f).off("CornerstoneToolsMeasurementRemoved",u),$(f).off("CornerstoneToolsToolDeactivated",c),o.active=!1,r.updateImage(f))}function d(){$(f).off("CornerstoneToolsMouseMove",s),$(f).off("CornerstoneToolsMouseDrag",s),$(f).off("CornerstoneToolsMouseClick",d),$(f).off("CornerstoneToolsMouseUp",d),$(f).off("CornerstoneToolsMeasurementRemoved",u),$(f).off("CornerstoneToolsToolDeactivated",c),o.active=!1,r.updateImage(f),"function"==typeof a&&a()}var f=e.element;$(f).on("CornerstoneToolsMouseDrag",l),$(f).on("CornerstoneToolsMouseMove",l),$(f).on("CornerstoneToolsMeasurementRemoved",u),$(f).on("CornerstoneToolsToolDeactivated",c)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a,i){function s(e,a){o.x=a.currentPoints.image.x+h.x,o.y=a.currentPoints.image.y+h.y,i&&(o.x=Math.max(o.x,0),o.x=Math.min(o.x,a.image.width),o.y=Math.max(o.y,0),o.y=Math.min(o.y,a.image.height)),r.updateImage(d);var s={toolType:t,element:d,measurementData:n};$(d).trigger("CornerstoneToolsMeasurementModified",s)}function l(e,t){if($(d).off("CornerstoneToolsTouchDrag",s),$(d).off("CornerstoneToolsTouchPinch",l),$(d).off("CornerstoneToolsTouchEnd",l),$(d).off("CornerstoneToolsTap",l),$(d).off("CornerstoneToolsTouchStart",u),$(d).off("CornerstoneToolsToolDeactivated",c),"CornerstoneToolsTouchPinch"===e.type||"CornerstoneToolsTouchPress"===e.type)return o.active=!1,r.updateImage(d),void a();o.active=!1,n.active=!1,o.x=t.currentPoints.image.x+h.x,o.y=t.currentPoints.image.y+h.y,i&&(o.x=Math.max(o.x,0),o.x=Math.min(o.x,t.image.width),o.y=Math.max(o.y,0),o.y=Math.min(o.y,t.image.height)),r.updateImage(d),"function"==typeof a&&a()}function u(e){return e.stopImmediatePropagation(),!1}function c(){$(d).off("CornerstoneToolsTouchDrag",s),$(d).off("CornerstoneToolsTouchPinch",l),$(d).off("CornerstoneToolsTouchEnd",l),$(d).off("CornerstoneToolsTap",l),$(d).off("CornerstoneToolsTouchStart",u),$(d).off("CornerstoneToolsToolDeactivated",c),o.active=!1,n.active=!1,o.x=e.currentPoints.image.x+h.x,o.y=e.currentPoints.image.y+h.y,i&&(o.x=Math.max(o.x,0),o.x=Math.min(o.x,e.image.width),o.y=Math.max(o.y,0),o.y=Math.min(o.y,e.image.height)),r.updateImage(d)}var d=e.element,f=r.pageToPixel(d,e.currentPoints.page.x,e.currentPoints.page.y+50),h={x:o.x-f.x,y:o.y-f.y};o.active=!0,n.active=!0,$(d).on("CornerstoneToolsTouchDrag",s),$(d).on("CornerstoneToolsTouchPinch",l),$(d).on("CornerstoneToolsTouchEnd",l),$(d).on("CornerstoneToolsTap",l),$(d).on("CornerstoneToolsTouchStart",u),$(d).on("CornerstoneToolsToolDeactivated",c)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";function r(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],n=void 0;return/trident/i.test(t[1])?"IE "+((n=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""):"Chrome"===t[1]&&null!==(n=e.match(/\b(OPR|Edge)\/(\d+)/))?n.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(n=e.match(/version\/(\d+)/i))&&t.splice(1,1,n[1]),t.join(" "))}function o(){var e=r().split(" "),t=e[0],n=e[1],o=i[t];return o?o[n]?o[n]:o.default:i.default}Object.defineProperty(t,"__esModule",{value:!0});var a=void 0,i={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};t.getDefaultSimultaneousRequests=o,t.getMaxSimultaneousRequests=function(){return a||o()},t.setMaxSimultaneousRequests=function(e){a=e},t.getBrowserInfo=r,t.isMobileDevice=function(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n={},r="CornerstoneToolsMultiTouchDrag";return t&&!0===t.fireOnTouchStart&&(r+=" CornerstoneToolsMultiTouchStart"),{activate:function(n){$(n).off(r,e),t&&t.eventData?$(n).on(r,t.eventData,e):$(n).on(r,e),t&&t.activateCallback&&t.activateCallback(n)},disable:function(n){$(n).off(r,e),t&&t.disableCallback&&t.disableCallback(n)},enable:function(n){$(n).off(r,e),t&&t.enableCallback&&t.enableCallback(n)},deactivate:function(n){$(n).off(r,e),t&&t.deactivateCallback&&t.deactivateCallback(n)},getConfiguration:function(){return n},setConfiguration:function(e){n=e}}}},function(e,t,n){"use strict";function r(e){var t=void 0;return Object.keys(e).forEach(function(n){var r=e[n];!0!==r.active||(t=r)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,a){a||(a=6);var i=r(t),s=(0,o.default)(e,t,n,a);return i!==s&&(void 0!==s&&(s.active=!0),void 0!==i&&(i.active=!1),!0)};var o=function(e){return e&&e.__esModule?e:{default:e}}(n(15))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,s,l){function u(e,n){t.active=!0,Object.keys(t.handles).forEach(function(e){var r=t.handles[e];!0!==r.movesIndependently&&(r.x+=n.deltaPoints.image.x,r.y+=n.deltaPoints.image.y,!0===s.preventHandleOutsideImage&&(r.x=Math.max(r.x,0),r.x=Math.min(r.x,n.image.width),r.y=Math.max(r.y,0),r.y=Math.min(r.y,n.image.height)))}),r.updateImage(d);var o={toolType:i,element:d,measurementData:t};return $(d).trigger("CornerstoneToolsMeasurementModified",o),!1}function c(e,n){t.invalidated=!0,$(d).off("CornerstoneToolsMouseDrag",u),$(d).off("CornerstoneToolsMouseUp",c),$(d).off("CornerstoneToolsMouseClick",c),!0===s.deleteIfHandleOutsideImage&&(0,o.default)(n,t.handles)&&(0,a.removeToolState)(d,i,t),r.updateImage(d),"function"==typeof l&&l()}var d=e.element;return $(d).on("CornerstoneToolsMouseDrag",u),$(d).on("CornerstoneToolsMouseUp",c),$(d).on("CornerstoneToolsMouseClick",c),!0};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=function(e){return e&&e.__esModule?e:{default:e}}(n(12)),a=n(1)},function(e,t,n){"use strict";function r(){f&&setTimeout(function(){a()},h)}function o(e){var t=e.type;c[t]++,f=!0;var n=e.imageId,o=e.doneCallback,a=e.failCallback,i=s.imageCache.getImagePromise(n);if(i)i.then(function(e){c[t]--,o(e),r()},function(e){c[t]--,a(e),r()});else{var l=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e);(!0===e.preventCache?s.loadImage(n,{priority:l,type:e.type}):s.loadAndCacheImage(n,{priority:l,type:e.type})).then(function(e){c[t]--,o(e),r()},function(e){c[t]--,a(e),r()})}}function a(){var e=(0,l.getMaxSimultaneousRequests)();d={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=e-(c.interaction+c.thumbnail+c.prefetch),n=0;n<t;n++){var r=i();r&&o(r)}}function i(){return u.interaction.length&&c.interaction<d.interaction?u.interaction.shift():u.thumbnail.length&&c.thumbnail<d.thumbnail?u.thumbnail.shift():u.prefetch.length&&c.prefetch<d.prefetch?u.prefetch.shift():(u.interaction.length||u.thumbnail.length||u.prefetch.length||(f=!1),!1)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),l=n(24),u={interaction:[],thumbnail:[],prefetch:[]},c={interaction:0,thumbnail:0,prefetch:0},d={interaction:6,thumbnail:6,prefetch:5},f=!1,h=20;t.default={addRequest:function(e,t,n,r,o,a){if(!u.hasOwnProperty(n))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var i={type:n,imageId:t,preventCache:r,doneCallback:o,failCallback:a},l=s.imageCache.getImagePromise(t);l?l.then(function(e){o(e)},function(e){a(e)}):u[n].push(i)}},clearRequestStack:function(e){if(!u.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");u[e]=[]},startGrabbing:a,getRequestPool:function(){return u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=void 0,o={setCoords:function(e){r=e.currentPoints.canvas},getCoords:function(){return r}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var i=(0,o.getToolState)(e,"timeSeries");if(i&&i.data&&i.data.length){var s=i.data[0],l=s.stacks[s.currentStackIndex].currentImageIdIndex,u=s.currentStackIndex+t;if(n?(u>=s.stacks.length&&(u=0),u<0&&(u=s.stacks.length-1)):(u=Math.min(s.stacks.length-1,u),u=Math.max(0,u)),u!==s.currentStackIndex){var c=r.getViewport(e),d=s.stacks[u],f=a.default.getStartLoadHandler(),h=a.default.getEndLoadHandler(),m=a.default.getErrorLoadingHandler();f&&f(e);(!0===d.preventCache?r.loadImage(d.imageIds[l]):r.loadAndCacheImage(d.imageIds[l])).then(function(t){s.currentImageIdIndex!==l&&(d.currentImageIdIndex=l,s.currentStackIndex=u,r.displayImage(e,t,c),h&&h(e,t))},function(t){var n=d.imageIds[l];m&&m(e,n,t)})}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:r.point.copy(e.page),image:r.point.copy(e.image),client:r.point.copy(e.client),canvas:r.point.copy(e.canvas)}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i=r.getEnabledElement(e),s=[],l=0,u=i.image.getPixelData(),c=void 0,d=void 0,f=void 0;if(i.image.color)for(d=0;d<a;d++)for(f=0;f<o;f++){var h=u[c=4*((d+n)*i.image.columns+(f+t))],m=u[c+1],p=u[c+2],g=u[c+3];s[l++]=h,s[l++]=m,s[l++]=p,s[l++]=g}return s};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.width/2,r=e.height/2;if(n<=0||r<=0)return!1;var o={x:e.left+n,y:e.top+r},a={x:t.x-o.x,y:t.y-o.y};return a.x*a.x/(n*n)+a.y*a.y/(r*r)<=1}},function(e,t,n){"use strict";function r(e,t){var n=t.rowCosines.clone().multiplyScalar(e.x);n.multiplyScalar(t.columnPixelSpacing);var r=t.columnCosines.clone().multiplyScalar(e.y);r.multiplyScalar(t.rowPixelSpacing);var o=n.add(r);return o.add(t.imagePositionPatient),o}function o(e){var t=r({x:0,y:0},e),n=r({x:e.columns,y:0},e),o=r({x:0,y:e.rows},e),a=r({x:e.columns,y:e.rows},e);return{top:new i.Line3(t,n),left:new i.Line3(t,o),right:new i.Line3(n,a),bottom:new i.Line3(o,a)}}function a(e,t){var n=[];return Object.keys(t).forEach(function(r){var o=t[r],a=e.intersectLine(o);a&&n.push(a)}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=function(e,t){var n=e.clone().sub(t.imagePositionPatient);return{x:t.rowCosines.dot(n)/t.columnPixelSpacing,y:t.columnCosines.dot(n)/t.rowPixelSpacing}},t.imagePointToPatientPoint=r,t.planePlaneIntersection=function(e,t){var n=e.rowCosines.clone().cross(e.columnCosines),s=new i.Plane;s.setFromNormalAndCoplanarPoint(n,e.imagePositionPatient);var l=t.rowCosines.clone().cross(t.columnCosines),u=new i.Plane;u.setFromNormalAndCoplanarPoint(l,t.imagePositionPatient);var c=u.clone().intersectPlane(s),d=c.origin,f=c.direction,h=r({x:t.columns,y:t.rows},t),m=t.imagePositionPatient.distanceTo(h),p=new i.Line3;p.start=d,p.end=d.clone().add(f.multiplyScalar(m));var g=a(p,o(t));if(2===g.length)return{start:g[0],end:g[1]}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,o.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var a=n.data[0],i=a.currentImageIdIndex+t;i=Math.min(a.imageIds.length-1,i),i=Math.max(0,i),(0,r.default)(e,i)}};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(52)),o=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){$(t).off("CornerstoneToolsDoubleTap",e);var n={};$(t).on("CornerstoneToolsDoubleTap",n,e)},disable:function(t){$(t).off("CornerstoneToolsDoubleTap",e)},enable:function(t){$(t).off("CornerstoneToolsDoubleTap",e)},deactivate:function(t){$(t).off("CornerstoneToolsDoubleTap",e)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){$(t).off("CornerstoneToolsKeyDown",e),$(t).on("CornerstoneToolsKeyDown",e)},disable:function(t){$(t).off("CornerstoneToolsKeyDown",e)},enable:function(t){$(t).off("CornerstoneToolsKeyDown",e)},deactivate:function(t){$(t).off("CornerstoneToolsKeyDown",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(n){var r=e.createNewMeasurement(n);r&&((0,f.addToolState)(n.element,e.toolType,r),$(n.element).off("CornerstoneToolsMouseMove",h),(0,l.default)(n,e.toolType,r,r.handles.end,function(){r.active=!1,(0,c.default)(n,r.handles)&&(0,f.removeToolState)(n.element,e.toolType,r),$(n.element).on("CornerstoneToolsMouseMove",h)},t))}function r(e,t){if((0,d.default)(t.which,e.data.mouseButtonMask))return n(t),!1}function h(t,n){if(a.default.setCoords(n),0===n.which){var r=(0,f.getToolState)(n.element,e.toolType);if(void 0!==r){for(var i=!1,l=n.currentPoints.canvas,u=0;u<r.data.length;u++){var c=r.data[u];!0===(0,s.default)(n.element,c.handles,l)&&(i=!0),(e.pointInsideRect(n.element,c,l)&&!c.active||!e.pointInsideRect(n.element,c,l)&&c.active)&&(c.active=!c.active,i=!0)}!0===i&&o.updateImage(n.element)}}}function m(n,r){function a(){s.active=!1,(0,c.default)(r,s.handles)&&(0,f.removeToolState)(r.element,e.toolType,s),o.updateImage(r.element),$(r.element).on("CornerstoneToolsMouseMove",h)}var s=void 0;if((0,d.default)(r.which,n.data.mouseButtonMask)){var m=r.startPoints.canvas,p=(0,f.getToolState)(n.currentTarget,e.toolType),g=void 0;if(void 0!==p)for(g=0;g<p.data.length;g++){s=p.data[g];var v=(0,i.default)(r.element,s.handles,m,25);if(void 0!==v)return $(r.element).off("CornerstoneToolsMouseMove",h),s.active=!0,(0,l.default)(r,e.toolType,s,v,a,t),n.stopImmediatePropagation(),!1}var y={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==p&&void 0!==e.pointInsideRect)for(g=0;g<p.data.length;g++)if(s=p.data[g],e.pointInsideRect(r.element,s,m))return $(r.element).off("CornerstoneToolsMouseMove",h),(0,u.default)(n,s,p,e.toolType,y,a),$(r.element).on("CornerstoneToolsMouseMove",h),n.stopImmediatePropagation(),!1}}return{enable:function(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",h),$(t).off("CornerstoneToolsMouseDown",m),$(t).off("CornerstoneToolsMouseDownActivate",r),$(t).on("CornerstoneImageRendered",e.onImageRendered),o.updateImage(t)},disable:function(t){$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",h),$(t).off("CornerstoneToolsMouseDown",m),$(t).off("CornerstoneToolsMouseDownActivate",r),o.updateImage(t)},activate:function(t,n){var a={mouseButtonMask:n};$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",h),$(t).off("CornerstoneToolsMouseDown",m),$(t).off("CornerstoneToolsMouseDownActivate",r),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",a,h),$(t).on("CornerstoneToolsMouseDown",a,m),$(t).on("CornerstoneToolsMouseDownActivate",a,r),o.updateImage(t)},deactivate:function(t,n){var a={mouseButtonMask:n};$(t).off("CornerstoneImageRendered",e.onImageRendered),$(t).off("CornerstoneToolsMouseMove",h),$(t).off("CornerstoneToolsMouseDown",m),$(t).off("CornerstoneToolsMouseDownActivate",r),$(t).on("CornerstoneImageRendered",e.onImageRendered),$(t).on("CornerstoneToolsMouseMove",a,h),$(t).on("CornerstoneToolsMouseDown",a,m),o.updateImage(t)}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=r(n(29)),i=r(n(15)),s=r(n(26)),l=r(n(21)),u=r(n(27)),c=r(n(12)),d=r(n(3)),f=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){$(t).off("CornerstoneToolsTouchPinch",e);var n={};$(t).on("CornerstoneToolsTouchPinch",n,e)},disable:function(t){$(t).off("CornerstoneToolsTouchPinch",e)},enable:function(t){$(t).off("CornerstoneToolsTouchPinch",e)},deactivate:function(t){$(t).off("CornerstoneToolsTouchPinch",e)}}}},function(e,t,n){"use strict";function r(e,t){var n=Date.now();if(e!==u){if(n-c<=s)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;u=e}c=n}function o(e,t,n){var r=n?d:f;t.forEach(function(t){$(e).on(t,r)})}function a(e,t,n){var r=n?d:f;t.forEach(function(t){$(e).off(t,r)})}function i(e){a(e,h,l.mouse),a(e,m,l.touch)}Object.defineProperty(t,"__esModule",{value:!0});var s=2e3,l={mouse:0,touch:1},u=void 0,c=void 0,d=r.bind(null,l.mouse),f=r.bind(null,l.touch),h=["mousedown","mouseup"],m=["touchstart","touchend"],p={enable:function(e){i(e),o(e,h,l.mouse),o(e,m,l.touch)},disable:i};t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,s,l){function u(e,n){t.active=!0,Object.keys(t.handles).forEach(function(e){var r=t.handles[e];!0!==r.movesIndependently&&(r.x+=n.deltaPoints.image.x,r.y+=n.deltaPoints.image.y)}),r.updateImage(d);var o={toolType:i,element:d,measurementData:t};return $(d).trigger("CornerstoneToolsMeasurementModified",o),!1}function c(e,n){t.active=!1,t.invalidated=!1,$(d).off("CornerstoneToolsTouchDrag",u),$(d).off("CornerstoneToolsTouchPinch",c),$(d).off("CornerstoneToolsTouchPress",c),$(d).off("CornerstoneToolsTouchEnd",c),$(d).off("CornerstoneToolsDragEnd",c),$(d).off("CornerstoneToolsTap",c),!0===s&&(0,o.default)(n,t.handles)&&(0,a.removeToolState)(d,i,t),r.updateImage(d),"function"==typeof l&&l(e,n)}var d=e.element;return $(d).on("CornerstoneToolsTouchDrag",u),$(d).on("CornerstoneToolsTouchPinch",c),$(d).on("CornerstoneToolsTouchPress",c),$(d).on("CornerstoneToolsTouchEnd",c),$(d).on("CornerstoneToolsDragEnd",c),$(d).on("CornerstoneToolsTap",c),!0};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=function(e){return e&&e.__esModule?e:{default:e}}(n(12)),a=n(1)},function(e,t,n){"use strict";function r(e,t,n,a,i){if(n.value){var s=(new Date).getTime(),l=Math.abs(t.y-i.y),u=l/10;if(console.log("distanceRemaining: "+l),l<1)return t.y=i.y,void(n.value=!1);t.y>i.y?t.y-=u:t.y<i.y&&(t.y+=u),o.updateImage(a.element),o.requestAnimationFrame(function(){r(s,t,n,a,i)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s,l){function u(e,r){a.value=!1,!1===s.hasMoved&&(s.hasMoved=!0),s.active=!0;var i=r.currentPoints,l={x:i.page.x,y:i.page.y+m};g=o.pageToPixel(d,l.x,l.y),s.x=g.x,s.y=g.y,o.updateImage(d);var u={toolType:t,element:d,measurementData:n};$(d).trigger("CornerstoneToolsMeasurementModified",u)}function c(t,r){a.value=!1,s.active=!1,$(d).off("CornerstoneToolsTouchDrag",u),$(d).off(i,c),o.updateImage(d),"CornerstoneToolsTouchPress"===t.type&&(r.handlePressed=n,s.x=e.currentPoints.image.x,s.y=e.currentPoints.image.y),"function"==typeof l&&l(t,r)}a.value=!0;var d=e.element,f=o.getEnabledElement(d),h=(new Date).getTime(),m=-57,p={x:e.currentPoints.page.x,y:e.currentPoints.page.y+m},g=o.pageToPixel(d,p.x,p.y);$(d).on("CornerstoneToolsTouchDrag",u),$(d).on(i,c),r(h,s,a,f,g)};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a={value:!1},i=["CornerstoneToolsTouchEnd","CornerstoneToolsDragEnd","CornerstoneToolsTouchPinch","CornerstoneToolsTouchPress","CornerstoneToolsTap"].join(" ")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(112)),a=r(n(113)),i={getOrientationString:o.default,invertOrientationString:a.default};t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){$(t.element).off("CornerstoneToolsMouseDrag",a),$(t.element).off("CornerstoneToolsMouseUp",o),$(t.element).off("CornerstoneToolsMouseClick",o)}function a(e,t){var n=t.element,r=(0,f.getToolState)(n,"stack");if(r&&r.data&&r.data.length){var o=r.data[0],a=h.getConfiguration(),i=$(n).height()/Math.max(o.imageIds.length,8);if(a&&a.stackScrollSpeed&&(i=a.stackScrollSpeed),e.data.deltaY=e.data.deltaY||0,e.data.deltaY+=t.deltaPoints.page.y,Math.abs(e.data.deltaY)>=i){var s=e.data.deltaY/i,l=Math.round(s),u=e.data.deltaY%i;e.data.deltaY=u,(0,d.default)(n,l)}return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var i=r(n(11)),s=r(n(25)),l=r(n(13)),u=r(n(20)),c=r(n(3)),d=r(n(37)),f=n(1),h=(0,l.default)(function(e,t){if((0,c.default)(t.which,e.data.mouseButtonMask)){var n={deltaY:0};return $(t.element).on("CornerstoneToolsMouseDrag",n,a),$(t.element).on("CornerstoneToolsMouseUp",o),$(t.element).on("CornerstoneToolsMouseClick",o),e.stopImmediatePropagation(),!1}}),m=(0,u.default)(function(e,t){var n=-t.direction;(0,d.default)(t.element,n)}),p={eventData:{deltaY:0}},g=(0,i.default)(a,p),v={testPointers:function(e){return e.numPointers>=3}},y=(0,s.default)(function(e,t){var n=y.getConfiguration();n&&n.testPointers(t)&&a(e,t)},p);y.setConfiguration(v),t.stackScroll=h,t.stackScrollWheel=m,t.stackScrollTouchDrag=g,t.stackScrollMultiTouch=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=0,o=0,a=0,i=0,s=t.top;s<t.top+t.height;s++)for(var l=t.left;l<t.left+t.width;l++){var u={x:l,y:s};(0,r.default)(t,u)&&(n+=e[i],o+=e[i]*e[i],a++),i++}if(0===a)return{count:a,mean:0,variance:0,stdDev:0};var c=n/a,d=o/a-c*c;return{count:a,mean:c,variance:d,stdDev:Math.sqrt(d)}};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(34))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){var a=Math.atan2(n.y-t.y,n.x-t.x);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.strokeStyle=r,e.lineWidth=o,e.stroke(),e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(n.x-10*Math.cos(a-Math.PI/7),n.y-10*Math.sin(a-Math.PI/7)),e.lineTo(n.x-10*Math.cos(a+Math.PI/7),n.y-10*Math.sin(a+Math.PI/7)),e.lineTo(n.x,n.y),e.lineTo(n.x-10*Math.cos(a-Math.PI/7),n.y-10*Math.sin(a-Math.PI/7)),e.strokeStyle=r,e.lineWidth=o,e.stroke(),e.fillStyle=r,e.fill()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){e.beginPath(),e.strokeStyle=n,e.lineWidth=r,e.arc(t.x,t.y,6,0,2*Math.PI),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){var a=r/2*.5522848,i=o/2*.5522848,s=t+r,l=n+o,u=t+r/2,c=n+o/2;e.beginPath(),e.moveTo(t,c),e.bezierCurveTo(t,c-i,u-a,n,u,n),e.bezierCurveTo(u+a,n,s,c-i,s,c),e.bezierCurveTo(s,c+i,u+a,l,u,l),e.bezierCurveTo(u-a,l,t,c+i,t,c),e.closePath(),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,a){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i=r.getEnabledElement(e).image,s=[],l=0,u=i.getPixelData(),c=void 0,d=void 0,f=void 0;if(i.color)for(d=0;d<a;d++)for(f=0;f<o;f++){var h=u[c=4*((d+n)*i.columns+(f+t))],m=u[c+1],p=u[c+2];s[l++]=.2126*h+.7152*m+.0722*p}else for(d=0;d<a;d++)for(f=0;f<o;f++)c=(d+n)*i.columns+(f+t),s[l++]=u[c]*i.slope+i.intercept;return s};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,a.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var r=void 0;if(n.data.length>1){var u=(0,a.getToolState)(e,"stackRenderer");u&&u.data&&u.data.length&&(r=u.data[0])}var c=n.data[0];t<0&&(t+=c.imageIds.length);var d=s.default.getStartLoadHandler(),f=s.default.getEndLoadHandler(),h=s.default.getErrorLoadingHandler(),m=o.getViewport(e);if(t!==c.currentImageIdIndex){d&&d(e);var p={newImageIdIndex:t,direction:t-c.currentImageIdIndex};c.currentImageIdIndex=t;var g=c.imageIds[t],v=l.stackScroll.getConfiguration();if(v&&!0===v.retryLoadOnScroll){var y=o.imageCache.getImagePromise(g);y&&"rejected"===y.state()&&o.imageCache.removeImagePromise(g)}(Boolean(c.preventCache)?o.loadImage(g):o.loadAndCacheImage(g)).then(function(a){if(c.currentImageIdIndex===t){try{o.getEnabledElement(e)}catch(e){return}r?(r.currentImageIdIndex=t,r.render(e,n.data)):o.displayImage(e,a,m),f&&f(e,a)}},function(n){var r=c.imageIds[t];h&&h(e,r,n)}),i.default.startGrabbing(),$(e).trigger("CornerstoneStackScroll",p)}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=n(1),i=r(n(28)),s=r(n(10)),l=n(46)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return r.setToPixelCoordinateSystem(e,t,.1),{fontSize:n/e.viewport.scale/.1,lineHeight:n/e.viewport.scale/.1,fontScale:.1}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,r.planePlaneIntersection)(e,t);if(n)return{start:(0,r.projectPatientPointToImagePlane)(n.start,e),end:(0,r.projectPatientPointToImagePlane)(n.end,e)}};var r=n(35)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){var l=o.getEnabledElement(n).image,u=o.getEnabledElement(r).image;if(l&&u){var c=o.metaData.get("imagePlane",l.imageId),d=o.metaData.get("imagePlane",u.imageId);if(c&&d&&c.rowCosines&&c.columnCosines&&c.imagePositionPatient&&d.rowCosines&&d.columnCosines&&d.imagePositionPatient&&c.frameOfReferenceUID===d.frameOfReferenceUID){var f=c.rowCosines.clone().cross(c.columnCosines),h=d.rowCosines.clone().cross(d.columnCosines),m=f.angleTo(h);if(!((m=Math.abs(m))<.5)){var p=(0,a.default)(c,d);if(p){var g=o.pixelToCanvas(t.element,p.start),v=o.pixelToCanvas(t.element,p.end),y=i.default.getActiveColor(),b=s.default.getToolWidth();e.setTransform(1,0,0,1,0,0),e.save(),e.beginPath(),e.strokeStyle=y,e.lineWidth=b,e.moveTo(g.x,g.y),e.lineTo(v.x,v.y),e.stroke(),e.restore()}}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=r(n(54)),i=r(n(4)),s=r(n(5))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1}}}}function i(e,t,n){var r={start:l.pixelToCanvas(e,t.handles.start),end:l.pixelToCanvas(e,t.handles.end)},o=u.lineSegment.distanceToPoint(r,n);return o<5||(r.start=l.pixelToCanvas(e,t.handles.start2),r.end=l.pixelToCanvas(e,t.handles.end2),(o=u.lineSegment.distanceToPoint(r,n))<5)}function s(e,t){console.log(t);var n=(0,y.getToolState)(e.currentTarget,b);if(void 0!==n){var r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var o=void 0,a=m.default.getToolWidth(),i=p.default.getFont(),s=x.getConfiguration(),u=0;u<n.data.length;u++){r.save(),s&&s.shadow&&(r.shadowColor=s.shadowColor||"#000000",r.shadowOffsetX=s.shadowOffsetX||1,r.shadowOffsetY=s.shadowOffsetY||1);var c=n.data[u];o=c.active?g.default.getActiveColor():g.default.getToolColor(),r.beginPath(),r.strokeStyle=o,r.lineWidth=a;var d=l.pixelToCanvas(t.element,c.handles.start),w=l.pixelToCanvas(t.element,c.handles.end);r.moveTo(d.x,d.y),r.lineTo(w.x,w.y),d=l.pixelToCanvas(t.element,c.handles.start2),w=l.pixelToCanvas(t.element,c.handles.end2),r.moveTo(d.x,d.y),r.lineTo(w.x,w.y),r.stroke(),(0,v.default)(r,t,c.handles),r.fillStyle=o;var T=(Math.ceil(c.handles.start.x)-Math.ceil(c.handles.end.x))*t.image.columnPixelSpacing,C=(Math.ceil(c.handles.start.y)-Math.ceil(c.handles.end.y))*t.image.rowPixelSpacing,P=(Math.ceil(c.handles.start2.x)-Math.ceil(c.handles.end2.x))*t.image.columnPixelSpacing,M=(Math.ceil(c.handles.start2.y)-Math.ceil(c.handles.end2.y))*t.image.rowPixelSpacing,S=Math.acos(Math.abs((T*P+C*M)/(Math.sqrt(T*T+C*C)*Math.sqrt(P*P+M*M))));S*=180/Math.PI;var I=(0,h.default)(S,2).toString()+String.fromCharCode(parseInt("00B0",16)),D=(d.x+w.x)/2,E=(d.y+w.y)/2;r.font=i,(0,f.default)(r,I,D,E,o),r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var l=o(n(0)),u=o(n(2)),c=r(n(7)),d=r(n(9)),f=r(n(6)),h=r(n(36)),m=r(n(5)),p=r(n(14)),g=r(n(4)),v=r(n(8)),y=n(1),b="angle",x=(0,c.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:b}),w=(0,d.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:b});t.angle=x,t.angleTouch=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,n){var r={start:l.pixelToCanvas(e,t.handles.start),end:l.pixelToCanvas(e,t.handles.end)};return u.lineSegment.distanceToPoint(r,n)<25}function s(e,t){var n=(0,C.getToolState)(e.currentTarget,P);if(n){var r=t.enabledElement,o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var a=void 0,i=h.default.getToolWidth(),s=m.default.getFont(),c=S.getConfiguration(),d=0;d<n.data.length;d++){o.save(),c&&c.shadow&&(o.shadowColor=c.shadowColor||"#000000",o.shadowOffsetX=c.shadowOffsetX||1,o.shadowOffsetY=c.shadowOffsetY||1);var y=n.data[d];a=y.active?p.default.getActiveColor():p.default.getToolColor();var b=l.pixelToCanvas(t.element,y.handles.start),x=l.pixelToCanvas(t.element,y.handles.end);c.arrowFirst?(0,v.default)(o,x,b,a,i):(0,v.default)(o,b,x,a,i);var w={drawHandlesIfActive:c&&c.drawHandlesOnHover};if(c.drawHandles&&(0,g.default)(o,t,y.handles,a,w),y.text&&""!==y.text){o.font=s;var T=o.measureText(y.text).width+10,M=m.default.getFontSize()+10,I=Math.max(T,M)/2+5;x.x<b.x&&(I=-I);var D=void 0;if(!y.handles.textBox.hasMoved){D=c.arrowFirst?{x:x.x-T/2+I,y:x.y-M/2}:{x:b.x-T/2-I,y:b.y-M/2};var E=l.internal.getTransform(r);E.invert();var O=E.transformPoint(D.x,D.y);y.handles.textBox.x=O.x,y.handles.textBox.y=O.y}D=l.pixelToCanvas(t.element,y.handles.textBox);var _=(0,f.default)(o,y.text,D.x,D.y,a);if(y.handles.textBox.boundingBox=_,y.handles.textBox.hasMoved){var k={start:{},end:{}},A=[b,x,{x:(b.x+x.x)/2,y:(b.y+x.y)/2}];k.end.x=D.x,k.end.y=D.y,k.start=u.point.findClosestPoint(A,k.end);var j=[{x:_.left+_.width/2,y:_.top},{x:_.left,y:_.top+_.height/2},{x:_.left+_.width/2,y:_.top+_.height},{x:_.left+_.width,y:_.top+_.height/2}];k.end=u.point.findClosestPoint(j,k.start),o.beginPath(),o.strokeStyle=a,o.lineWidth=i,o.setLineDash([2,3]),o.moveTo(k.start.x,k.start.y),o.lineTo(k.end.x,k.end.y),o.stroke()}}o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var l=o(n(0)),u=o(n(2)),c=r(n(7)),d=r(n(9)),f=r(n(6)),h=r(n(5)),m=r(n(14)),p=r(n(4)),g=r(n(8)),v=r(n(48)),y=r(n(22)),b=r(n(23)),x=r(n(12)),w=r(n(3)),T=r(n(18)),C=n(1),P="arrowAnnotate",M={getTextCallback:function(e){e(prompt("Enter your annotation:"))},changeTextCallback:function(e,t,n){n(prompt("Change your annotation:"))},drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},S=(0,c.default)({addNewMeasurement:function(e){function t(t){null===t?(0,C.removeToolState)(e.element,P,n):n.text=t,n.active=!1,l.updateImage(e.element),$(e.element).on("CornerstoneToolsMouseMove",r,S.mouseMoveCallback),$(e.element).on("CornerstoneToolsMouseDown",r,S.mouseDownCallback),$(e.element).on("CornerstoneToolsMouseDownActivate",r,S.mouseDownActivateCallback),$(e.element).on("CornerstoneToolsMouseDoubleClick",r,S.mouseDoubleClickCallback)}var n=a(e),r={mouseButtonMask:e.which};(0,C.addToolState)(e.element,P,n),$(e.element).off("CornerstoneToolsMouseMove",S.mouseMoveCallback),$(e.element).off("CornerstoneToolsMouseDown",S.mouseDownCallback),$(e.element).off("CornerstoneToolsMouseDownActivate",S.mouseDownActivateCallback),$(e.element).off("CornerstoneToolsMouseDoubleClick",S.mouseDoubleClickCallback),l.updateImage(e.element),(0,y.default)(e,P,n,n.handles.end,function(){(0,x.default)(e,n.handles)&&(0,C.removeToolState)(e.element,P,n);var r=S.getConfiguration();void 0===n.text&&r.getTextCallback(t),l.updateImage(e.element)})},createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:P,mouseDoubleClickCallback:function(e,t){var n=t.element,r=void 0;if(!e.data||!e.data.mouseButtonMask||(0,w.default)(t.which,e.data.mouseButtonMask)){var o=S.getConfiguration(),a=t.currentPoints.canvas,s=(0,C.getToolState)(n,P);if(s)for(var u=0;u<s.data.length;u++)if(r=s.data[u],i(n,r,a)||(0,T.default)(r.handles.textBox,a))return r.active=!0,l.updateImage(n),o.changeTextCallback(r,t,function(e,t,r){!0===r?(0,C.removeToolState)(n,P,e):e.text=t,e.active=!1,l.updateImage(n)}),e.stopImmediatePropagation(),!1}}});S.setConfiguration(M);var I=(0,d.default)({addNewMeasurement:function(e){function t(e){null===e?(0,C.removeToolState)(n,P,r):r.text=e,r.active=!1,l.updateImage(n),$(n).on("CornerstoneToolsTouchPress",I.pressCallback),$(n).on("CornerstoneToolsTouchStartActive",I.touchDownActivateCallback),$(n).on("CornerstoneToolsTap",I.tapCallback)}var n=e.element,r=a(e);(0,C.addToolState)(n,P,r),$(n).off("CornerstoneToolsTouchPress",I.pressCallback),$(n).off("CornerstoneToolsTouchStartActive",I.touchDownActivateCallback),$(n).off("CornerstoneToolsTap",I.tapCallback),l.updateImage(n),(0,b.default)(e,P,r,r.handles.end,function(){l.updateImage(n),(0,x.default)(e,r.handles)&&(0,C.removeToolState)(n,P,r);var o=S.getConfiguration();void 0===r.text&&o.getTextCallback(t)})},createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:P,pressCallback:function(e,t){function n(e,t,n){console.log("pressCallback doneChangingTextCallback"),!0===n?(0,C.removeToolState)(r,P,e):e.text=t,e.active=!1,l.updateImage(r),$(r).on("CornerstoneToolsTouchStart",I.touchStartCallback),$(r).on("CornerstoneToolsTouchStartActive",I.touchDownActivateCallback),$(r).on("CornerstoneToolsTap",I.tapCallback)}var r=t.element,o=void 0;if(!e.data||!e.data.mouseButtonMask||(0,w.default)(t.which,e.data.mouseButtonMask)){var a=S.getConfiguration(),s=t.currentPoints.canvas,u=(0,C.getToolState)(r,P);if(u){if(t.handlePressed)return $(r).off("CornerstoneToolsTouchStart",I.touchStartCallback),$(r).off("CornerstoneToolsTouchStartActive",I.touchDownActivateCallback),$(r).off("CornerstoneToolsTap",I.tapCallback),a.changeTextCallback(t.handlePressed,t,n),e.stopImmediatePropagation(),!1;for(var c=0;c<u.data.length;c++)if(o=u.data[c],i(r,o,s)||(0,T.default)(o.handles.textBox,s))return o.active=!0,l.updateImage(r),$(r).off("CornerstoneToolsTouchStart",I.touchStartCallback),$(r).off("CornerstoneToolsTouchStartActive",I.touchDownActivateCallback),$(r).off("CornerstoneToolsTap",I.tapCallback),a.changeTextCallback(o,t,n),e.stopImmediatePropagation(),!1;return!1}}}});t.arrowAnnotate=S,t.arrowAnnotateTouch=I},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){e.stopImmediatePropagation();var n=(0,v.getToolState)(e.currentTarget,x);if(n){var r=e.currentTarget,o=p.getEnabledElement(r).image.imageId,a=p.metaData.get("imagePlane",o),i=t.currentPoints.image,s=(0,b.imagePointToPatientPoint)(i,a);n.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==r){var t=Number.MAX_VALUE,n=-1,o=(0,v.getToolState)(e,"stack");if(void 0!==o){var a=o.data[0];if(a.imageIds.forEach(function(e,r){var o=p.metaData.get("imagePlane",e),a=o.imagePositionPatient,i=o.rowCosines.clone(),l=o.columnCosines.clone().clone().cross(i.clone()),u=Math.abs(l.clone().dot(a)-l.clone().dot(s));u<t&&(t=u,n=r)}),n!==a.currentImageIdIndex&&-1!==n&&void 0!==a.imageIds[n]){var i=g.default.getStartLoadHandler(),l=g.default.getEndLoadHandler(),u=g.default.getErrorLoadingHandler();i&&i(e);(!0===a.preventCache?p.loadImage(a.imageIds[n]):p.loadAndCacheImage(a.imageIds[n])).then(function(t){var r=p.getViewport(e);a.currentImageIdIndex=n,p.displayImage(e,t,r),l&&l(e,t)},function(t){var r=a.imageIds[n];u&&u(e,r,t)})}}}})}}function a(e,t){$(t.element).off("CornerstoneToolsMouseDrag",s),$(t.element).off("CornerstoneToolsMouseUp",a)}function i(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",s),$(t.element).on("CornerstoneToolsMouseUp",a),o(e,t),!1}function s(e,t){return o(e,t),!1}function l(e,t,n){var r={mouseButtonMask:t};(0,v.clearToolState)(e,x),(0,v.addToolState)(e,x,{synchronizationContext:n}),$(e).off("CornerstoneToolsMouseDown",i),$(e).on("CornerstoneToolsMouseDown",r,i)}function u(e){$(e).off("CornerstoneToolsMouseDown",i)}function c(e,t){$(t.element).off("CornerstoneToolsTouchDrag",f),$(t.element).off("CornerstoneToolsDragEnd",c)}function d(e,t){return $(t.element).on("CornerstoneToolsTouchDrag",f),$(t.element).on("CornerstoneToolsDragEnd",c),o(e,t),!1}function f(e,t){return o(e,t),!1}function h(e,t){(0,v.clearToolState)(e,x),(0,v.addToolState)(e,x,{synchronizationContext:t}),$(e).off("CornerstoneToolsTouchStart",d),$(e).on("CornerstoneToolsTouchStart",d)}function m(e){$(e).off("CornerstoneToolsTouchStart",d)}Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),g=r(n(10)),v=n(1),y=r(n(3)),b=n(35),x="crosshairs",w={activate:l,deactivate:u,enable:l,disable:u},T={activate:h,deactivate:m,enable:h,disable:m};t.crosshairs=w,t.crosshairsTouch=T},function(e,t,n){"use strict";function r(e){o.fitToWindow(e.element)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=(0,function(e){return e&&e.__esModule?e:{default:e}}(n(38)).default)(function(e,t){return a.strategy(t),!1});a.strategies={default:r},a.strategy=r,t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=l.getEnabledElement(e.element).canvas.getContext("2d");t.setTransform(1,0,0,1,0,0);var n=f.default.getActiveColor(),r=d.default.getFont(),o=d.default.getFontSize(),a=y.getConfiguration();t.save(),a&&a.shadow&&(t.shadowColor=a.shadowColor||"#000000",t.shadowOffsetX=a.shadowOffsetX||1,t.shadowOffsetY=a.shadowOffsetY||1);var i=Math.round(e.currentPoints.image.x),s=Math.round(e.currentPoints.image.y),u=void 0,c=void 0,g=void 0;if(!(i<0||s<0||i>=e.image.columns||s>=e.image.rows)){if(e.image.color)c=i+", "+s,g="R: "+(u=(0,m.default)(e.element,i,s,1,1))[0]+" G: "+u[1]+" B: "+u[2]+" A: "+u[3];else{var v=(u=l.getStoredPixels(e.element,i,s,1,1))[0],b=v*e.image.slope+e.image.intercept,x=(0,p.default)(e.image,v);c=i+", "+s,g="SP: "+v+" MO: "+parseFloat(b.toFixed(3)),x&&(g+=" SUV: "+parseFloat(x.toFixed(3)))}var w={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},T=l.pixelToCanvas(e.element,w);t.font=r,t.fillStyle=n,(0,h.default)(t,g,T.x,T.y+o+5,n),(0,h.default)(t,c,T.x,T.y,n),t.restore()}}function a(e,t){var n=t.element;$(n).off("CornerstoneImageRendered",i),$(n).off("CornerstoneToolsMouseDrag",s),$(n).off("CornerstoneToolsMouseUp",a),$(n).off("CornerstoneToolsMouseClick",a),l.updateImage(t.element)}function i(){v&&(y.strategy(v),v=null)}function s(e,t){var n=t.element;return v=t,l.updateImage(n),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),u=r(n(13)),c=r(n(11)),d=r(n(14)),f=r(n(4)),h=r(n(6)),m=r(n(32)),p=r(n(17)),g=r(n(3)),v=void 0,y=(0,u.default)(function(e,t){var n=t.element;if((0,g.default)(t.which,e.data.mouseButtonMask))return $(n).on("CornerstoneImageRendered",i),$(n).on("CornerstoneToolsMouseDrag",s),$(n).on("CornerstoneToolsMouseUp",a),$(n).on("CornerstoneToolsMouseClick",a),y.strategy(t),!1});y.strategies={default:o,minimal:function(e){var t=e.element,n=l.getEnabledElement(t),r=n.image,o=n.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);var a=f.default.getActiveColor(),i=d.default.getFont(),s=y.getConfiguration();o.save(),s&&s.shadow&&(o.shadowColor=s.shadowColor||"#000000",o.shadowOffsetX=s.shadowOffsetX||1,o.shadowOffsetY=s.shadowOffsetY||1);var u=l.metaData.get("generalSeriesModule",r.imageId),c=void 0;u&&(c=u.modality);var g=void 0,v=void 0,b="";if(!((g=!0===e.isTouchEvent?l.pageToPixel(t,e.currentPoints.page.x,e.currentPoints.page.y-4*d.default.getFontSize()):l.pageToPixel(t,e.currentPoints.page.x,e.currentPoints.page.y-d.default.getFontSize()/2)).x<0||g.y<0||g.x>=r.columns||g.y>=r.rows)){if(r.color)b="R: "+(v=(0,m.default)(t,g.x,g.y,1,1))[0]+" G: "+v[1]+" B: "+v[2];else{var x=(v=l.getStoredPixels(t,g.x,g.y,1,1))[0],w=x*e.image.slope+e.image.intercept,T=parseFloat(w.toFixed(2));if("CT"===c)b+="HU: "+T;else if("PT"===c){b+=T;var C=(0,p.default)(e.image,x);C&&(b+=" SUV: "+parseFloat(C.toFixed(2)))}else b+=T}var P=l.pixelToCanvas(t,g);o.font=i,o.fillStyle=a;var M=void 0,S=o.measureText(b).width;M=!0===e.isTouchEvent?{x:-S/2-5,y:-d.default.getFontSize()-10-12}:{x:12,y:-(d.default.getFontSize()+10)/2},o.beginPath(),o.strokeStyle=a,o.arc(P.x,P.y,6,0,2*Math.PI),o.stroke(),(0,h.default)(o,b,P.x+M.x,P.y+M.y,a),o.restore()}}},y.strategy=o;var b={fireOnTouchStart:!0},x=(0,c.default)(s,b);t.dragProbe=y,t.dragProbeTouch=x},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,n,r){var o=u.pixelToCanvas(e,t.handles.start),a=u.pixelToCanvas(e,t.handles.end),i={left:Math.min(o.x,a.x)+r/2,top:Math.min(o.y,a.y)+r/2,width:Math.abs(o.x-a.x)-r,height:Math.abs(o.y-a.y)-r},s={left:Math.min(o.x,a.x)-r/2,top:Math.min(o.y,a.y)-r/2,width:Math.abs(o.x-a.x)+r,height:Math.abs(o.y-a.y)+r},l=(0,y.default)(i,n);return!(!(0,y.default)(s,n)||l)}function s(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function l(e,t){var n=(0,w.getToolState)(e.currentTarget,T);if(n){var r=t.image,o=t.element,a=h.default.getToolWidth(),i=C.getConfiguration(),l=t.canvasContext.canvas.getContext("2d"),d=u.metaData.get("generalSeriesModule",r.imageId),f=void 0;d&&(f=d.modality),l.setTransform(1,0,0,1,0,0);for(var y=0;y<n.data.length;y++){l.save();var P=n.data[y];i&&i.shadow&&(l.shadowColor=i.shadowColor||"#000000",l.shadowOffsetX=i.shadowOffsetX||1,l.shadowOffsetY=i.shadowOffsetY||1);var M=m.default.getColorIfActive(P.active),S=u.pixelToCanvas(o,P.handles.start),I=u.pixelToCanvas(o,P.handles.end),D=Math.min(S.x,I.x),E=Math.min(S.y,I.y),O=Math.abs(S.x-I.x),_=Math.abs(S.y-I.y);if(l.beginPath(),l.strokeStyle=M,l.lineWidth=a,(0,v.default)(l,D,E,O,_),l.closePath(),i&&i.drawHandlesOnHover)if(!0===P.active)(0,p.default)(l,t,P.handles,M);else{var k={drawHandlesIfActive:!0};(0,p.default)(l,t,P.handles,M,k)}else(0,p.default)(l,t,P.handles,M);var A=void 0,j=void 0,R=void 0;if(!1===P.invalidated)j=P.meanStdDev,R=P.meanStdDevSUV,A=P.area;else{var $={left:Math.round(Math.min(P.handles.start.x,P.handles.end.x)),top:Math.round(Math.min(P.handles.start.y,P.handles.end.y)),width:Math.round(Math.abs(P.handles.start.x-P.handles.end.x)),height:Math.round(Math.abs(P.handles.start.y-P.handles.end.y))};if(!r.color){var L=u.getPixels(o,$.left,$.top,$.width,$.height);j=(0,b.default)(L,$),"PT"===f&&(R={mean:(0,x.default)(r,(j.mean-r.intercept)/r.slope),stdDev:(0,x.default)(r,(j.stdDev-r.intercept)/r.slope)}),j&&!isNaN(j.mean)&&(P.meanStdDev=j,P.meanStdDevSUV=R)}var B=r.columnPixelSpacing||1,N=r.rowPixelSpacing||1;A=Math.PI*($.width*B/2)*($.height*N/2),isNaN(A)||(P.area=A),P.invalidated=!1}var F=[];if(j&&void 0!==j.mean){var U="";"CT"===f&&(U=" HU");var z="Mean: "+s(j.mean.toFixed(2))+U,q="StdDev: "+s(j.stdDev.toFixed(2))+U;if(R&&void 0!==R.mean){z+=" SUV: "+s(R.mean.toFixed(2)),q+=" SUV: "+s(R.stdDev.toFixed(2))}F.push(z),F.push(q)}if(A){var V=" mm"+String.fromCharCode(178);r.rowPixelSpacing&&r.columnPixelSpacing||(V=" pixels"+String.fromCharCode(178));var H="Area: "+s(A.toFixed(2))+V;F.push(H)}P.handles.textBox.hasMoved||(P.handles.textBox.x=Math.max(P.handles.start.x,P.handles.end.x),P.handles.textBox.y=(P.handles.start.y+P.handles.end.y)/2);var W=u.pixelToCanvas(o,P.handles.textBox),G={centering:{x:!1,y:!0}},Y=(0,g.default)(l,F,W.x,W.y,M,G);if(P.handles.textBox.boundingBox=Y,P.handles.textBox.hasMoved){var X={start:{},end:{x:W.x,y:W.y}},J=[{x:D+O/2,y:E},{x:D,y:E+_/2},{x:D+O/2,y:E+_},{x:D+O,y:E+_/2}];X.start=c.point.findClosestPoint(J,X.end);var Q=[{x:Y.left+Y.width/2,y:Y.top},{x:Y.left,y:Y.top+Y.height/2},{x:Y.left+Y.width/2,y:Y.top+Y.height},{x:Y.left+Y.width,y:Y.top+Y.height/2}];X.end=c.point.findClosestPoint(Q,X.start),l.beginPath(),l.strokeStyle=M,l.lineWidth=a,l.setLineDash([2,3]),l.moveTo(X.start.x,X.start.y),l.lineTo(X.end.x,X.end.y),l.stroke()}l.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var u=o(n(0)),c=o(n(2)),d=r(n(7)),f=r(n(9)),h=r(n(5)),m=r(n(4)),p=r(n(8)),g=r(n(6)),v=r(n(50)),y=r(n(34)),b=r(n(47)),x=r(n(17)),w=n(1),T="ellipticalRoi",C=(0,d.default)({createNewMeasurement:a,onImageRendered:l,pointNearTool:function(e,t,n){return i(e,t,n,15)},toolType:T}),P=(0,f.default)({createNewMeasurement:a,onImageRendered:l,pointNearTool:function(e,t,n){return i(e,t,n,25)},toolType:T});t.ellipticalRoi=C,t.ellipticalRoiTouch=P},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){var t=(0,x.getToolState)(e.element,w);if(void 0!==t){var n=C.getConfiguration(),r=t.data[n.currentTool],o={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,lines:[]};r.handles.length&&r.handles[n.currentHandle-1].lines.push(e.currentPoints.image),r.handles.push(o),n.currentHandle+=1,n.freehand=!1,m.updateImage(e.element)}}function i(e,t){var n=(0,x.getToolState)(e.element,w);if(void 0!==n){var r=n.data[t];if(void 0!==r.handles)for(var o=e.currentPoints.canvas,a=0;a<r.handles.length;a++){var i=m.pixelToCanvas(e.element,r.handles[a]);if(p.point.distance(i,o)<5)return a}}}function s(e){var t=(0,x.getToolState)(e.element,w);if(t)for(var n=void 0,r=0;r<t.data.length;r++)if(void 0!==(n=i(e,r)))return{handleNearby:n,toolIndex:r}}function l(e,t){if($(t.element).off("CornerstoneToolsMouseUp",l),void 0!==(0,x.getToolState)(t.element,w)){var n=C.getConfiguration();t.event.shiftKey||(n.freehand=!1),m.updateImage(t.element)}}function u(e,t){var n=(0,x.getToolState)(t.element,w);if(n){var r=C.getConfiguration(),o=n.data[r.currentTool],a=Math.max(t.currentPoints.image.x,0);a=Math.min(a,t.image.width),r.mouseLocation.handles.start.x=a;var s=Math.max(t.currentPoints.image.y,0);s=Math.min(s,t.image.height),r.mouseLocation.handles.start.y=s;var l=r.currentHandle;if(r.modifying&&(o.active=!0,o.highlight=!0,o.handles[l].x=r.mouseLocation.handles.start.x,o.handles[l].y=r.mouseLocation.handles.start.y,l)){var u=o.handles[l-1].lines.length-1,c=o.handles[l-1].lines[u];c.x=r.mouseLocation.handles.start.x,c.y=r.mouseLocation.handles.start.y}if(r.freehand)o.handles[l-1].lines.push(t.currentPoints.image);else{var d=i(t,r.currentTool);void 0!==d&&d<o.handles.length-1&&(r.mouseLocation.handles.start.x=o.handles[d].x,r.mouseLocation.handles.start.y=o.handles[d].y)}m.updateImage(t.element)}}function c(e){$(e.element).on("CornerstoneToolsMouseMove",u),$(e.element).on("CornerstoneToolsMouseUp",l);var t={visible:!0,active:!0,handles:[]},n=C.getConfiguration();n.mouseLocation.handles.start.x=e.currentPoints.image.x,n.mouseLocation.handles.start.y=e.currentPoints.image.y,(0,x.addToolState)(e.element,w,t);var r=(0,x.getToolState)(e.element,w);n.currentTool=r.data.length-1}function d(e,t){var n=(0,x.getToolState)(e.element,w);if(n){var r=C.getConfiguration(),o=n.data[r.currentTool];o.active=!1,o.highlight=!1,void 0!==t&&o.handles[r.currentHandle-1].lines.push({x:o.handles[t].x,y:o.handles[t].y}),r.modifying&&(r.modifying=!1),r.currentHandle=0,r.currentTool=-1,$(e.element).off("CornerstoneToolsMouseMove",u),m.updateImage(e.element)}}function f(e,t){if((0,b.default)(t.which,e.data.mouseButtonMask)){var n=(0,x.getToolState)(t.element,w),r=void 0,o=void 0,f=C.getConfiguration(),h=f.currentTool;if(f.modifying)return void d(t);if(h<0){var m=s(t);m?(r=m.handleNearby,o=m.toolIndex,void 0!==r&&($(t.element).on("CornerstoneToolsMouseMove",u),$(t.element).on("CornerstoneToolsMouseUp",l),f.modifying=!0,f.currentHandle=r,f.currentTool=o)):(c(t),a(t))}else h>=0&&n.data[h].active&&(void 0!==(r=i(t,h))?d(t,r):t.event.shiftKey?f.freehand=!0:a(t));return!1}}function h(e,t){var n=(0,x.getToolState)(e.currentTarget,w);if(void 0!==n){var r=C.getConfiguration(),o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var a=void 0,i=g.default.getToolWidth(),s=v.default.getFillColor(),l=0;l<n.data.length;l++){o.save();var u=n.data[l];u.active?(a=v.default.getActiveColor(),s=v.default.getFillColor()):(a=v.default.getToolColor(),s=v.default.getToolColor());var c=void 0;if(u.handles.length)for(var d=0;d<u.handles.length;d++){c=u.handles[d];var f=m.pixelToCanvas(t.element,c);o.beginPath(),o.strokeStyle=a,o.lineWidth=i,o.moveTo(f.x,f.y);for(var h=0;h<u.handles[d].lines.length;h++){var p=m.pixelToCanvas(t.element,u.handles[d].lines[h]);o.lineTo(p.x,p.y),o.stroke()}var b=m.pixelToCanvas(t.element,r.mouseLocation.handles.start);d===u.handles.length-1&&(!u.active||r.freehand||r.modifying||(o.lineTo(b.x,b.y),o.stroke()))}var T={fill:s};u.active&&(0,y.default)(o,t,r.mouseLocation.handles,a,T),(0,y.default)(o,t,u.handles,a,T),o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.freehand=void 0;var m=o(n(0)),p=o(n(2)),g=r(n(5)),v=r(n(4)),y=r(n(8)),b=r(n(3)),x=n(1),w="freehand",T={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},freehand:!1,modifying:!1,currentHandle:0,currentTool:-1},C={enable:function(e){$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseUp",l),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",h),$(e).on("CornerstoneImageRendered",h),m.updateImage(e)},disable:function(e){$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseUp",l),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",h),m.updateImage(e)},activate:function(e,t){var n={mouseButtonMask:t};$(e).off("CornerstoneToolsMouseDown",n,f),$(e).off("CornerstoneToolsMouseUp",l),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",h),$(e).on("CornerstoneImageRendered",h),$(e).on("CornerstoneToolsMouseDown",n,f),m.updateImage(e)},deactivate:function(e){$(e).off("CornerstoneToolsMouseDown",f),$(e).off("CornerstoneToolsMouseUp",l),$(e).off("CornerstoneToolsMouseMove",u),$(e).off("CornerstoneImageRendered",h),$(e).on("CornerstoneImageRendered",h),m.updateImage(e)},getConfiguration:function(){return T},setConfiguration:function(e){T=e}};t.freehand=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){var t=(0,g.getToolState)(e.event.currentTarget,v);if(!(t&&t.data&&t.data.length>0))return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function i(e,t,n){var r=u.pixelToCanvas(e,t.handles.start),o=u.pixelToCanvas(e,t.handles.end),a={left:Math.min(r.x,o.x),top:Math.min(r.y,o.y),width:Math.abs(r.x-o.x),height:Math.abs(r.y-o.y)},i=!1;return n.x>=a.left&&n.x<=a.left+a.width&&n.y>=a.top&&n.y<=a.top+a.height&&(i=!0),i}function s(e,t,n){var r=u.pixelToCanvas(e,t.handles.start),o=u.pixelToCanvas(e,t.handles.end),a={left:Math.min(r.x,o.x),top:Math.min(r.y,o.y),width:Math.abs(r.x-o.x),height:Math.abs(r.y-o.y)};return c.rect.distanceToPoint(a,n)<5}function l(e,t){var n=(0,g.getToolState)(e.currentTarget,v);if(void 0!==n){var r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);var o=void 0,a=h.default.getToolWidth();r.save();var i=n.data[0];if(i){o=i.active?m.default.getActiveColor():m.default.getToolColor();var s=u.pixelToCanvas(t.element,i.handles.start),l=u.pixelToCanvas(t.element,i.handles.end),c={left:Math.min(s.x,l.x),top:Math.min(s.y,l.y),width:Math.abs(s.x-l.x),height:Math.abs(s.y-l.y)};r.beginPath(),r.strokeStyle="transparent",r.rect(0,0,r.canvas.clientWidth,r.canvas.clientHeight),r.rect(c.width+c.left,c.top,-c.width,c.height),r.stroke(),r.fillStyle="rgba(0,0,0,0.7)",r.fill(),r.closePath(),r.beginPath(),r.strokeStyle=o,r.lineWidth=a,r.setLineDash([4]),r.strokeRect(c.left,c.top,c.width,c.height),r.setLineDash([]),(0,p.default)(r,t,i.handles,o),r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var u=o(n(0)),c=o(n(2)),d=r(n(40)),f=r(n(9)),h=r(n(5)),m=r(n(4)),p=r(n(8)),g=n(1),v="highlight",y=(0,d.default)({createNewMeasurement:a,onImageRendered:l,pointNearTool:s,pointInsideRect:i,toolType:v},!0),b=(0,f.default)({createNewMeasurement:a,onImageRendered:l,pointNearTool:s,pointInsideRect:i,toolType:v},!0);t.highlight=y,t.highlightTouch=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(19)),a=r(n(6)),i=(0,o.default)(function(e,t){var n=t.image.stats,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);var o=[];Object.keys(n).forEach(function(e){var t=e+" : "+n[e];o.push(t)}),(0,a.default)(r,o,0,0,"orange"),o.forEach(function(e){console.log(e)})});t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,n){var r={start:l.pixelToCanvas(e,t.handles.start),end:l.pixelToCanvas(e,t.handles.end)};return u.lineSegment.distanceToPoint(r,n)<25}function s(e,t){var n=(0,g.getToolState)(e.currentTarget,v);if(n){var r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var o=h.default.getToolWidth(),a=y.getConfiguration(),i=0;i<n.data.length;i++){r.save(),a&&a.shadow&&(r.shadowColor=a.shadowColor||"#000000",r.shadowOffsetX=a.shadowOffsetX||1,r.shadowOffsetY=a.shadowOffsetY||1);var s=n.data[i],c=m.default.getColorIfActive(s.active),d=l.pixelToCanvas(t.element,s.handles.start),b=l.pixelToCanvas(t.element,s.handles.end);r.beginPath(),r.strokeStyle=c,r.lineWidth=o,r.moveTo(d.x,d.y),r.lineTo(b.x,b.y),r.stroke();var x={drawHandlesIfActive:a&&a.drawHandlesOnHover};(0,p.default)(r,t,s.handles,c,x),r.fillStyle=c;var w=(s.handles.end.x-s.handles.start.x)*(t.image.columnPixelSpacing||1),T=(s.handles.end.y-s.handles.start.y)*(t.image.rowPixelSpacing||1),C=Math.sqrt(w*w+T*T);s.length=C;var P=" mm";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(P=" pixels");var M=""+C.toFixed(2)+P;if(!s.handles.textBox.hasMoved){var S={x:Math.max(s.handles.start.x,s.handles.end.x)};S.x===s.handles.start.x?S.y=s.handles.start.y:S.y=s.handles.end.y,s.handles.textBox.x=S.x,s.handles.textBox.y=S.y}var I=l.pixelToCanvas(t.element,s.handles.textBox);I.x+=10;var D={centering:{x:!1,y:!0}},E=(0,f.default)(r,M,I.x,I.y,c,D);if(s.handles.textBox.boundingBox=E,s.handles.textBox.hasMoved){var O={start:{},end:{}},_=[d,b,{x:(d.x+b.x)/2,y:(d.y+b.y)/2}];O.end.x=I.x,O.end.y=I.y,O.start=u.point.findClosestPoint(_,O.end);var k=[{x:E.left+E.width/2,y:E.top},{x:E.left,y:E.top+E.height/2},{x:E.left+E.width/2,y:E.top+E.height},{x:E.left+E.width,y:E.top+E.height/2}];O.end=u.point.findClosestPoint(k,O.start),r.beginPath(),r.strokeStyle=c,r.lineWidth=o,r.setLineDash([2,3]),r.moveTo(O.start.x,O.start.y),r.lineTo(O.end.x,O.end.y),r.stroke()}r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var l=o(n(0)),u=o(n(2)),c=r(n(7)),d=r(n(9)),f=r(n(6)),h=r(n(5)),m=r(n(4)),p=r(n(8)),g=n(1),v="length",y=(0,c.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:v}),b=(0,d.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:v});t.length=y,t.lengthTouch=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=t.element;$(n).off("CornerstoneToolsMouseDrag",u),$(n).off("CornerstoneToolsMouseUp",o),$(n).off("CornerstoneToolsMouseClick",o),$(n).off("CornerstoneNewImage",s),a(t)}function a(e){$(e.element).find(".magnifyTool").hide(),document.body.style.cursor="default"}function i(e,t){var n=t.element;if((0,v.default)(t.which,e.data.mouseButtonMask))return $(n).on("CornerstoneToolsMouseDrag",t,u),$(n).on("CornerstoneToolsMouseUp",t,o),$(n).on("CornerstoneToolsMouseClick",t,o),x=t.currentPoints,$(n).on("CornerstoneNewImage",t,s),c(t),!1}function s(e,t){t.currentPoints=x,c(t)}function l(e,t){var n=t.element;$(t.element).off("CornerstoneToolsDragEnd",l),$(t.element).off("CornerstoneToolsTouchEnd",l),$(n).off("CornerstoneNewImage",s),a(t)}function u(e,t){return x=t.currentPoints,c(t),!0===t.isTouchEvent&&($(t.element).on("CornerstoneToolsDragEnd",l),$(t.element).on("CornerstoneToolsTouchEnd",l)),!1}function c(e){var t=$(e.element).find(".magnifyTool").get(0);t||d(e.element);var n=w.getConfiguration(),r=n.magnifySize,o=n.magnificationLevel,a=$(e.element).find("canvas").not(".magnifyTool").get(0);a.getContext("2d").setTransform(1,0,0,1,0,0);var i=t.getContext("2d");i.setTransform(1,0,0,1,0,0);var s=r/o,l=m.pixelToCanvas(e.element,e.currentPoints.image);!0===e.isTouchEvent&&(l.y-=1.25*s),l.x=Math.max(l.x,0),l.x=Math.min(l.x,a.width),l.y=Math.max(l.y,0),l.y=Math.min(l.y,a.height),i.clearRect(0,0,r,r),i.fillStyle="transparent",i.fillRect(0,0,r,r);var u={x:l.x-.5*s,y:l.y-.5*s};"Safari"===b&&(u.x=Math.max(u.x,0),u.y=Math.max(u.y,0)),u.x=Math.min(u.x,a.width),u.y=Math.min(u.y,a.height);var c={x:(a.width-u.x)*o,y:(a.height-u.y)*o};i.drawImage(a,u.x,u.y,a.width-u.x,a.height-u.y,0,0,c.x,c.y),t.style.top=l.y-.5*r+"px",t.style.left=l.x-.5*r+"px",t.style.display="block",document.body.style.cursor="none"}function d(e){if(0===$(e).find(".magnifyTool").length){var t=document.createElement("canvas");t.classList.add("magnifyTool");var n=w.getConfiguration();t.width=n.magnifySize,t.height=n.magnifySize,t.style.position="absolute",e.appendChild(t)}}function f(e){$(e).find(".magnifyTool").remove()}function h(e){$(e).off("CornerstoneToolsMouseDown",i),f(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),p=r(n(11)),g=n(24),v=r(n(3)),y={magnifySize:100,magnificationLevel:2},b=void 0,x=void 0,w={enable:function(e){if(!b){var t=(0,g.getBrowserInfo)().split(" ");b=t[0]}d(e)},activate:function(e,t){var n={mouseButtonMask:t};$(e).off("CornerstoneToolsMouseDown",i),$(e).on("CornerstoneToolsMouseDown",n,i),d(e)},deactivate:h,disable:h,getConfiguration:function(){return y},setConfiguration:function(e){y=e}},T={fireOnTouchStart:!0,activateCallback:d,disableCallback:f},C=(0,p.default)(u,T);t.magnify=w,t.magnifyTouchDrag=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=i.getEnabledElement(e),n=i.metaData.get("imagePlane",t.image.imageId);if(n&&n.rowCosines&&n.columnCosines){var r=s.default.getOrientationString(n.rowCosines),o=s.default.getOrientationString(n.columnCosines),a=s.default.invertOrientationString(r);return{top:s.default.invertOrientationString(o),bottom:o,left:a,right:r}}}function a(e){var t=i.getEnabledElement(e),n=void 0;n={x:t.image.width/2,y:5};var r=i.pixelToCanvas(e,n);n={x:t.image.width/2,y:t.image.height-5};var o=i.pixelToCanvas(e,n);n={x:5,y:t.image.height/2};var a=i.pixelToCanvas(e,n);return n={x:t.image.width-10,y:t.image.height/2},{top:r,bottom:o,left:a,right:i.pixelToCanvas(e,n)}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=r(n(45)),l=r(n(19)),u=r(n(4)),c=r(n(6)),d=(0,l.default)(function(e,t){var n=t.element,r=o(n);if(r){var i=a(n,r),s=t.canvasContext.canvas.getContext("2d");s.setTransform(1,0,0,1,0,0);var l=u.default.getToolColor(),f={top:s.measureText(r.top).width,left:s.measureText(r.left).width,right:s.measureText(r.right).width,bottom:s.measureText(r.bottom).width};(0,c.default)(s,r.top,i.top.x-f.top/2,i.top.y,l),(0,c.default)(s,r.left,i.left.x-f.left/2,i.left.y,l);var h=d.getConfiguration();h&&h.drawAllMarkers&&((0,c.default)(s,r.right,i.right.x-f.right/2,i.right.y,l),(0,c.default)(s,r.bottom,i.bottom.x-f.bottom/2,i.bottom.y,l))}});t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){$(t.element).off("CornerstoneToolsMouseDrag",a),$(t.element).off("CornerstoneToolsMouseUp",o),$(t.element).off("CornerstoneToolsMouseClick",o)}function a(e,t){var n=t.viewport.scale,r=t.viewport.scale;return t.image.rowPixelSpacing<t.image.columnPixelSpacing?n*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(r*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/n,t.viewport.translation.y+=t.deltaPoints.page.y/r,i.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=r(n(13)),l=r(n(11)),u=r(n(3)),c=(0,s.default)(function(e,t){if((0,u.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",a),$(t.element).on("CornerstoneToolsMouseUp",o),$(t.element).on("CornerstoneToolsMouseClick",o),!1}),d=(0,l.default)(a);t.pan=c,t.panTouchDrag=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o={testPointers:function(e){return e.numPointers>=2}},a=(0,function(e){return e&&e.__esModule?e:{default:e}}(n(25)).default)(function(e,t){var n=a.getConfiguration();if(n&&n.testPointers(t))return t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,r.setViewport(t.element,t.viewport),!1});a.setConfiguration(o),t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function i(e,t,n){var r=l.pixelToCanvas(e,t.handles.end);return u.point.distance(r,n)<5}function s(e,t){var n=(0,y.getToolState)(e.currentTarget,b);if(n){var r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var o=void 0,a=h.default.getFont(),i=h.default.getFontSize(),s=0;s<n.data.length;s++){r.save();var u=n.data[s];o=u.active?f.default.getActiveColor():f.default.getToolColor(),(0,m.default)(r,t,u.handles,o);var c=Math.round(u.handles.end.x),d=Math.round(u.handles.end.y),x=void 0,w=void 0,T=void 0;if(c<0||d<0||c>=t.image.columns||d>=t.image.rows)return;if(t.image.color)w=c+", "+d,T="R: "+(x=(0,g.default)(t.element,c,d,1,1))[0]+" G: "+x[1]+" B: "+x[2];else{var C=(x=l.getStoredPixels(t.element,c,d,1,1))[0],P=C*t.image.slope+t.image.intercept,M=(0,v.default)(t.image,C);w=c+", "+d,T="SP: "+C+" MO: "+parseFloat(P.toFixed(3)),M&&(T+=" SUV: "+parseFloat(M.toFixed(3)))}var S={x:u.handles.end.x+3,y:u.handles.end.y-3},I=l.pixelToCanvas(t.element,S);r.font=a,r.fillStyle=o,(0,p.default)(r,T,I.x,I.y+i+5,o),(0,p.default)(r,w,I.x,I.y,o),r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var l=o(n(0)),u=o(n(2)),c=r(n(7)),d=r(n(9)),f=r(n(4)),h=r(n(14)),m=r(n(8)),p=r(n(6)),g=r(n(32)),v=r(n(17)),y=n(1),b="probe",x=(0,c.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:b}),w=(0,d.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:b});t.probe=x,t.probeTouch=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,n){var r=c.pixelToCanvas(e,t.handles.start),o=c.pixelToCanvas(e,t.handles.end),a={left:Math.min(r.x,o.x),top:Math.min(r.y,o.y),width:Math.abs(r.x-o.x),height:Math.abs(r.y-o.y)};return d.rect.distanceToPoint(a,n)<5}function s(e,t){for(var n=0,r=0,o=0,a=0,i=t.top;i<t.top+t.height;i++)for(var s=t.left;s<t.left+t.width;s++)n+=e[a],r+=e[a]*e[a],o++,a++;if(0===o)return{count:o,mean:0,variance:0,stdDev:0};var l=n/o,u=r/o-l*l;return{count:o,mean:l,variance:u,stdDev:Math.sqrt(u)}}function l(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function u(e,t){var n=(0,b.getToolState)(e.currentTarget,x);if(n){var r=t.image,o=t.element,a=m.default.getToolWidth(),i=w.getConfiguration(),u=t.canvasContext.canvas.getContext("2d"),f=c.metaData.get("generalSeriesModule",r.imageId),h=void 0;f&&(h=f.modality),u.setTransform(1,0,0,1,0,0);for(var T=0;T<n.data.length;T++){u.save();var C=n.data[T];i&&i.shadow&&(u.shadowColor=i.shadowColor||"#000000",u.shadowOffsetX=i.shadowOffsetX||1,u.shadowOffsetY=i.shadowOffsetY||1);var P=p.default.getColorIfActive(C.active),M=c.pixelToCanvas(o,C.handles.start),S=c.pixelToCanvas(o,C.handles.end),I=Math.min(M.x,S.x),D=Math.min(M.y,S.y),E=Math.abs(M.x-S.x),O=Math.abs(M.y-S.y);if(u.beginPath(),u.strokeStyle=P,u.lineWidth=a,u.rect(I,D,E,O),u.stroke(),i&&i.drawHandlesOnHover)if(!0===C.active)(0,g.default)(u,t,C.handles,P);else{var _={drawHandlesIfActive:!0};(0,g.default)(u,t,C.handles,P,_)}else(0,g.default)(u,t,C.handles,P);var k=void 0,A=void 0,j=void 0;if(!1===C.invalidated)A=C.meanStdDev,j=C.meanStdDevSUV,k=C.area;else{var R={left:Math.min(C.handles.start.x,C.handles.end.x),top:Math.min(C.handles.start.y,C.handles.end.y),width:Math.abs(C.handles.start.x-C.handles.end.x),height:Math.abs(C.handles.start.y-C.handles.end.y)};r.color||(A=s(c.getPixels(o,R.left,R.top,R.width,R.height),R),"PT"===h&&(j={mean:(0,y.default)(r,(A.mean-r.intercept)/r.slope),stdDev:(0,y.default)(r,(A.stdDev-r.intercept)/r.slope)}),A&&!isNaN(A.mean)&&(C.meanStdDev=A,C.meanStdDevSUV=j));var $=r.columnPixelSpacing||1,L=r.rowPixelSpacing||1;k=R.width*$*(R.height*L),isNaN(k)||(C.area=k),C.invalidated=!1}var B=[];if(A&&A.mean){var N="";"CT"===h&&(N=" HU");var F="Mean: "+l(A.mean.toFixed(2))+N,U="StdDev: "+l(A.stdDev.toFixed(2))+N;if(j&&void 0!==j.mean){F+=" SUV: "+l(j.mean.toFixed(2)),U+=" SUV: "+l(j.stdDev.toFixed(2))}B.push(F),B.push(U)}if(k){var z=" mm"+String.fromCharCode(178);r.rowPixelSpacing&&r.columnPixelSpacing||(z=" pixels"+String.fromCharCode(178));var q="Area: "+l(k.toFixed(2))+z;B.push(q)}C.handles.textBox.hasMoved||(C.handles.textBox.x=Math.max(C.handles.start.x,C.handles.end.x),C.handles.textBox.y=(C.handles.start.y+C.handles.end.y)/2);var V=c.pixelToCanvas(o,C.handles.textBox),H={centering:{x:!1,y:!0}},W=(0,v.default)(u,B,V.x,V.y,P,H);if(C.handles.textBox.boundingBox=W,C.handles.textBox.hasMoved){var G={start:{},end:{x:V.x,y:V.y}},Y=[{x:I+E/2,y:D},{x:I,y:D+O/2},{x:I+E/2,y:D+O},{x:I+E,y:D+O/2}];G.start=d.point.findClosestPoint(Y,G.end);var X=[{x:W.left+W.width/2,y:W.top},{x:W.left,y:W.top+W.height/2},{x:W.left+W.width/2,y:W.top+W.height},{x:W.left+W.width,y:W.top+W.height/2}];G.end=d.point.findClosestPoint(X,G.start),u.beginPath(),u.strokeStyle=P,u.lineWidth=a,u.setLineDash([2,3]),u.moveTo(G.start.x,G.start.y),u.lineTo(G.end.x,G.end.y),u.stroke()}u.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var c=o(n(0)),d=o(n(2)),f=r(n(7)),h=r(n(9)),m=r(n(5)),p=r(n(4)),g=r(n(8)),v=r(n(6)),y=r(n(17)),b=n(1),x="rectangleRoi",w=(0,f.default)({createNewMeasurement:a,onImageRendered:u,pointNearTool:i,toolType:x}),T=(0,h.default)({createNewMeasurement:a,onImageRendered:u,pointNearTool:i,toolType:x});t.rectangleRoi=w,t.rectangleRoiTouch=T},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.element.getBoundingClientRect(e.element),n={x:e.currentPoints.client.x,y:e.currentPoints.client.y},r=e.element.clientWidth,o=e.element.clientHeight,a={x:n.x-t.left-r/2,y:-1*(n.y-t.top-o/2)},i=-1*(Math.atan2(a.y,a.x)*(180/Math.PI))+90;e.viewport.rotation=i,s.setViewport(e.element,e.viewport)}function a(e,t){$(t.element).off("CornerstoneToolsMouseDrag",i),$(t.element).off("CornerstoneToolsMouseUp",a),$(t.element).off("CornerstoneToolsMouseClick",a)}function i(e,t){return d.strategy(t),s.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),l=r(n(13)),u=r(n(11)),c=r(n(3)),d=(0,l.default)(function(e,t){if((0,c.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",i),$(t.element).on("CornerstoneToolsMouseUp",a),$(t.element).on("CornerstoneToolsMouseClick",a),!1});d.strategies={default:o,horizontal:function(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,s.setViewport(e.element,e.viewport)},vertical:function(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,s.setViewport(e.element,e.viewport)}},d.strategy=o;var f=(0,u.default)(i);t.rotate=d,t.rotateTouchDrag=f},function(e,t,n){"use strict";function r(e,t){return t.viewport.rotation+=t.rotation,o.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a={activate:function(e){$(e).off("CornerstoneToolsTouchRotate",r),$(e).on("CornerstoneToolsTouchRotate",r)},disable:function(e){$(e).off("CornerstoneToolsTouchRotate",r)}};t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=$(e).find("canvas").get(0),r=document.createElement("a");if(r.download=t,r.href=n.toDataURL(),document.createEvent){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(o)}else r.fireEvent&&r.fireEvent("onclick")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,n){if(t.handles.end){var r=l.pixelToCanvas(e,t.handles.end);return u.point.distance(r,n)<25}}function s(e,t){var n=(0,T.getToolState)(e.currentTarget,C);if(n){var r=t.enabledElement,o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var a=t.canvasContext.canvas.width,i=void 0,s=m.default.getToolWidth(),c=h.default.getFont(),d=M.getConfiguration(),g=0;g<n.data.length;g++){o.save(),d&&d.shadow&&(o.shadowColor=d.shadowColor||"#000000",o.shadowOffsetX=d.shadowOffsetX||1,o.shadowOffsetY=d.shadowOffsetY||1);var v=n.data[g];i=v.active?p.default.getActiveColor():p.default.getToolColor();var x=l.pixelToCanvas(t.element,v.handles.end);(0,b.default)(o,x,i,s);var w={drawHandlesIfActive:d&&d.drawHandlesOnHover};if(d.drawHandles&&(0,y.default)(o,t,x,i,w),v.text&&""!==v.text){o.font=c;var P="";P=d.showCoordinates?v.text+" x: "+Math.round(v.handles.end.x)+" y: "+Math.round(v.handles.end.y):v.text;var S=o.measureText(P).width+10,I=h.default.getFontSize()+10,D=Math.max(S,I)/2+5;x.x>a/2&&(D=-D);var E=void 0;if(!v.handles.textBox.hasMoved){E={x:x.x-S/2+D,y:x.y-I/2};var O=l.internal.getTransform(r);O.invert();var _=O.transformPoint(E.x,E.y);v.handles.textBox.x=_.x,v.handles.textBox.y=_.y}E=l.pixelToCanvas(t.element,v.handles.textBox);var k=(0,f.default)(o,P,E.x,E.y,i);if(v.handles.textBox.boundingBox=k,v.handles.textBox.hasMoved){var A={start:{},end:{}};A.end.x=E.x,A.end.y=E.y,A.start=x;var j=[{x:k.left+k.width/2,y:k.top},{x:k.left,y:k.top+k.height/2},{x:k.left+k.width/2,y:k.top+k.height},{x:k.left+k.width,y:k.top+k.height/2}];A.end=u.point.findClosestPoint(j,A.start),o.beginPath(),o.strokeStyle=i,o.lineWidth=s,o.setLineDash([2,3]),o.moveTo(A.start.x,A.start.y),o.lineTo(A.end.x,A.end.y),o.stroke()}}o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var l=o(n(0)),u=o(n(2)),c=r(n(7)),d=r(n(9)),f=r(n(6)),h=r(n(14)),m=r(n(5)),p=r(n(4)),g=r(n(12)),v=r(n(21)),y=r(n(8)),b=r(n(49)),x=r(n(3)),w=r(n(18)),T=n(1),C="seedAnnotate",P={getTextCallback:function(e){e(prompt("Enter your annotation:"))},changeTextCallback:function(e,t,n){n(prompt("Change your annotation:"))},drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0},M=(0,c.default)({addNewMeasurement:function(e){function t(e){null===e?(0,T.removeToolState)(n,C,o):o.text=e,o.active=!1,l.updateImage(n)}var n=e.element,r=M.getConfiguration(),o=a(e);(0,T.addToolState)(n,C,o),l.updateImage(n),(0,v.default)(e,C,o,o.handles.end,function(){(0,g.default)(e,o.handles)&&(0,T.removeToolState)(n,C,o),void 0===o.text&&r.getTextCallback(t),l.updateImage(n)})},createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:C,mouseDoubleClickCallback:function(e,t){var n=t.element,r=void 0;if(!e.data||!e.data.mouseButtonMask||(0,x.default)(t.which,e.data.mouseButtonMask)){var o=M.getConfiguration(),a=t.currentPoints.canvas,s=(0,T.getToolState)(n,C);if(s){for(var u=0;u<s.data.length;u++)if(r=s.data[u],i(n,r,a)||(0,w.default)(r.handles.textBox,a))return r.active=!0,l.updateImage(n),o.changeTextCallback(r,t,function(e,t,r){!0===r?(0,T.removeToolState)(n,C,e):e.text=t,e.active=!1,l.updateImage(n)}),e.stopImmediatePropagation(),!1;return!1}}}});M.setConfiguration(P);var S=(0,d.default)({addNewMeasurement:function(e){function t(e){null===e?(0,T.removeToolState)(n,C,o):o.text=e,o.active=!1,l.updateImage(n)}var n=e.element,r=M.getConfiguration(),o=a(e);(0,T.addToolState)(n,C,o),l.updateImage(n),(0,v.default)(e,C,o,o.handles.end,function(){(0,g.default)(e,o.handles)&&(0,T.removeToolState)(n,C,o),void 0===o.text&&r.getTextCallback(t),l.updateImage(n)})},createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:C,pressCallback:function(e,t){function n(e,t,n){console.log("pressCallback doneChangingTextCallback"),!0===n?(0,T.removeToolState)(r,C,e):e.text=t,e.active=!1,l.updateImage(r),$(r).on("CornerstoneToolsTouchStart",S.touchStartCallback),$(r).on("CornerstoneToolsTouchStartActive",S.touchDownActivateCallback),$(r).on("CornerstoneToolsTap",S.tapCallback)}var r=t.element,o=void 0;if(e.data&&e.data.mouseButtonMask&&!(0,x.default)(t.which,e.data.mouseButtonMask))return!1;var a=M.getConfiguration(),s=t.currentPoints.canvas,u=(0,T.getToolState)(r,C);if(!u)return!1;if(t.handlePressed)return $(r).off("CornerstoneToolsTouchStart",S.touchStartCallback),$(r).off("CornerstoneToolsTouchStartActive",S.touchDownActivateCallback),$(r).off("CornerstoneToolsTap",S.tapCallback),a.changeTextCallback(t.handlePressed,t,n),e.stopImmediatePropagation(),!1;for(var c=0;c<u.data.length;c++)if(o=u.data[c],i(r,o,s)||(0,w.default)(o.handles.textBox,s))return o.active=!0,l.updateImage(r),$(r).off("CornerstoneToolsTouchStart",S.touchStartCallback),$(r).off("CornerstoneToolsTouchStartActive",S.touchDownActivateCallback),$(r).off("CornerstoneToolsTap",S.tapCallback),a.changeTextCallback(o,t,n),e.stopImmediatePropagation(),!1;return!1}});t.seedAnnotate=M,t.seedAnnotateTouch=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function i(e,t,n){var r={start:u.pixelToCanvas(e,t.handles.start),end:u.pixelToCanvas(e,t.handles.middle)},o=c.lineSegment.distanceToPoint(r,n);return o<25||(r.start=u.pixelToCanvas(e,t.handles.middle),r.end=u.pixelToCanvas(e,t.handles.end),(o=c.lineSegment.distanceToPoint(r,n))<25)}function s(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function l(e,t){var n=(0,T.getToolState)(e.currentTarget,C);if(n){var r=t.enabledElement,o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var a=void 0,i=p.default.getToolWidth(),l=m.default.getFont(),d=P.getConfiguration(),v=0;v<n.data.length;v++){o.save(),d&&d.shadow&&(o.shadowColor=d.shadowColor||"#000000",o.shadowOffsetX=d.shadowOffsetX||1,o.shadowOffsetY=d.shadowOffsetY||1);var y=n.data[v];a=y.active?g.default.getActiveColor():g.default.getToolColor();var b=u.pixelToCanvas(t.element,y.handles.start),w=u.pixelToCanvas(t.element,y.handles.middle),M=u.pixelToCanvas(t.element,y.handles.end);o.beginPath(),o.strokeStyle=a,o.lineWidth=i,o.moveTo(b.x,b.y),o.lineTo(w.x,w.y),o.lineTo(M.x,M.y),o.stroke();var S={drawHandlesIfActive:d&&d.drawHandlesOnHover};(0,x.default)(o,t,y.handles,a,S),o.fillStyle=a;var I=t.image.columnPixelSpacing||1,D=t.image.rowPixelSpacing||1,E="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(E=" (isotropic)");var O={x:(Math.ceil(y.handles.middle.x)-Math.ceil(y.handles.start.x))*I,y:(Math.ceil(y.handles.middle.y)-Math.ceil(y.handles.start.y))*D},_={x:(Math.ceil(y.handles.end.x)-Math.ceil(y.handles.middle.x))*I,y:(Math.ceil(y.handles.end.y)-Math.ceil(y.handles.middle.y))*D},k={x:(Math.ceil(y.handles.end.x)-Math.ceil(y.handles.start.x))*I,y:(Math.ceil(y.handles.end.y)-Math.ceil(y.handles.start.y))*D},A=s(O),j=s(_),R=s(k),$=Math.acos((Math.pow(A,2)+Math.pow(j,2)-Math.pow(R,2))/(2*A*j));$*=180/Math.PI;var L=(0,h.default)($,2);if(L){var B=L.toString()+String.fromCharCode(parseInt("00B0",16))+E,N=void 0;if(y.handles.textBox.hasMoved)N=u.pixelToCanvas(t.element,y.handles.textBox);else{N={x:w.x,y:w.y},o.font=l;var F=o.measureText(B).width;w.x<b.x?N.x-=15+F+10:N.x+=15;var U=u.internal.getTransform(r);U.invert();var z=U.transformPoint(N.x,N.y);y.handles.textBox.x=z.x,y.handles.textBox.y=z.y}var q={centering:{x:!1,y:!0}},V=(0,f.default)(o,B,N.x,N.y,a,q);if(y.handles.textBox.boundingBox=V,y.handles.textBox.hasMoved){var H={start:{},end:{}},W=[b,M,w];H.end.x=N.x,H.end.y=N.y,H.start=c.point.findClosestPoint(W,H.end);var G=[{x:V.left+V.width/2,y:V.top},{x:V.left,y:V.top+V.height/2},{x:V.left+V.width/2,y:V.top+V.height},{x:V.left+V.width,y:V.top+V.height/2}];H.end=c.point.findClosestPoint(G,H.start),o.beginPath(),o.strokeStyle=a,o.lineWidth=i,o.setLineDash([2,3]),o.moveTo(H.start.x,H.start.y),o.lineTo(H.end.x,H.end.y),o.stroke()}}o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var u=o(n(0)),c=o(n(2)),d=r(n(7)),f=r(n(6)),h=r(n(36)),m=r(n(14)),p=r(n(5)),g=r(n(4)),v=r(n(12)),y=r(n(22)),b=r(n(23)),x=r(n(8)),w=r(n(9)),T=n(1),C="simpleAngle",P=(0,d.default)({createNewMeasurement:a,addNewMeasurement:function(e){var t=a(e),n=e.element,r={mouseButtonMask:e.which};(0,T.addToolState)(n,C,t),$(n).off("CornerstoneToolsMouseMove",P.mouseMoveCallback),$(n).off("CornerstoneToolsMouseDrag",P.mouseMoveCallback),$(n).off("CornerstoneToolsMouseDown",P.mouseDownCallback),$(n).off("CornerstoneToolsMouseDownActivate",P.mouseDownActivateCallback),u.updateImage(n),(0,y.default)(e,C,t,t.handles.middle,function(){if(t.active=!1,(0,v.default)(e,t.handles))return(0,T.removeToolState)(n,C,t),$(n).on("CornerstoneToolsMouseMove",P.mouseMoveCallback),$(n).on("CornerstoneToolsMouseDrag",P.mouseMoveCallback),$(n).on("CornerstoneToolsMouseDown",r,P.mouseDownCallback),$(n).on("CornerstoneToolsMouseDownActivate",r,P.mouseDownActivateCallback),void u.updateImage(n);t.handles.end.active=!0,u.updateImage(n),(0,y.default)(e,C,t,t.handles.end,function(){t.active=!1,(0,v.default)(e,t.handles)&&(0,T.removeToolState)(n,C,t),$(n).on("CornerstoneToolsMouseMove",P.mouseMoveCallback),$(n).on("CornerstoneToolsMouseDrag",P.mouseMoveCallback),$(n).on("CornerstoneToolsMouseDown",r,P.mouseDownCallback),$(n).on("CornerstoneToolsMouseDownActivate",r,P.mouseDownActivateCallback),u.updateImage(n)})})},onImageRendered:l,pointNearTool:i,toolType:C}),M=(0,w.default)({createNewMeasurement:a,addNewMeasurement:function(e){var t=a(e),n=e.element;(0,T.addToolState)(n,C,t),$(n).off("CornerstoneToolsTouchDrag",M.touchMoveCallback),$(n).off("CornerstoneToolsTouchStartActive",M.touchDownActivateCallback),$(n).off("CornerstoneToolsTouchStart",M.touchStartCallback),$(n).off("CornerstoneToolsTap",M.tapCallback),u.updateImage(n),(0,b.default)(e,C,t,t.handles.middle,function(){if((0,v.default)(e,t.handles))return(0,T.removeToolState)(n,C,t),$(n).on("CornerstoneToolsTouchDrag",M.touchMoveCallback),$(n).on("CornerstoneToolsTouchStart",M.touchStartCallback),$(n).on("CornerstoneToolsTouchStartActive",M.touchDownActivateCallback),$(n).on("CornerstoneToolsTap",M.tapCallback),void u.updateImage(n);(0,b.default)(e,C,t,t.handles.end,function(){(0,v.default)(e,t.handles)&&((0,T.removeToolState)(n,C,t),u.updateImage(n)),$(n).on("CornerstoneToolsTouchDrag",M.touchMoveCallback),$(n).on("CornerstoneToolsTouchStart",M.touchStartCallback),$(n).on("CornerstoneToolsTouchStartActive",M.touchDownActivateCallback),$(n).on("CornerstoneToolsTap",M.tapCallback)})})},onImageRendered:l,pointNearTool:i,toolType:C});t.simpleAngle=P,t.simpleAngleTouch=M},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e){var t=y.getConfiguration();if(t.current){var n={visible:!0,active:!0,text:t.current,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},r={left:0,top:0,width:e.image.width,height:e.image.height};if(u.point.insideRect(n.handles.end,r)){var o=t.markers.indexOf(t.current);return t.ascending?(o+=1)>=t.markers.length&&(t.loop?o-=t.markers.length:o=-1):(o-=1)<0&&(t.loop?o+=t.markers.length:o=-1),t.current=t.markers[o],n}}}function i(e,t,n){if(t.handles.end.boundingBox){var r=u.rect.distanceToPoint(t.handles.end.boundingBox,n),o=(0,f.default)(t.handles.end,n);return r<10||o}}function s(e,t){var n=(0,g.getToolState)(t.element,v);if(n){var r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var o=y.getConfiguration(),a=0;a<n.data.length;a++){var i=n.data[a],s=h.default.getToolColor();i.active&&(s=h.default.getActiveColor()),r.save(),o&&o.shadow&&(r.shadowColor=o.shadowColor||"#000000",r.shadowOffsetX=o.shadowOffsetX||1,r.shadowOffsetY=o.shadowOffsetY||1),r.fillStyle=s;var u=r.measureText(i.text);i.textWidth=u.width+10;var c=l.pixelToCanvas(t.element,i.handles.end),d={centering:{x:!0,y:!0}},f=(0,p.default)(r,i.text,c.x,c.y-10,s,d);i.handles.end.boundingBox=f,r.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var l=o(n(0)),u=o(n(2)),c=r(n(7)),d=r(n(9)),f=r(n(18)),h=r(n(4)),m=r(n(3)),p=r(n(6)),g=n(1),v="textMarker",y=(0,c.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:v,mouseDoubleClickCallback:function(e,t){var n=t.element,r=void 0;if(!e.data||!e.data.mouseButtonMask||(0,m.default)(t.which,e.data.mouseButtonMask)){var o=y.getConfiguration(),a=t.currentPoints.canvas,s=(0,g.getToolState)(n,v);if(s){for(var u=0;u<s.data.length;u++)if(r=s.data[u],i(n,r,a))return r.active=!0,l.updateImage(n),$(n).off("CornerstoneToolsMouseMove",y.mouseMoveCallback),$(n).off("CornerstoneToolsMouseDown",y.mouseDownCallback),$(n).off("CornerstoneToolsMouseDownActivate",y.mouseDownActivateCallback),$(n).off("CornerstoneToolsMouseDoubleClick",y.mouseDoubleClickCallback),o.changeTextCallback(r,t,function(t,r,o){!0===o?(0,g.removeToolState)(n,v,t):t.text=r,t.active=!1,l.updateImage(n);var a={mouseButtonMask:e.data.mouseButtonMask};$(n).on("CornerstoneToolsMouseMove",a,y.mouseMoveCallback),$(n).on("CornerstoneToolsMouseDown",a,y.mouseDownCallback),$(n).on("CornerstoneToolsMouseDownActivate",a,y.mouseDownActivateCallback),$(n).on("CornerstoneToolsMouseDoubleClick",a,y.mouseDoubleClickCallback)}),e.stopImmediatePropagation(),!1;return!1}}}}),b=(0,d.default)({createNewMeasurement:a,onImageRendered:s,pointNearTool:i,toolType:v,pressCallback:function(e,t){function n(e,t,n){!0===n?(0,g.removeToolState)(r,v,e):e.text=t,e.active=!1,l.updateImage(r),$(r).on("CornerstoneToolsTouchDrag",b.touchMoveCallback),$(r).on("CornerstoneToolsTouchStartActive",b.touchDownActivateCallback),$(r).on("CornerstoneToolsTouchStart",b.touchStartCallback),$(r).on("CornerstoneToolsTap",b.tapCallback),$(r).on("CornerstoneToolsTouchPress",b.pressCallback)}var r=t.element,o=void 0,a=y.getConfiguration(),s=t.currentPoints.canvas,u=(0,g.getToolState)(r,v);if(!u)return!1;if(t.handlePressed)return t.handlePressed.active=!0,l.updateImage(r),$(r).off("CornerstoneToolsTouchDrag",b.touchMoveCallback),$(r).off("CornerstoneToolsTouchStartActive",b.touchDownActivateCallback),$(r).off("CornerstoneToolsTouchStart",b.touchStartCallback),$(r).off("CornerstoneToolsTap",b.tapCallback),$(r).off("CornerstoneToolsTouchPress",b.pressCallback),a.changeTextCallback(t.handlePressed,t,n),e.stopImmediatePropagation(),!1;for(var c=0;c<u.data.length;c++)if(o=u.data[c],i(r,o,s))return o.active=!0,l.updateImage(r),$(r).off("CornerstoneToolsTouchDrag",b.touchMoveCallback),$(r).off("CornerstoneToolsTouchStartActive",b.touchDownActivateCallback),$(r).off("CornerstoneToolsTouchStart",b.touchStartCallback),$(r).off("CornerstoneToolsTap",b.tapCallback),$(r).off("CornerstoneToolsTouchPress",b.pressCallback),a.changeTextCallback(o,t,n),e.stopImmediatePropagation(),!1;return!1}});t.textMarker=y,t.textMarkerTouch=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){$(t.element).off("CornerstoneToolsMouseDrag",i),$(t.element).off("CornerstoneToolsMouseUp",o),$(t.element).off("CornerstoneToolsMouseClick",o)}function a(e){var t=(e.image.maxPixelValue*e.image.slope+e.image.intercept-(e.image.minPixelValue*e.image.slope+e.image.intercept))/1024,n=e.deltaPoints.page.x*t,r=e.deltaPoints.page.y*t;e.viewport.voi.windowWidth+=n,e.viewport.voi.windowCenter+=r}function i(e,t){return d.strategy(t),s.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),l=r(n(13)),u=r(n(11)),c=r(n(3)),d=(0,l.default)(function(e,t){if((0,c.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",i),$(t.element).on("CornerstoneToolsMouseUp",o),$(t.element).on("CornerstoneToolsMouseClick",o),!1});d.strategies={default:a},d.strategy=a;var f=(0,u.default)(function(e,t){e.stopImmediatePropagation();var n=t,r=(n.image.maxPixelValue*n.image.slope+n.image.intercept-(n.image.minPixelValue*n.image.slope+n.image.intercept))/1024,o=n.deltaPoints.page.x*r,a=n.deltaPoints.page.y*r,i=d.getConfiguration();i.orientation?0===i.orientation?(n.viewport.voi.windowWidth+=o,n.viewport.voi.windowCenter+=a):(n.viewport.voi.windowWidth+=a,n.viewport.voi.windowCenter+=o):(n.viewport.voi.windowWidth+=o,n.viewport.voi.windowCenter+=a),s.setViewport(n.element,n.viewport)});t.wwwc=d,t.wwwcTouchDrag=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r=e.length;if(r<2)return{min:t,max:n,mean:(t+n)/2};for(var o=n,a=t,i=0,s=0;s<r;s++){var l=e[s];o=Math.min(o,l),a=Math.max(a,l),i+=l}return{min:o,max:a,mean:i/r}}function a(e,t){var n=(0,y.getToolState)(t.element,w);n&&n.data&&(n.data=[]),$(t.element).off("CornerstoneToolsMouseMove",d),$(t.element).off("CornerstoneToolsMouseDrag",d),$(t.element).off("CornerstoneToolsMouseUp",i),$(t.element).off("CornerstoneToolsMouseClick",i);var r={mouseButtonMask:C};$(t.element).on("CornerstoneToolsMouseDown",r,u)}function i(e,t){$(t.element).off("CornerstoneToolsMouseMove",d),$(t.element).off("CornerstoneToolsMouseDrag",d),$(t.element).off("CornerstoneToolsMouseUp",i),$(t.element).off("CornerstoneToolsMouseClick",i);var n={mouseButtonMask:C};$(t.element).on("CornerstoneToolsMouseDown",n,u);var r=(0,y.getToolState)(t.element,w);r&&r.data&&r.data.length&&(r.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},s(t))}function s(e){var t=(0,y.getToolState)(e.element,w);if(t&&t.data&&t.data.length){var n=t.data[0].startPoint,r=t.data[0].endPoint,a=Math.abs(n.x-r.x),i=Math.abs(n.y-r.y),s=Math.min(n.x,r.x),l=Math.min(n.y,r.y);s=Math.max(s,0),s=Math.min(s,e.image.width),l=Math.max(l,0),l=Math.min(l,e.image.height),a=Math.floor(Math.min(a,Math.abs(e.image.width-s))),i=Math.floor(Math.min(i,Math.abs(e.image.height-l)));var u=o((0,b.default)(e.element,s,l,a,i),e.image.minPixelValue,e.image.maxPixelValue),c=P.getConfiguration(),d=p.getViewport(e.element);void 0===c.minWindowWidth&&(c.minWindowWidth=10),d.voi.windowWidth=Math.max(Math.abs(u.max-u.min),c.minWindowWidth),d.voi.windowCenter=u.mean,p.setViewport(e.element,d),t.data=[],p.updateImage(e.element)}}function l(e,t){var n=t.element;$(n).off("CornerstoneToolsMouseMove"),$(n).off("CornerstoneToolsMouseDrag"),$(n).on("CornerstoneToolsMouseMove",d),$(n).on("CornerstoneToolsMouseDrag",d),$(n).on("CornerstoneToolsMouseClick",i),"CornerstoneToolsMouseDrag"===e.type&&$(n).on("CornerstoneToolsMouseUp",i)}function u(e,t){if((0,x.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",t,l),$(t.element).on("CornerstoneToolsMouseMove",t,l),$(t.element).off("CornerstoneToolsMouseDown",u),c(t),!1}function c(e){var t=(0,y.getToolState)(e.element,w);t&&t.data&&(t.data=[]);var n={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,y.addToolState)(e.element,w,n)}function d(e,t){var n=(0,y.getToolState)(t.element,w);if(n&&n.data&&n.data.length){var r={x:t.currentPoints.image.x,y:t.currentPoints.image.y};n.data[0].endPoint=r,p.updateImage(t.element)}}function f(e,t){var n=(0,y.getToolState)(t.element,w);if(n&&n.data&&n.data.length){var r=n.data[0].startPoint,o=n.data[0].endPoint;if(r&&o){var a=$(t.element).find("canvas").get(0).getContext("2d");a.setTransform(1,0,0,1,0,0);var i=v.default.getActiveColor(),s=p.pixelToCanvas(t.element,r),l=p.pixelToCanvas(t.element,o),u=Math.min(s.x,l.x),c=Math.min(s.y,l.y),d=Math.abs(s.x-l.x),f=Math.abs(s.y-l.y),h=g.default.getToolWidth(),m=P.getConfiguration();a.save(),m&&m.shadow&&(a.shadowColor=m.shadowColor||"#000000",a.shadowOffsetX=m.shadowOffsetX||1,a.shadowOffsetY=m.shadowOffsetY||1),a.beginPath(),a.strokeStyle=i,a.lineWidth=h,a.rect(u,c,d,f),a.stroke(),a.restore()}}}function h(e){$(e).off("CornerstoneToolsMouseDown",u),$(e).off("CornerstoneToolsMouseUp",i),$(e).off("CornerstoneToolsMouseClick",i),$(e).off("CornerstoneToolsMouseDrag",d),$(e).off("CornerstoneToolsMouseMove",d),$(e).off("CornerstoneImageRendered",f),$(e).off("CornerstoneNewImage",a),p.updateImage(e)}function m(e){$(e).off("CornerstoneToolsTouchDrag",d),$(e).off("CornerstoneToolsTouchStart",c),$(e).off("CornerstoneToolsDragEnd",s),$(e).off("CornerstoneImageRendered",f)}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),g=r(n(5)),v=r(n(4)),y=n(1),b=r(n(51)),x=r(n(3)),w="wwwcRegion",T={minWindowWidth:10},C=void 0,P={activate:function(e,t){var n={mouseButtonMask:t};if(C=t,!(0,y.getToolState)(e,w)){var r=[];(0,y.addToolState)(e,w,r)}$(e).off("CornerstoneToolsMouseDown",u),$(e).off("CornerstoneToolsMouseUp",i),$(e).off("CornerstoneToolsMouseClick",i),$(e).off("CornerstoneToolsMouseDrag",d),$(e).off("CornerstoneToolsMouseMove",d),$(e).off("CornerstoneImageRendered",f),$(e).off("CornerstoneNewImage",a),$(e).on("CornerstoneToolsMouseDown",n,u),$(e).on("CornerstoneImageRendered",f),$(e).on("CornerstoneNewImage",a),p.updateImage(e)},deactivate:h,disable:h,setConfiguration:function(e){T=e},getConfiguration:function(){return T}},M={activate:function(e){if(!(0,y.getToolState)(e,w)){var t=[];(0,y.addToolState)(e,w,t)}$(e).off("CornerstoneToolsTouchDrag",d),$(e).off("CornerstoneToolsTouchStart",c),$(e).off("CornerstoneToolsDragEnd",s),$(e).off("CornerstoneImageRendered",f),$(e).on("CornerstoneToolsTouchDrag",d),$(e).on("CornerstoneToolsTouchStart",c),$(e).on("CornerstoneToolsDragEnd",s),$(e).on("CornerstoneImageRendered",f)},deactivate:m,disable:m};t.wwwcRegion=P,t.wwwcRegionTouch=M},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=v.getConfiguration(),r=Math.log(e.scale)/Math.log(1.7)+t,o=Math.pow(1.7,r);return n.maxScale&&o>n.maxScale?e.scale=n.maxScale:n.minScale&&o<n.minScale?e.scale=n.minScale:e.scale=o,e}function a(e,t,n){return e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),e.x=Math.min(e.x,t),e.y=Math.min(e.y,n),e}function i(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var n=t.rotation*Math.PI/180,r=Math.cos(n),o=Math.sin(n),a=e.x*r-e.y*o,i=e.x*o+e.y*r;e.x=a,e.y=i}return e}function s(e,t){var n=e.element,r=o(e.viewport,t);c.setViewport(n,r)}function l(e,t){$(t.element).off("CornerstoneToolsMouseDrag",u),$(t.element).off("CornerstoneToolsMouseUp",l),$(t.element).off("CornerstoneToolsMouseClick",l)}function u(e,t){if(!t.deltaPoints.page.y)return!1;var n=t.deltaPoints.page.y/100;return v.strategy(t,n),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),d=r(n(13)),f=r(n(3)),h=r(n(20)),m=r(n(41)),p=r(n(11)),g=void 0,v=(0,d.default)(function(e,t){if((0,f.default)(t.which,e.data.mouseButtonMask))return g=t.startPoints,$(t.element).on("CornerstoneToolsMouseDrag",u),$(t.element).on("CornerstoneToolsMouseUp",l),$(t.element).on("CornerstoneToolsMouseClick",l),!1});v.strategies={default:s,translate:function(e,t){var n=e.element,r=e.image,s=v.getConfiguration(),l=o(e.viewport,t),u={x:0,y:0};if(t<0)l.scale<3&&(Math.abs(l.translation.x)<.01?l.translation.x=0:u.x=l.translation.x/8,Math.abs(l.translation.y)<.01?l.translation.y=0:u.y=l.translation.y/8);else{s&&s.preventZoomOutsideImage&&(g.image=a(g.image,r.width,r.height));var d={x:r.width/2-g.image.x,y:r.height/2-g.image.y};d=i(d,l);var f={x:l.translation.x-d.x,y:l.translation.y-d.y};Math.abs(f.x)<.01?l.translation.x=d.x:u.x=f.x/8,Math.abs(f.y)<.01?l.translation.y=d.y:u.y=f.y/8}l.translation.x-=u.x,l.translation.y-=u.y,c.setViewport(n,l)},zoomToCenter:function(e,t){var n=e.element,r=o(e.viewport,t);c.setViewport(n,r)}},v.strategy=s;var y=(0,h.default)(function(e,t){var n=-t.direction/4,r=v.getConfiguration();r&&r.invert&&(n*=-1);var a=o(t.viewport,n);c.setViewport(t.element,a)}),b=(0,m.default)(function(e,t){var n=v.getConfiguration(),r=t.viewport,o=t.element;r.scale+=t.scaleChange*r.scale,n.maxScale&&r.scale>n.maxScale?r.scale=n.maxScale:n.minScale&&r.scale<n.minScale&&(r.scale=n.minScale),c.setViewport(o,r);var a=c.pageToPixel(o,t.startPoints.page.x,t.startPoints.page.y),s={x:t.startPoints.image.x-a.x,y:t.startPoints.image.y-a.y};s=i(s,r),r.translation.x-=s.x,r.translation.y-=s.y,c.setViewport(o,r)}),x=(0,p.default)(u);t.zoom=v,t.zoomWheel=y,t.zoomTouchPinch=b,t.zoomTouchDrag=x},function(e,t,n){"use strict";function r(e){var t=e.currentTarget,n={event:window.event||e,element:t,viewport:i.getViewport(t),image:i.getEnabledElement(t).image,currentPoints:{page:{x:s,y:l},image:i.pageToPixel(t,s,l)},keyCode:e.keyCode,which:e.which};n.currentPoints.canvas=i.pixelToCanvas(t,n.currentPoints.image);var r={keydown:"CornerstoneToolsKeyDown",keypress:"CornerstoneToolsKeyPress",keyup:"CornerstoneToolsKeyUp"};$(t).trigger(r[e.type],n)}function o(e){s=e.pageX||e.originalEvent.pageX,l=e.pageY||e.originalEvent.pageY}function a(e){$(e).off(u,r),$(e).off("mousemove",o)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=void 0,l=void 0,u="keydown keypress keyup",c={enable:function(e){a(e),$(e).on(u,r),$(e).on("mousemove",o)},disable:a};t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(){p=!1}function i(e){$(e.element).trigger("CornerstoneToolsMouseDownActivate",e)}function s(e){var t=e.currentTarget,n="CornerstoneToolsMouseDoubleClick",r={page:f.point.pageToPoint(e),image:d.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=d.pixelToCanvas(t,r.image);var o=(0,h.default)(r),a={event:e,which:e.which,viewport:d.getViewport(t),image:d.getEnabledElement(t).image,element:t,startPoints:r,lastPoints:o,currentPoints:r,deltaPoints:{x:0,y:0},type:n},i=$.Event(n,a);$(a.element).trigger(i,a)}function l(e){function t(e){var t={page:f.point.pageToPoint(e),image:d.pageToPixel(r,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};t.canvas=d.pixelToCanvas(r,t.image);var n={page:f.point.subtract(t.page,s.page),image:f.point.subtract(t.image,s.image),client:f.point.subtract(t.client,s.client),canvas:f.point.subtract(t.canvas,s.canvas)},a={which:y,viewport:d.getViewport(r),image:d.getEnabledElement(r).image,element:r,startPoints:o,lastPoints:s,currentPoints:t,deltaPoints:n,type:"CornerstoneToolsMouseDrag"};return $(a.element).trigger("CornerstoneToolsMouseDrag",a),s=(0,h.default)(t),(0,m.default)(e)}function n(e){clearTimeout(g);var a="CornerstoneToolsMouseUp";p&&(a="CornerstoneToolsMouseClick");var i={page:f.point.pageToPoint(e),image:d.pageToPixel(r,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};i.canvas=d.pixelToCanvas(r,i.image);var l={page:f.point.subtract(i.page,s.page),image:f.point.subtract(i.image,s.image),client:f.point.subtract(i.client,s.client),canvas:f.point.subtract(i.canvas,s.canvas)},c={event:e,which:y,viewport:d.getViewport(r),image:d.getEnabledElement(r).image,element:r,startPoints:o,lastPoints:s,currentPoints:i,deltaPoints:l,type:a},h=$.Event(a,c);$(c.element).trigger(h,c),$(document).off("mousemove",t),$(document).off("mouseup",n),$(c.element).on("mousemove",u),p=!0}g=setTimeout(a,v);var r=e.currentTarget;$(r).off("mousemove",u);var o={page:f.point.pageToPoint(e),image:d.pageToPixel(r,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};o.canvas=d.pixelToCanvas(r,o.image);var s=(0,h.default)(o),l={event:e,which:e.which,viewport:d.getViewport(r),image:d.getEnabledElement(r).image,element:r,startPoints:o,lastPoints:s,currentPoints:o,deltaPoints:{x:0,y:0},type:"CornerstoneToolsMouseDown"},c=$.Event("CornerstoneToolsMouseDown",l);if($(l.element).trigger(c,l),!1===c.isImmediatePropagationStopped()&&!0===i(l))return(0,m.default)(e);var y=e.which;return $(document).on("mousemove",t),$(document).on("mouseup",n),(0,m.default)(e)}function u(e){var t=e.currentTarget,n={page:f.point.pageToPoint(e),image:d.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};n.canvas=d.pixelToCanvas(t,n.image);var r=(0,h.default)(n),o=e.which,a={page:f.point.pageToPoint(e),image:d.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};a.canvas=d.pixelToCanvas(t,a.image);var i={page:f.point.subtract(a.page,r.page),image:f.point.subtract(a.image,r.image),client:f.point.subtract(a.client,r.client),canvas:f.point.subtract(a.canvas,r.canvas)},s={which:o,viewport:d.getViewport(t),image:d.getEnabledElement(t).image,element:t,startPoints:n,lastPoints:r,currentPoints:a,deltaPoints:i,type:"CornerstoneToolsMouseMove"};$(t).trigger("CornerstoneToolsMouseMove",s),r=(0,h.default)(a)}function c(e){$(e).off("mousedown",l),$(e).off("mousemove",u),$(e).off("dblclick",s)}Object.defineProperty(t,"__esModule",{value:!0});var d=o(n(0)),f=o(n(2)),h=r(n(31)),m=r(n(33)),p=!0,g=void 0,v=200,y={enable:function(e){c(e),$(e).on("mousedown",l),$(e).on("mousemove",u),$(e).on("dblclick",s)},disable:c};t.default=y},function(e,t,n){"use strict";function r(e){if(!("mousewheel"===e.originalEvent.type&&0===e.originalEvent.wheelDeltaY||"DOMMouseScroll"===e.originalEvent.type&&1===e.originalEvent.axis)){e.preventDefault();var t=e.currentTarget,n=void 0,r=void 0;void 0!==e.pageX&&void 0!==e.pageY?(n=e.pageX,r=e.pageY):e.originalEvent&&void 0!==e.originalEvent.pageX&&void 0!==e.originalEvent.pageY?(n=e.originalEvent.pageX,r=e.originalEvent.pageY):(n=e.x,r=e.y);var o=a.pageToPixel(t,n,r),i=void 0,s=(i=(e=window.event||e).originalEvent&&e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:e.originalEvent&&e.originalEvent.deltaY?-e.originalEvent.deltaY:e.originalEvent&&e.originalEvent.detail?-e.originalEvent.detail:e.wheelDelta)<0?-1:1,l={element:t,viewport:a.getViewport(t),image:a.getEnabledElement(t).image,direction:s,pageX:n,pageY:r,imageX:o.x,imageY:o.y};$(t).trigger("CornerstoneToolsMouseWheel",l)}}function o(e){$(e).unbind(i,r)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i="mousewheel DOMMouseScroll",s={enable:function(e){o(e),$(e).on(i,r)},disable:o};t.default=s},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=e.currentTarget||e.srcEvent.currentTarget,n=void 0,r=void 0,o=void 0,a=void 0,i=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>1)&&(P=!1,clearTimeout(b)),e.type){case"tap":P=!1,clearTimeout(b),(m={page:u.point.pageToPoint(e.pointers[0]),image:l.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=l.pixelToCanvas(t,m.image),r="CornerstoneToolsTap",v={event:e,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,currentPoints:m,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v);break;case"doubletap":P=!1,clearTimeout(b),(m={page:u.point.pageToPoint(e.pointers[0]),image:l.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=l.pixelToCanvas(t,m.image),r="CornerstoneToolsDoubleTap",v={event:e,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,currentPoints:m,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v);break;case"pinchstart":P=!1,clearTimeout(b),w=1;break;case"pinchmove":if(P=!1,clearTimeout(b),!0===C){w=e.scale,C=!1;break}o=(e.scale-w)/w,(h={page:e.center,image:l.pageToPixel(t,e.center.x,e.center.y)}).canvas=l.pixelToCanvas(t,h.image),r="CornerstoneToolsTouchPinch",v={event:e,startPoints:h,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,direction:e.scale<1?1:-1,scaleChange:o,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v),w=e.scale;break;case"touchstart":w=1,clearTimeout(b),clearTimeout(y),y=setTimeout(function(){(h={page:u.point.pageToPoint(e.originalEvent.touches[0]),image:l.pageToPixel(t,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}}).canvas=l.pixelToCanvas(t,h.image),r="CornerstoneToolsTouchStart",e.originalEvent.touches.length>1&&(r="CornerstoneToolsMultiTouchStart"),v={event:e,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,startPoints:h,currentPoints:h,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v),!1===n.isImmediatePropagationStopped()&&(r="CornerstoneToolsTouchStartActive",e.originalEvent.touches.length>1&&(r="CornerstoneToolsMultiTouchStartActive"),v.type=r,$(t).trigger(r,v)),p=(0,c.default)(h)},50),P=!0,x=0,b=setTimeout(function(){P&&((m={page:u.point.pageToPoint(e.originalEvent.touches[0]),image:l.pageToPixel(t,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}}).canvas=l.pixelToCanvas(t,h.image),r="CornerstoneToolsTouchPress",v={event:e,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,currentPoints:m,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v))},S);break;case"touchend":w=1,P=!1,clearTimeout(b),setTimeout(function(){(h={page:u.point.pageToPoint(e.originalEvent.changedTouches[0]),image:l.pageToPixel(t,e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY),client:{x:e.originalEvent.changedTouches[0].clientX,y:e.originalEvent.changedTouches[0].clientY}}).canvas=l.pixelToCanvas(t,h.image),r="CornerstoneToolsTouchEnd",v={event:e,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,startPoints:h,currentPoints:h,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v)},50);break;case"panmove":a={x:e.deltaX-M.x,y:e.deltaY-M.y},M={x:e.deltaX,y:e.deltaY},(m={page:{x:p.page.x+a.x,y:p.page.y+a.y},image:l.pageToPixel(t,p.page.x+a.x,p.page.y+a.y),client:{x:p.client.x+a.x,y:p.client.y+a.y}}).canvas=l.pixelToCanvas(t,m.image),g={page:u.point.subtract(m.page,p.page),image:u.point.subtract(m.image,p.image),client:u.point.subtract(m.client,p.client),canvas:u.point.subtract(m.canvas,p.canvas)},(x+=Math.sqrt(g.page.x*g.page.x+g.page.y*g.page.y))>I&&(P=!1,clearTimeout(b)),r="CornerstoneToolsTouchDrag",e.pointers.length>1&&(r="CornerstoneToolsMultiTouchDrag"),v={viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,startPoints:h,lastPoints:p,currentPoints:m,deltaPoints:g,numPointers:e.pointers.length,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v),p=(0,c.default)(m);break;case"panstart":M={x:e.deltaX,y:e.deltaY},(m={page:u.point.pageToPoint(e.pointers[0]),image:l.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=l.pixelToCanvas(t,m.image),p=(0,c.default)(m);break;case"panend":return P=!1,clearTimeout(b),p?(m={page:u.point.pageToPoint(e.pointers[0]),image:l.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},m.canvas=l.pixelToCanvas(t,m.image),g={page:u.point.subtract(m.page,p.page),image:u.point.subtract(m.image,p.image),client:u.point.subtract(m.client,p.client),canvas:u.point.subtract(m.canvas,p.canvas)},r="CornerstoneToolsDragEnd",v={event:e.srcEvent,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,startPoints:h,lastPoints:p,currentPoints:m,deltaPoints:g,type:r,isTouchEvent:!0},n=$.Event(r,v),$(t).trigger(n,v),2===e.pointers.length-e.changedPointers.length&&(C=!0),(0,d.default)(e)):!1;case"rotatemove":P=!1,clearTimeout(b),i=e.rotation-T,T=e.rotation,r="CornerstoneToolsTouchRotate",v={event:e.srcEvent,viewport:l.getViewport(t),image:l.getEnabledElement(t).image,element:t,rotation:i,type:r},n=$.Event(r,v),$(t).trigger(n,v)}return!1}function i(e){f.default.disable(e),$(e).off("touchstart touchend",a);var t=$(e).data("hammer");t&&t.off("tap doubletap panstart panmove panend pinchmove rotatemove",a)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(116)),l=r(n(0)),u=r(n(2)),c=o(n(31)),d=o(n(33)),f=o(n(42)),h=void 0,m=void 0,p=void 0,g=void 0,v=void 0,y=void 0,b=void 0,x=void 0,w=1,T=0,C=!1,P=!1,M=void 0,S=700,I=5,D={enable:function(e){i(e);var t={inputClass:s.default.SUPPORT_POINTER_EVENTS?s.default.PointerEventInput:s.default.TouchInput},n=new s.default.Manager(e,t),r={pointers:0,direction:s.default.DIRECTION_ALL,threshold:0},o=new s.default.Pan(r),l=new s.default.Pinch({threshold:0}),u=new s.default.Rotate({threshold:0});l.recognizeWith(o),l.recognizeWith(u),u.recognizeWith(o);var c=new s.default.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});c.recognizeWith(o),n.add([c,o,u,l]),n.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",a),f.default.enable(e),$(e).on("touchstart touchend",a),$(e).data("hammer",n)},disable:i};t.default=D},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)).metaData;t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=w.getConfiguration(),n=h.getEnabledElement(e.element),r=n.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),a(r,e.currentPoints.canvas,t.radius*n.viewport.scale,t.dragColor),v.push({x:Math.round(e.currentPoints.image.x),y:Math.round(e.currentPoints.image.y)}),y=e.currentPoints.canvas}function a(e,t,n,r){e.save(),e.beginPath(),e.arc(t.x,t.y,n,0,2*Math.PI,!0),e.strokeStyle=r,e.fillStyle=r,e.stroke(),e.fill(),e.restore()}function i(e,t,n){e.save(),e.beginPath(),e.arc(t.x,t.y,n,0,2*Math.PI,!0),e.clip(),e.clearRect(t.x-n-1,t.y-n-1,2*n+2,2*n+2),e.restore()}function s(e,t){y=t.currentPoints.canvas,h.updateImage(t.element)}function l(e,t){y=t.currentPoints.canvas,h.updateImage(t.element,!0),$(t.element).off("CornerstoneToolsMouseDrag",s),$(t.element).off("CornerstoneToolsMouseDrag",u),$(t.element).off("CornerstoneToolsMouseUp",l),$(t.element).off("CornerstoneToolsMouseClick",l)}function u(e,t){return w.strategy(t),!1}function c(e,t){if((0,p.default)(t.which,e.data.mouseButtonMask))return $(t.element).on("CornerstoneToolsMouseDrag",u),$(t.element).on("CornerstoneToolsMouseUp",l),$(t.element).on("CornerstoneToolsMouseClick",l),w.strategy(t),!1;$(t.element).on("CornerstoneToolsMouseDrag",s),$(t.element).on("CornerstoneToolsMouseUp",l)}function d(e,t){var n=w.getConfiguration(),r=h.getEnabledElement(t.element),o=r.canvas.getContext("2d");if(o.setTransform(1,0,0,1,0,0),y){var i=n.radius*r.viewport.scale;a(o,y,i,n.hoverColor)}}function f(){var e=w.getConfiguration(),t=b.getContext("2d");1===e.draw?v.forEach(function(n){a(t,n,e.radius,e.overlayColor)}):v.forEach(function(n){i(t,n,e.radius)}),v=[];var n=this.width,r=this.height;return t.getImageData(0,0,n,r).data}Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),m=r(n(7)),p=r(n(3)),g={draw:1,radius:10,hoverColor:"green",dragColor:"yellow",overlayColor:"red"},v=[],y=void 0,b=document.createElement("canvas"),x=void 0,w=(0,m.default)({mouseMoveCallback:s,mouseDownActivateCallback:c,onImageRendered:d});w.activate=function(e,t){$(e).off("CornerstoneImageRendered",d),$(e).on("CornerstoneImageRendered",d);var n={mouseButtonMask:t};$(e).off("CornerstoneToolsMouseDownActivate",c),$(e).on("CornerstoneToolsMouseDownActivate",n,c),$(e).off("CornerstoneToolsMouseMove",s),$(e).on("CornerstoneToolsMouseMove",s);var r=h.getEnabledElement(e);b.width=r.canvas.width,b.height=r.canvas.height;var o=b.getContext("2d");o.fillStyle="rgba(0,0,0,0)",o.fillRect(0,0,b.width,b.height);var a={minPixelValue:0,maxPixelValue:255,slope:1,intercept:0,windowCenter:127,windowWidth:256,getPixelData:f,rgba:!0,rows:r.image.height,columns:r.image.width,height:r.image.height,width:r.image.width,color:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:r.image.width*r.image.height*4},i=void 0;x&&(i=h.getLayer(e,x)),i||(x=h.addLayer(e,a)),h.updateImage(e)},w.setConfiguration(g),w.strategies={default:o},w.strategy=o,t.brush=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(54)),a=r(n(114)),i=r(n(55)),s={calculateReferenceLine:o.default,tool:a.default,renderActiveReferenceLine:i.default};t.default=s},function(e,t,n){"use strict";function r(e,t){var n=void 0,r=void 0,o=void 0,a=0,i=e.length,s=[];for(s.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),n=1;n<i;n++)o=Number(e[n])/t|0,s.push(o),1===n?r=o:o!==r&&(s.isTimeVarying=!0),a+=o;return s.length>0&&(o=s.isTimeVarying?a/s.length|0:s[0],s.push(o)),s}function o(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function a(e){var t={element:e},n=$.Event("CornerstoneToolsClipStopped",t);$(e).trigger(n,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=function(e){return e&&e.__esModule?e:{default:e}}(n(10)),l=n(1),u="playClip";t.playClip=function(e,t){var n=void 0,c=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var d=(0,l.getToolState)(e,"stack");if(d&&d.data&&d.data.length){var f=d.data[0],h=(0,l.getToolState)(e,u);h&&h.data&&h.data.length?o(n=h.data[0]):(n={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,l.addToolState)(e,u,n)),(t<0||t>0)&&(n.framesPerSecond=Number(t),n.reverse=n.framesPerSecond<0,n.ignoreFrameTimeVector=!0),!0!==n.ignoreFrameTimeVector&&n.frameTimeVector&&n.frameTimeVector.length===f.imageIds.length&&(c=r(n.frameTimeVector,n.speed));var m=function(){var t=void 0,r=void 0,l=void 0,u=void 0,c=f.currentImageIdIndex,d=f.imageIds.length;if(n.reverse?c--:c++,!n.loop&&(c<0||c>=d))return o(n),void a(e);c>=d&&(c=0),c<0&&(c=d-1),c!==f.currentImageIdIndex&&(r=s.default.getStartLoadHandler(),l=s.default.getEndLoadHandler(),u=s.default.getErrorLoadingHandler(),r&&r(e),t=i.getViewport(e),(!0===f.preventCache?i.loadImage(f.imageIds[c]):i.loadAndCacheImage(f.imageIds[c])).then(function(n){f.currentImageIdIndex=c,i.displayImage(e,n,t),l&&l(e,n)},function(t){var n=f.imageIds[c];u&&u(e,n,t)}))};c&&c.length>0&&c.isTimeVarying?(n.usingFrameTimeVector=!0,n.intervalId=setTimeout(function e(){n.intervalId=setTimeout(e,c[f.currentImageIdIndex]),m()},0)):(n.usingFrameTimeVector=!1,n.intervalId=setInterval(m,1e3/Math.abs(n.framesPerSecond)))}},t.stopClip=function(e){var t=(0,l.getToolState)(e,u);t&&t.data&&t.data.length&&o(t.data[0])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(19)),o=n(1),a=6,i={backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"},s=(0,r.default)(function(e,t){var n=t.element,r=t.enabledElement.canvas.width,i=t.enabledElement.canvas.height;if(!r||!i)return!1;var l=t.enabledElement.canvas.getContext("2d");l.setTransform(1,0,0,1,0,0),l.save();var u=s.getConfiguration();l.fillStyle=u.backgroundColor,"horizontal"===u.orientation?l.fillRect(0,i-a,r,a):l.fillRect(0,0,a,i);var c=(0,o.getToolState)(n,"stack");if(c&&c.data&&c.data.length){var d=c.data[0].imageIds,f=c.data[0].currentImageIdIndex,h=r/d.length,m=i/d.length,p=h*f,g=m*f;l.fillStyle=u.fillColor,"horizontal"===u.orientation?l.fillRect(p,i-a,h,a):l.fillRect(0,g,a,m),l.restore()}});s.setConfiguration(i),t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){e=Math.round(e)||0;var n=[],r=(t=Math.round(t)||0)-e+1;if(r<=0)return n;for(;r--;)n[r]=t--;return n}function a(e,t){var n=[],r=[];return e.forEach(function(e){e<t?n.push(e):e>t&&r.push(e)}),{low:e.indexOf(b(n)),high:e.indexOf(x(r))}}function i(e){function t(e){var t=l.indicesToRequest.indexOf(e);t>-1&&l.indicesToRequest.splice(t,1)}function n(e){t(i.imageIds.indexOf(e.imageId))}function r(t){console.log("prefetch errored: "+t),y&&y(e,g,t,"stackPrefetch")}var o=(0,f.getToolState)(e,"stack");if(o&&o.data&&o.data.length){var i=o.data[0],s=(0,f.getToolState)(e,m);if(s){var l=s.data[0]||{};if(l.indicesToRequest&&l.indicesToRequest.length||(l.enabled=!1),!1!==l.enabled&&(s.data[0].indicesToRequest.sort(function(e,t){return e-t}),l.indicesToRequest.slice().forEach(function(e){var n=i.imageIds[e];if(n){var r=u.imageCache.getImagePromise(n);r&&"resolved"===r.state()&&t(e)}}),l.indicesToRequest.length)){c.default.clearRequestStack(p);for(var h=a(l.indicesToRequest,i.currentImageIdIndex),g=void 0,v=void 0,y=d.default.getErrorLoadingHandler(),b=h.low,x=h.high;b>0||x<l.indicesToRequest.length;)b>=0&&(v=l.indicesToRequest[b--],g=i.imageIds[v],c.default.addRequest(e,g,p,!1,n,r)),x<l.indicesToRequest.length&&(v=l.indicesToRequest[x++],g=i.imageIds[v],c.default.addRequest(e,g,p,!1,n,r));c.default.startGrabbing()}}}}function s(e,t){var n=e.data.element,r=void 0;try{r=(0,f.getToolState)(n,"stack")}catch(e){return}if(r&&r.data&&r.data.length){var o=r.data[0].imageIds.indexOf(t.imageId);if(!(o<0)){var a=(0,f.getToolState)(n,m);a&&a.data&&a.data.length&&a.data[0].indicesToRequest.push(o)}}}function l(e){clearTimeout(v),v=setTimeout(function(){var t=e.target;try{i(t)}catch(e){return}},y)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),c=r(n(28)),d=r(n(10)),f=n(1),h=n(24),m="stackPrefetch",p="prefetch",g={},v=void 0,y=300,b=function(e){return Math.max.apply(null,e)},x=function(e){return Math.min.apply(null,e)},w={enable:function(e){(0,f.getToolState)(e,m).data=[];var t=(0,f.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];if(!0!==n.preventCache){var r={indicesToRequest:o(0,n.imageIds.length-1),enabled:!0,direction:1},a=r.indicesToRequest.indexOf(n.currentImageIdIndex);r.indicesToRequest.splice(a,1),(0,f.addToolState)(e,m,r),i(e),$(e).off("CornerstoneNewImage",l),$(e).on("CornerstoneNewImage",l),$(u.events).off("CornerstoneImageCachePromiseRemoved",s),$(u.events).on("CornerstoneImageCachePromiseRemoved",{element:e},s)}else console.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(e){clearTimeout(v),$(e).off("CornerstoneNewImage",l),$(u.events).off("CornerstoneImageCachePromiseRemoved",s);var t=(0,f.getToolState)(e,m);t&&t.data.length&&(t.data[0].enabled=!1,c.default.clearRequestStack(p))},getConfiguration:function(){return g},setConfiguration:function(e){g=e,e.maxSimultaneousRequests&&(0,h.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}};t.default=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(115)),o={};o.FusionRenderer=r.default,t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(37)),a={UP:38,DOWN:40},i=(0,r(n(39)).default)(function(e,t){var n=t.keyCode;if(n===a.UP||n===a.DOWN){var r=1;n===a.DOWN&&(r=-1),(0,o.default)(t.element,r)}});t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(16),a=n(1),i={save:function(e){var t={imageIdToolState:o.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var n=(0,a.getElementToolStateManager)(e);n!==o.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=n.saveToolState(),t.elementViewport[e.id]=r.getViewport(e))}),t},restore:function(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport"))return o.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(t){var n=document.getElementById(t);if(n&&e.elementToolState.hasOwnProperty(t)){var i=(0,a.getElementToolStateManager)(n);if(i!==o.globalImageIdSpecificToolStateManager){i.restoreToolState(e.elementToolState[t]);var s=e.elementViewport[t];r.setViewport(n,s),r.updateImage(n)}}}),e}};t.default=i},function(e,t,n){"use strict";function r(){var e={};return{get:function(t,n){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(n))return r[n]}},add:function(t,n,r){!1===e.hasOwnProperty(t)&&(e[t]={});var o=e[t];!1===o.hasOwnProperty(n)&&(o[n]={data:[]}),o[n].data.push(r)},remove:function(t,n,r){if(!1!==e.hasOwnProperty(t)){var o=e[t];if(!1!==o.hasOwnProperty(n)){for(var a=o[n],i=-1,s=0;s<a.data.length;s++)a.data[s]===r&&(i=s);-1!==i&&a.data.splice(i,1)}}}}}Object.defineProperty(t,"__esModule",{value:!0});var o=r();t.newFrameOfReferenceSpecificToolStateManager=r,t.globalFrameOfReferenceSpecificToolStateManager=o},function(e,t,n){"use strict";function r(e,t){var n={};return{get:function(r,o){return e.indexOf(o)>=0?(!1===n.hasOwnProperty(o)&&(n[o]={data:[]}),n[o]):t.get(r,o)},add:function(r,o,a){if(!(e.indexOf(o)>=0))return t.add(r,o,a);!1===n.hasOwnProperty(o)&&(n[o]={data:[]}),n[o].data.push(a)},saveToolState:function(){return n},restoreToolState:function(e){n=e},toolState:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=void 0;var o=n(16),a=n(1),i=[];t.newStackSpecificToolStateManager=r,t.addStackStateManager=function(e,t){var n=(0,a.getElementToolStateManager)(e);n||(n=o.globalImageIdSpecificToolStateManager);var s=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(s=s.concat(t));var l=r(s,n);i.push(l),(0,a.setElementToolStateManager)(e,l)}},function(e,t,n){"use strict";function r(e,t){var n={};return{get:function(r,o){return e.indexOf(o)>=0?(!1===n.hasOwnProperty(o)&&(n[o]={data:[]}),n[o]):t.get(r,o)},add:function(r,o,a){if(!(e.indexOf(o)>=0))return t.add(r,o,a);!1===n.hasOwnProperty(o)&&(n[o]={data:[]}),n[o].data.push(a)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var o=n(16),a=n(1),i=[];t.addTimeSeriesStateManager=function(e,t){t=t||["timeSeries"];var n=(0,a.getElementToolStateManager)(e);void 0===n&&(n=o.globalImageIdSpecificToolStateManager);var s=r(t,n);i.push(s),(0,a.setElementToolStateManager)(e,s)},t.newTimeSeriesSpecificToolStateManager=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.default=function(e,t){function n(e,t){s.length&&l.length&&(u=!0,l.forEach(function(n){var r=l.indexOf(n);if(-1!==r){var o=c.imageIds.targetElements[r],a=s.indexOf(e);if(-1!==a){var u=c.imageIds.sourceElements[a],f=void 0;f=u===o?0:c.distances[u][o],d(i,e,n,t,f)}}}),u=!1)}function o(e,t){!0!==u&&n(e.currentTarget,t)}function a(e,t){var n=t.element;i.remove(n)}var i=this,s=[],l=[],u=!1,c={},d=t;this.setHandler=function(e){d=e},this.getHandler=function(){return d},this.getDistances=function(){s.length&&l.length&&(c.distances={},c.imageIds={sourceElements:[],targetElements:[]},s.forEach(function(e){var t=r.getEnabledElement(e);if(t&&t.image){var n=t.image.imageId,o=r.metaData.get("imagePlane",n);if(o&&o.imagePositionPatient){var a=o.imagePositionPatient;c.hasOwnProperty(t)||(c.distances[n]={},c.imageIds.sourceElements.push(n),l.forEach(function(t){var o=r.getEnabledElement(t);if(o&&o.image){var i=o.image.imageId;if(c.imageIds.targetElements.push(i),e!==t&&n!==i&&!c.distances[n].hasOwnProperty(i)){var s=r.metaData.get("imagePlane",i);if(s&&s.imagePositionPatient){var l=s.imagePositionPatient;c.distances[n][i]=l.clone().sub(a)}}}}),Object.keys(c.distances[n]).length||delete c.distances[n])}}}))},this.addSource=function(t){-1===s.indexOf(t)&&(s.push(t),$(t).on(e,o),i.getDistances(),i.updateDisableHandlers())},this.addTarget=function(e){-1===l.indexOf(e)&&(l.push(e),i.getDistances(),d(i,e,e,0),i.updateDisableHandlers())},this.add=function(e){i.addSource(e),i.addTarget(e)},this.removeSource=function(t){var r=s.indexOf(t);-1!==r&&(s.splice(r,1),$(t).off(e,o),i.getDistances(),n(t),i.updateDisableHandlers())},this.removeTarget=function(e){var t=l.indexOf(e);-1!==t&&(l.splice(t,1),i.getDistances(),d(i,e,e,0),i.updateDisableHandlers())},this.remove=function(e){i.removeTarget(e),i.removeSource(e)},this.getSourceElements=function(){return s},this.getTargetElements=function(){return l},this.displayImage=function(e,t,n){u=!0,r.displayImage(e,t,n),u=!1},this.setViewport=function(e,t){u=!0,r.setViewport(e,t),u=!1},this.updateDisableHandlers=function(){$.unique(s.concat(l)).forEach(function(e){$(e).off("CornerstoneElementDisabled",a),$(e).on("CornerstoneElementDisabled",a)})},this.destroy=function(){$.unique(s.concat(l)).forEach(function(e){i.remove(e)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var o=r.getViewport(t),a=r.getViewport(n);a.scale===o.scale&&a.translation.x===o.translation.x&&a.translation.y===o.translation.y||(a.scale=o.scale,a.translation.x=o.translation.x,a.translation.y=o.translation.y,e.setViewport(n,a))}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var i=(0,o.getToolState)(t,"stack").data[0],s=(0,o.getToolState)(n,"stack").data[0],l=i.currentImageIdIndex;if((l=Math.min(Math.max(l,0),s.imageIds.length-1))!==s.currentImageIdIndex){var u=a.default.getStartLoadHandler(),c=a.default.getEndLoadHandler(),d=a.default.getErrorLoadingHandler();u&&u(n);(!0===s.preventCache?r.loadImage(s.imageIds[l]):r.loadAndCacheImage(s.imageIds[l])).then(function(t){var o=r.getViewport(n);s.currentImageIdIndex=l,e.displayImage(n,t,o),c&&c(n,t)},function(e){var t=s.imageIds[l];d&&d(n,t,e)})}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,s){if(n!==t){var l=r.getEnabledElement(t),u=r.metaData.get("imagePlane",l.image.imageId).imagePositionPatient,c=(0,o.getToolState)(n,"stack").data[0],d=Number.MAX_VALUE,f=-1;if(s){var h=u.clone().add(s);if(c.imageIds.forEach(function(e,t){var n=r.metaData.get("imagePlane",e).imagePositionPatient,o=h.distanceToSquared(n);o<d&&(d=o,f=t)}),f!==c.currentImageIdIndex&&-1!==f){var m=a.default.getStartLoadHandler(),p=a.default.getEndLoadHandler(),g=a.default.getErrorLoadingHandler();m&&m(n);(!0===c.preventCache?r.loadImage(c.imageIds[f]):r.loadAndCacheImage(c.imageIds[f])).then(function(t){var o=r.getViewport(n);c.currentImageIdIndex=f,e.displayImage(n,t,o),p&&p(n,t)},function(e){var t=c.imageIds[f];g&&g(n,t,e)})}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var i=r.getEnabledElement(t).image,s=r.metaData.get("imagePlane",i.imageId).imagePositionPatient,l=(0,o.getToolState)(n,"stack").data[0],u=Number.MAX_VALUE,c=-1;if($.each(l.imageIds,function(e,t){var n=r.metaData.get("imagePlane",t).imagePositionPatient.distanceToSquared(s);n<u&&(u=n,c=e)}),c!==l.currentImageIdIndex){var d=a.default.getStartLoadHandler(),f=a.default.getEndLoadHandler(),h=a.default.getErrorLoadingHandler();if(d&&d(n),-1!==c){(!0===l.preventCache?r.loadImage(l.imageIds[c]):r.loadAndCacheImage(l.imageIds[c])).then(function(t){var o=r.getViewport(n);l.currentImageIdIndex=c,e.displayImage(n,t,o),f&&f(n,t)},function(e){var t=l.imageIds[c];h&&h(n,t,e)})}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){if(t!==n&&i&&i.direction){var s=(0,o.getToolState)(n,"stack").data[0],l=s.currentImageIdIndex+i.direction;if(l=Math.min(Math.max(l,0),s.imageIds.length-1),s.currentImageIdIndex!==l){var u=a.default.getStartLoadHandler(),c=a.default.getEndLoadHandler(),d=a.default.getErrorLoadingHandler();u&&u(n);(!0===s.preventCache?r.loadImage(s.imageIds[l]):r.loadAndCacheImage(s.imageIds[l])).then(function(t){var o=r.getViewport(n);s.currentImageIdIndex=l,e.displayImage(n,t,o),c&&c(n,t)},function(e){var t=s.imageIds[l];d&&d(n,t,e)})}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n!==t&&r.updateImage(n)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n!==t){var o=r.getViewport(t),a=r.getViewport(n);a.voi.windowWidth===o.voi.windowWidth&&a.voi.windowCenter===o.voi.windowCenter&&a.invert===o.invert||(a.voi.windowWidth=o.voi.windowWidth,a.voi.windowCenter=o.voi.windowCenter,a.invert=o.invert,e.setViewport(n,a))}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=[];e.timeSeries.stacks.forEach(function(n){(!0===n.preventCache?a.loadImage(n.imageIds[e.imageIdIndex]):a.loadAndCacheImage(n.imageIds[e.imageIdIndex])).then(function(n){var r=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*n.width,o=n.getPixelData()[r];t.push(o)})}),e.lineSample.set(t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=r(n(7)),s=r(n(8)),l=r(n(53)),u=n(1),c=r(n(111)),d=r(n(110)),f="probe4D",h=(0,i.default)({createNewMeasurement:function(e){var t=(0,u.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var n=t.data[0],r={timeSeries:n,lineSample:new d.default,imageIdIndex:n.stacks[n.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return o(r),c.default.add(r),r}},onImageRendered:function(e,t){var n=(0,u.getToolState)(e.currentTarget,f);if(n){var r=t.canvasContext.canvas.getContext("2d");a.setToPixelCoordinateSystem(t.enabledElement,r);for(var o=0;o<n.data.length;o++){r.save();var i=n.data[o];r.beginPath(),(0,s.default)(r,t,i.handles,"white"),r.stroke();var c=(0,l.default)(t.enabledElement,t.canvasContext,15);r.font=c.fontSize+"px Arial";var d=Math.round(i.handles.end.x),h=Math.round(i.handles.end.y),m=i.handles.end.x+3,p=i.handles.end.y-3;r.fillStyle="white",r.fillText(d+","+h,m,p),r.restore()}}},toolType:f});t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n(30)),a="timeSeriesPlayer",i={start:function(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var n=(0,r.getToolState)(e,"timeSeries");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){var i=(0,r.getToolState)(e,a),s=void 0;void 0===i||0===i.data.length?(s={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,r.addToolState)(e,a,s)):(s=i.data[0]).framesPerSecond=t,void 0===s.intervalId&&(s.intervalId=setInterval(function(){s.framesPerSecond>0?(0,o.default)(e,1,!0):(0,o.default)(e,-1,!0)},1e3/Math.abs(s.framesPerSecond)))}},stop:function(e){var t=(0,r.getToolState)(e,a);if(t&&t.data&&t.data.length){var n=t.data[0];clearInterval(n.intervalId),n.intervalId=void 0}}};t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){$(t.element).off("CornerstoneToolsMouseDrag",a),$(t.element).off("CornerstoneToolsMouseUp",o),$(t.element).off("CornerstoneToolsMouseClick",o)}function a(e,t){e.data.deltaY+=t.deltaPoints.page.y;var n=(0,d.getToolState)(t.element,"timeSeries");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){var r=n.data[0],o=$(t.element).height()/r.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(o=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=o||e.data.deltaY<=-o){var a=Math.round(e.data.deltaY/o),i=e.data.deltaY%o;(0,u.default)(t.element,a),e.data.deltaY=i}return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var i=r(n(13)),s=r(n(11)),l=r(n(20)),u=r(n(30)),c=r(n(3)),d=n(1),f=(0,i.default)(function(e,t){if((0,c.default)(t.which,e.data.mouseButtonMask)){var n={deltaY:0,options:e.data.options};return $(t.element).on("CornerstoneToolsMouseDrag",n,a),$(t.element).on("CornerstoneToolsMouseUp",o),$(t.element).on("CornerstoneToolsMouseClick",o),e.stopImmediatePropagation(),!1}}),h=(0,l.default)(function(e,t){var n=-t.direction;(0,u.default)(t.element,n)}),m=(0,s.default)(function(e){var t=e.originalEvent.detail,n={deltaY:0};n.deltaY+=t.deltaPoints.page.y;var r=(0,d.getToolState)(t.element,"stack");if(void 0!==r&&void 0!==r.data&&0!==r.data.length){if(n.deltaY>=3||n.deltaY<=-3){var o=n.deltaY/3,a=n.deltaY%3;(0,u.default)(n.element,o),n.deltaY=a}return!1}});t.timeSeriesScroll=f,t.timeSeriesScrollWheel=h,t.timeSeriesScrollTouchDrag=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="0.9.0"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(85);Object.defineProperty(t,"metaData",{enumerable:!0,get:function(){return r(o).default}});var a=n(87);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return r(a).default}});var i=n(45);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return r(i).default}});var s=n(28);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return r(s).default}});var l=n(53);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return r(l).default}});var u=n(52);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return r(u).default}});var c=n(37);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return r(c).default}});var d=n(36);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return r(d).default}});var f=n(35);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return f.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return f.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return f.planePlaneIntersection}});var h=n(18);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return r(h).default}});var m=n(34);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return r(m).default}});var p=n(33);Object.defineProperty(t,"pauseEvent",{enumerable:!0,get:function(){return r(p).default}});var g=n(3);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return r(g).default}});var v=n(32);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return r(v).default}});var y=n(24);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return y.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return y.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return y.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return y.isMobileDevice}});var b=n(51);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return r(b).default}});var x=n(6);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return r(x).default}});var w=n(50);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return r(w).default}});var T=n(49);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return r(T).default}});var C=n(48);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return r(C).default}});var P=n(31);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return r(P).default}});var M=n(17);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return r(M).default}});var S=n(47);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return r(S).default}});var I=n(105);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return r(I).default}});var D=n(30);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return r(D).default}});var E=n(106);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return r(E).default}});var O=n(107);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return O.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return O.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return O.timeSeriesScrollTouchDrag}});var _=n(104);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return r(_).default}});var k=n(103);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return r(k).default}});var A=n(97);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return r(A).default}});var j=n(102);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return r(j).default}});var R=n(101);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return r(R).default}});var $=n(100);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return r($).default}});var L=n(99);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return r(L).default}});var B=n(98);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return r(B).default}});var N=n(5);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return r(N).default}});var F=n(1);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return F.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return F.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return F.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return F.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return F.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return F.getElementToolStateManager}});var U=n(29);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return r(U).default}});var z=n(4);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return r(z).default}});var q=n(96);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return q.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return q.newTimeSeriesSpecificToolStateManager}});var V=n(14);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return r(V).default}});var H=n(95);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return r(H).default}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return H.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return H.addStackStateManager}});var W=n(10);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return r(W).default}});var G=n(16);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return G.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return G.globalImageIdSpecificToolStateManager}});var Y=n(94);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Y.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Y.globalFrameOfReferenceSpecificToolStateManager}});var X=n(93);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return r(X).default}});var J=n(92);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return r(J).default}});var Q=n(46);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return Q.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return Q.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return Q.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return Q.stackScrollMultiTouch}});var K=n(90);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return r(K).default}});var Z=n(89);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return r(Z).default}});var ee=n(91);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return r(ee).default}});var te=n(88);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return te.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return te.stopClip}});var ne=n(12);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return r(ne).default}});var re=n(8);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return r(re).default}});var oe=n(15);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return r(oe).default}});var ae=n(26);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return r(ae).default}});var ie=n(27);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return r(ie).default}});var se=n(21);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return r(se).default}});var le=n(22);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return r(le).default}});var ue=n(23);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return r(ue).default}});var ce=n(43);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return r(ce).default}});var de=n(44);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return r(de).default}});var fe=n(81);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return r(fe).default}});var he=n(82);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return r(he).default}});var me=n(83);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return r(me).default}});var pe=n(42);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return r(pe).default}});var ge=n(84);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return r(ge).default}});var ve=n(56);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return ve.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return ve.angleTouch}});var ye=n(57);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return ye.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return ye.arrowAnnotateTouch}});var be=n(58);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return be.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return be.crosshairsTouch}});var xe=n(19);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return r(xe).default}});var we=n(38);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return r(we).default}});var Te=n(59);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return r(Te).default}});var Ce=n(60);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return Ce.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return Ce.dragProbeTouch}});var Pe=n(61);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return Pe.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return Pe.ellipticalRoiTouch}});var Me=n(62);Object.defineProperty(t,"freehand",{enumerable:!0,get:function(){return Me.freehand}});var Se=n(63);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return Se.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return Se.highlightTouch}});var Ie=n(64);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return r(Ie).default}});var De=n(39);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return r(De).default}});var Ee=n(65);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return Ee.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return Ee.lengthTouch}});var Oe=n(66);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return Oe.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return Oe.magnifyTouchDrag}});var _e=n(40);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return r(_e).default}});var ke=n(7);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return r(ke).default}});var Ae=n(20);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return r(Ae).default}});var je=n(25);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return r(je).default}});var Re=n(67);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return r(Re).default}});var $e=n(68);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return $e.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return $e.panTouchDrag}});var Le=n(69);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return r(Le).default}});var Be=n(70);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return Be.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return Be.probeTouch}});var Ne=n(71);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return Ne.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return Ne.rectangleRoiTouch}});var Fe=n(72);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return Fe.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return Fe.rotateTouchDrag}});var Ue=n(73);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return r(Ue).default}});var ze=n(74);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return r(ze).default}});var qe=n(75);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return qe.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return qe.seedAnnotateTouch}});var Ve=n(76);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return Ve.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return Ve.simpleAngleTouch}});var He=n(13);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return r(He).default}});var We=n(77);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return We.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return We.textMarkerTouch}});var Ge=n(11);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return r(Ge).default}});var Ye=n(41);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return r(Ye).default}});var Xe=n(9);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return r(Xe).default}});var Je=n(78);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return Je.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return Je.wwwcTouchDrag}});var Qe=n(79);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return Qe.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return Qe.wwwcRegionTouch}});var Ke=n(80);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return Ke.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return Ke.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return Ke.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return Ke.zoomTouchDrag}});var Ze=n(86);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return Ze.brush}});var et=n(108);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return r(et).default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this;e.samples=[],this.set=function(t){e.samples=t,$(e).trigger("CornerstoneLineSampleUpdated")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new function(){var e=this;e.measurements=[],this.add=function(t){var n={index:e.measurements.push(t),measurement:t};$(e).trigger("CornerstoneMeasurementAdded",n)},this.remove=function(t){var n=e.measurements[t];e.measurements.splice(t,1);var r={index:t,measurement:n};$(e).trigger("CornerstoneMeasurementRemoved",r)}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t="",n=e.x<0?"R":"L",o=e.y<0?"A":"P",a=e.z<0?"F":"H",i=new r.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),s=0;s<3;s++)if(i.x>1e-4&&i.x>i.y&&i.x>i.z)t+=n,i.x=0;else if(i.y>1e-4&&i.y>i.x&&i.y>i.z)t+=o,i.y=0;else{if(!(i.z>1e-4&&i.z>i.x&&i.z>i.y))break;t+=a,i.z=0}return t};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=t.replace("F","h"),t=t.replace("R","l"),t=t.replace("L","r"),t=t.replace("A","p"),t=t.replace("P","a"),t=t.toUpperCase()}},function(e,t,n){"use strict";function r(e,t){var n=(0,a.getToolState)(e.currentTarget,s);if(void 0!==n){var r=n.data[0].synchronizationContext.getSourceElements(),i=n.data[0].renderer,l=t.canvasContext.canvas.getContext("2d");o.setToPixelCoordinateSystem(t.enabledElement,l),$.each(r,function(n,r){r!==e.currentTarget&&i(l,t,e.currentTarget,r)})}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(n(55)),s="referenceLines",l={enable:function(e,t,n){n=n||i.default,(0,a.addToolState)(e,s,{synchronizationContext:t,renderer:n}),$(e).on("CornerstoneImageRendered",r),o.updateImage(e)},disable:function(e){$(e).off("CornerstoneImageRendered",r),o.updateImage(e)}};t.default=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),i=function(){function e(){r(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return o(e,[{key:"render",value:function(e,t){var n=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");var r=t[0],o=r.imageIds[this.currentImageIdIndex];a.loadAndCacheImage(o).then(function(i){if(n.layerIds&&n.layerIds[0]){var s=n.layerIds[0];a.getLayer(e,s).image=i}else{var l=a.addLayer(e,i,r.options);n.layerIds.push(l)}a.updateImage(e),t.slice(1,t.length).forEach(function(t,r){var i=n.findImageFn(t.imageIds,o,1);i&&a.loadAndCacheImage(i).then(function(o){var i=r+1;if(n.layerIds&&n.layerIds[i]){var s=n.layerIds[i];a.getLayer(e,s).image=o}else{var l=a.addLayer(e,o,t.options);n.layerIds.push(l)}a.updateImage(e,!0)})})})}}]),e}();t.default=i},function(e,t){e.exports=n}])}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"==typeof cornerstone&&(dicomParser={},"undefined"!=typeof Package&&(e.dicomParser=dicomParser)),dicomParser=t())}(this,function(){var e=function(e){return void 0===e&&(e={}),e.parseDicom=function(t,n){function r(n){if(void 0===n.elements.x00020010)throw"dicomParser.parseDicom: missing required meta header attribute 0002,0010";var r=n.elements.x00020010;return e.readFixedString(t,r.dataOffset,r.length)}function o(e){return"1.2.840.10008.1.2"!==e}function a(r,o){if("1.2.840.10008.1.2.1.99"===r){if(n&&n.inflater){var a=n.inflater(t,o);return new e.ByteStream(e.littleEndianByteArrayParser,a,0)}if("undefined"!=typeof module&&this.module!==module){var i=require("zlib"),s=e.sharedCopy(t,o,t.length-o),l=i.inflateRawSync(s),u=e.alloc(t,l.length+o);return t.copy(u,0,0,o),l.copy(u,o),new e.ByteStream(e.littleEndianByteArrayParser,u,0)}if("undefined"!=typeof pako){var c=t.slice(o),d=pako.inflateRaw(c),f=e.alloc(t,d.length+o);return f.set(t.slice(0,o),0),f.set(d,o),new e.ByteStream(e.littleEndianByteArrayParser,f,0)}throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax"}return"1.2.840.10008.1.2.2"===r?new e.ByteStream(e.bigEndianByteArrayParser,t,o):new e.ByteStream(e.littleEndianByteArrayParser,t,o)}function i(e,t){for(var n in e.elements)e.elements.hasOwnProperty(n)&&(t.elements[n]=e.elements[n]);return void 0!==e.warnings&&(t.warnings=e.warnings.concat(t.warnings)),t}function s(t){var i=r(t),s=o(i),l=a(i,t.position),u={},c=new e.DataSet(l.byteArrayParser,l.byteArray,u);c.warnings=l.warnings;try{s?e.parseDicomDataSetExplicit(c,l,l.byteArray.length,n):e.parseDicomDataSetImplicit(c,l,l.byteArray.length,n)}catch(e){throw{exception:e,dataSet:c}}return c}if(void 0===t)throw"dicomParser.parseDicom: missing required parameter 'byteArray'";return function(){var r=e.readPart10Header(t,n);return i(r,s(r))}()},e}(e);return e=function(e){"use strict";return void 0===e&&(e={}),e.version="1.7.3",e}(e=function(e){"use strict";return void 0===e&&(e={}),e.sharedCopy=function(e,t,n){if("undefined"!=typeof Buffer&&e instanceof Buffer)return e.slice(t,t+n);if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset+t,n);throw"dicomParser.from: unknown type for byteArray"},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.readTag=function(e){if(void 0===e)throw"dicomParser.readTag: missing required parameter 'byteStream'";return"x"+("00000000"+(256*e.readUint16()*256+e.readUint16()).toString(16)).substr(-8)},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.readSequenceItem=function(t){if(void 0===t)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var n={tag:e.readTag(t),length:t.readUint32(),dataOffset:t.position};if("xfffee000"!==n.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset "+t.position;return n},e}(e=function(e){"use strict";function t(t,n){for(var r={};t.position<t.byteArray.length;){var o=e.readDicomElementImplicit(t,void 0,n);if(r[o.tag]=o,"xfffee00d"===o.tag)return new e.DataSet(t.byteArrayParser,t.byteArray,r)}return t.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new e.DataSet(t.byteArrayParser,t.byteArray,r)}function n(n,r){var o=e.readSequenceItem(n);return 4294967295===o.length?(o.hadUndefinedLength=!0,o.dataSet=t(n,r),o.length=n.position-o.dataOffset):(o.dataSet=new e.DataSet(n.byteArrayParser,n.byteArray,{}),e.parseDicomDataSetImplicit(o.dataSet,n,n.position+o.length,{vrCallback:r})),o}function r(t,r,o){for(;t.position+4<=t.byteArray.length;){var a=e.readTag(t);if(t.seek(-4),"xfffee0dd"===a)return r.length=t.position-r.dataOffset,t.seek(8),r;var i=n(t,o);r.items.push(i)}t.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),r.length=t.byteArray.length-r.dataOffset}function o(e,t,r){for(var o=t.dataOffset+t.length;e.position<o;){var a=n(e,r);t.items.push(a)}}return void 0===e&&(e={}),e.readSequenceItemsImplicit=function(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";t.items=[],4294967295===t.length?r(e,t,n):o(e,t,n)},e}(e=function(e){"use strict";function t(t,n){for(var r={};t.position<t.byteArray.length;){var o=e.readDicomElementExplicit(t,n);if(r[o.tag]=o,"xfffee00d"===o.tag)return new e.DataSet(t.byteArrayParser,t.byteArray,r)}return n.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new e.DataSet(t.byteArrayParser,t.byteArray,r)}function n(n,r){var o=e.readSequenceItem(n);return 4294967295===o.length?(o.hadUndefinedLength=!0,o.dataSet=t(n,r),o.length=n.position-o.dataOffset):(o.dataSet=new e.DataSet(n.byteArrayParser,n.byteArray,{}),e.parseDicomDataSetExplicit(o.dataSet,n,n.position+o.length)),o}function r(t,r,o){for(;t.position+4<=t.byteArray.length;){var a=e.readTag(t);if(t.seek(-4),"xfffee0dd"===a)return r.length=t.position-r.dataOffset,t.seek(8),r;var i=n(t,o);r.items.push(i)}o.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),r.length=t.position-r.dataOffset}function o(e,t,r){for(var o=t.dataOffset+t.length;e.position<o;){var a=n(e,r);t.items.push(a)}}return void 0===e&&(e={}),e.readSequenceItemsExplicit=function(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";t.items=[],4294967295===t.length?r(e,t,n):o(e,t,n)},e}(e=function(e){return void 0===e&&(e={}),e.readPart10Header=function(t,n){function r(){if(o.seek(128),"DICM"!==o.readFixedString(4))throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file."}if(void 0===t)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var o=new e.ByteStream(e.littleEndianByteArrayParser,t);return function(){r();for(var t=[],n={};o.position<o.byteArray.length;){var a=o.position,i=e.readDicomElementExplicit(o,t);if(i.tag>"x0002ffff"){o.position=a;break}i.parser=e.littleEndianByteArrayParser,n[i.tag]=i}var s=new e.DataSet(o.byteArrayParser,o.byteArray,n);return s.warnings=o.warnings,s.position=o.position,s}()},e}(e=function(e){"use strict";function t(e,t,n){for(var r=0,o=t;o<t+n;o++)r+=e[o].length;return r}return void 0===e&&(e={}),e.readEncapsulatedPixelDataFromFragments=function(n,r,o,a,i){if(a=a||1,i=i||r.fragments,void 0===n)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===r)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===o)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===a)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==r.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==r.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==r.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===r.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===r.fragments)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(r.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(o<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(o>=r.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(a<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(o+a>r.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var s=new e.ByteStream(n.byteArrayParser,n.byteArray,r.dataOffset),l=e.readSequenceItem(s);if("xfffee000"!==l.tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";s.seek(l.length);var u=s.position;if(1===a)return e.sharedCopy(s.byteArray,u+i[o].offset+8,i[o].length);for(var c=t(i,o,a),d=e.alloc(s.byteArray,c),f=0,h=o;h<o+a;h++)for(var m=u+i[h].offset+8,p=0;p<i[h].length;p++)d[f++]=s.byteArray[m++];return d},e}(e=function(e){"use strict";function t(e,t){for(var n=0;n<e.length;n++)if(e[n].offset===t)return n}function n(e,t,n,r){if(e===t.length-1)return n.length-r;for(var o=t[e+1],a=r+1;a<n.length;a++)if(n[a].offset===o)return a-r;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"}return void 0===e&&(e={}),e.readEncapsulatedImageFrame=function(r,o,a,i,s){if(i=i||o.basicOffsetTable,s=s||o.fragments,void 0===r)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===o)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===a)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===i)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==o.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==o.encapsulatedPixelData)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==o.hadUndefinedLength)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===o.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===i.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(a<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(a>=i.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var l=t(s,i[a]);if(void 0===l)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";var u=n(a,i,s,l);return e.readEncapsulatedPixelDataFromFragments(r,o,l,u,s)},e}(e=function(e){"use strict";function t(t,n,r){if(void 0!==r)return"SQ"===r(t.tag);if(n.position+4<=n.byteArray.length){var o=e.readTag(n);return n.seek(-4),"xfffee000"===o||"xfffee0dd"===o}return n.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1}return void 0===e&&(e={}),e.readDicomElementImplicit=function(n,r,o){if(void 0===n)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var a={tag:e.readTag(n),length:n.readUint32(),dataOffset:n.position};return 4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===r?a:t(a,n,o)?(e.readSequenceItemsImplicit(n,a),a):a.hadUndefinedLength?(e.findItemDelimitationItemAndSetElementLength(n,a),a):(n.seek(a.length),a)},e}(e=function(e){"use strict";function t(e){return"OB"===e||"OW"===e||"SQ"===e||"OF"===e||"UT"===e||"UN"===e?4:2}return void 0===e&&(e={}),e.readDicomElementExplicit=function(n,r,o){if(void 0===n)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var a={tag:e.readTag(n),vr:n.readFixedString(2)};return 2===t(a.vr)?(a.length=n.readUint16(),a.dataOffset=n.position):(n.seek(2),a.length=n.readUint32(),a.dataOffset=n.position),4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===o?a:"SQ"===a.vr?(e.readSequenceItemsExplicit(n,a,r),a):4294967295===a.length?"x7fe00010"===a.tag?(e.findEndOfEncapsulatedElement(n,a,r),a):"UN"===a.vr?(e.findAndSetUNElementLength(n,a),a):(e.findItemDelimitationItemAndSetElementLength(n,a),a):(n.seek(a.length),a)},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.parseDicomDataSetExplicit=function(t,n,r,o){if(r=void 0===r?n.byteArray.length:r,o=o||{},void 0===n)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(r<n.position||r>n.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxPosition'";for(var a=t.elements;n.position<r;){var i=e.readDicomElementExplicit(n,t.warnings,o.untilTag);if(a[i.tag]=i,i.tag===o.untilTag)return}if(n.position>r)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"},e.parseDicomDataSetImplicit=function(t,n,r,o){if(r=void 0===r?t.byteArray.length:r,o=o||{},void 0===n)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(r<n.position||r>n.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var a=t.elements;n.position<r;){var i=e.readDicomElementImplicit(n,o.untilTag,o.vrCallback);if(a[i.tag]=i,i.tag===o.untilTag)return}},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.littleEndianByteArrayParser={readUint16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return e[t]+256*e[t+1]},readInt16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";var n=e[t]+(e[t+1]<<8);return 32768&n&&(n=n-65535-1),n},readUint32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return e[t]+256*e[t+1]+256*e[t+2]*256+256*e[t+3]*256*256},readInt32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)},readFloat:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],n[4]=e[t+4],n[5]=e[t+5],n[6]=e[t+6],n[7]=e[t+7],new Float64Array(n.buffer)[0]}},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.findItemDelimitationItemAndSetElementLength=function(e,t){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;)if(65534===e.readUint16()&&57357===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position"+e.position-4+" while reading element of undefined length with tag ' + element.tag"),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.findEndOfEncapsulatedElement=function(t,n,r){if(void 0===t)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===n)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(n.encapsulatedPixelData=!0,n.basicOffsetTable=[],n.fragments=[],"xfffee000"!==e.readTag(t))throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var o=t.readUint32()/4,a=0;a<o;a++){var i=t.readUint32();n.basicOffsetTable.push(i)}for(var s=t.position;t.position<t.byteArray.length;){var l=e.readTag(t),u=t.readUint32();if("xfffee0dd"===l)return t.seek(u),void(n.length=t.position-n.dataOffset);if("xfffee000"!==l)return r&&r.push("unexpected tag "+l+" while searching for end of pixel data element with undefined length"),u>t.byteArray.length-t.position&&(u=t.byteArray.length-t.position),n.fragments.push({offset:t.position-s-8,position:t.position,length:u}),t.seek(u),void(n.length=t.position-n.dataOffset);n.fragments.push({offset:t.position-s-8,position:t.position,length:u}),t.seek(u)}r&&r.push("pixel data element "+n.tag+" missing sequence delimiter tag xfffee0dd")},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.findAndSetUNElementLength=function(e,t){if(void 0===e)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;){if(65534===e.readUint16()){if(57565===e.readUint16()){return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position"+e.position-4+" while reading element of undefined length with tag ' + element.tag"),void(t.length=e.position-t.dataOffset)}}}t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)},e}(e=function(e){"use strict";function t(e,t){return void 0!==e.parser?e.parser:t}return void 0===e&&(e={}),e.DataSet=function(e,t,n){this.byteArrayParser=e,this.byteArray=t,this.elements=n},e.DataSet.prototype.uint16=function(e,n){var r=this.elements[e];if(n=void 0!==n?n:0,r&&0!==r.length)return t(r,this.byteArrayParser).readUint16(this.byteArray,r.dataOffset+2*n)},e.DataSet.prototype.int16=function(e,n){var r=this.elements[e];if(n=void 0!==n?n:0,r&&0!==r.length)return t(r,this.byteArrayParser).readInt16(this.byteArray,r.dataOffset+2*n)},e.DataSet.prototype.uint32=function(e,n){var r=this.elements[e];if(n=void 0!==n?n:0,r&&0!==r.length)return t(r,this.byteArrayParser).readUint32(this.byteArray,r.dataOffset+4*n)},e.DataSet.prototype.int32=function(e,n){var r=this.elements[e];if(n=void 0!==n?n:0,r&&0!==r.length)return t(r,this.byteArrayParser).readInt32(this.byteArray,r.dataOffset+4*n)},e.DataSet.prototype.float=function(e,n){var r=this.elements[e];if(n=void 0!==n?n:0,r&&0!==r.length)return t(r,this.byteArrayParser).readFloat(this.byteArray,r.dataOffset+4*n)},e.DataSet.prototype.double=function(e,n){var r=this.elements[e];if(n=void 0!==n?n:0,r&&0!==r.length)return t(r,this.byteArrayParser).readDouble(this.byteArray,r.dataOffset+8*n)},e.DataSet.prototype.numStringValues=function(t){var n=this.elements[t];if(n&&n.length>0){var r=e.readFixedString(this.byteArray,n.dataOffset,n.length).match(/\\/g);return null===r?1:r.length+1}},e.DataSet.prototype.string=function(t,n){var r=this.elements[t];if(r&&r.length>0){var o=e.readFixedString(this.byteArray,r.dataOffset,r.length);return n>=0?o.split("\\")[n].trim():o.trim()}},e.DataSet.prototype.text=function(t,n){var r=this.elements[t];if(r&&r.length>0){var o=e.readFixedString(this.byteArray,r.dataOffset,r.length);return n>=0?o.split("\\")[n].replace(/ +$/,""):o.replace(/ +$/,"")}},e.DataSet.prototype.floatString=function(e,t){var n=this.elements[e];if(n&&n.length>0){t=void 0!==t?t:0;var r=this.string(e,t);if(void 0!==r)return parseFloat(r)}},e.DataSet.prototype.intString=function(e,t){var n=this.elements[e];if(n&&n.length>0){t=void 0!==t?t:0;var r=this.string(e,t);if(void 0!==r)return parseInt(r)}},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.ByteStream=function(e,t,n){if(void 0===e)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===t)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(t instanceof Uint8Array==!1&&t instanceof Buffer==!1)throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(n<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(n>=t.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=e,this.byteArray=t,this.position=n||0,this.warnings=[]},e.ByteStream.prototype.seek=function(e){if(this.position+e<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=e},e.ByteStream.prototype.readByteStream=function(t){if(this.position+t>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var n=e.sharedCopy(this.byteArray,this.position,t);return this.position+=t,new e.ByteStream(this.byteArrayParser,n)},e.ByteStream.prototype.readUint16=function(){var e=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,e},e.ByteStream.prototype.readUint32=function(){var e=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,e},e.ByteStream.prototype.readFixedString=function(t){var n=e.readFixedString(this.byteArray,this.position,t);return this.position+=t,n},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.readFixedString=function(e,t,n){if(n<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(t+n>e.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var r,o="",a=0;a<n;a++){if(0===(r=e[t+a]))return t+=n,o;o+=String.fromCharCode(r)}return o},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.bigEndianByteArrayParser={readUint16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(e[t]<<8)+e[t+1]},readInt16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";var n=(e[t]<<8)+e[t+1];return 32768&n&&(n=n-65535-1),n},readUint32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*e[t]+e[t+1])+e[t+2])+e[t+3]},readInt32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(e[t]<<24)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]},readFloat:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[3]=e[t],n[2]=e[t+1],n[1]=e[t+2],n[0]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[7]=e[t],n[6]=e[t+1],n[5]=e[t+2],n[4]=e[t+3],n[3]=e[t+4],n[2]=e[t+5],n[1]=e[t+6],n[0]=e[t+7],new Float64Array(n.buffer)[0]}},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.alloc=function(e,t){if("undefined"!=typeof Buffer&&e instanceof Buffer)return Buffer.alloc(t);if(e instanceof Uint8Array)return new Uint8Array(t);throw"dicomParser.alloc: unknown type for byteArray"},e}(e=function(e){"use strict";void 0===e&&(e={});var t=!1;return e.readEncapsulatedPixelData=function(n,r,o){if(t||(t=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===n)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===r)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===o)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==r.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==r.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(!0!==r.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===r.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===r.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(o<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==r.basicOffsetTable.length?e.readEncapsulatedImageFrame(n,r,o):e.readEncapsulatedPixelDataFromFragments(n,r,0,r.fragments.length)},e}(e=function(e){"use strict";void 0===e&&(e={});var t={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0};return e.isStringVr=function(e){return t[e]},e.isPrivateTag=function(e){return parseInt(e[4])%2==1},e.parsePN=function(e){if(void 0!==e){var t=e.split("^");return{familyName:t[0],givenName:t[1],middleName:t[2],prefix:t[3],suffix:t[4]}}},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.parseTM=function(e,t){if(e.length>=2){var n=parseInt(e.substring(0,2),10),r=e.length>=4?parseInt(e.substring(2,4),10):void 0,o=e.length>=6?parseInt(e.substring(4,6),10):void 0,a=e.length>=8?parseInt(e.substring(7,13),10):void 0;if(t&&(isNaN(n)||void 0!==r&&isNaN(r)||void 0!==o&&isNaN(o)||void 0!==a&&isNaN(a)||n<0||n>23||r&&(r<0||r>59)||o&&(o<0||o>59)||a&&(a<0||a>999999)))throw"invalid TM '"+e+"'";return{hours:n,minutes:r,seconds:o,fractionalSeconds:a}}if(t)throw"invalid TM '"+e+"'"},e}(e=function(e){"use strict";function t(e,t){switch(e){case 2:return t%4==0&&t%100||t%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}function n(e,n,r){return!isNaN(r)&&(n>0&&n<=12&&e>0&&e<=t(n,r))}return void 0===e&&(e={}),e.parseDA=function(e,t){if(e&&8===e.length){var r=parseInt(e.substring(0,4),10),o=parseInt(e.substring(4,6),10),a=parseInt(e.substring(6,8),10);if(t&&!0!==n(a,o,r))throw"invalid DA '"+e+"'";return{year:r,month:o,day:a}}if(t)throw"invalid DA '"+e+"'"},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.explicitElementToString=function(t,n){function r(e,n){for(var r="",o=0;o<e;o++)0!==o&&(r+="/"),r+=n.call(t,i,o).toString();return r}if(void 0===t||void 0===n)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===n.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var o,a=n.vr,i=n.tag;if(!0===e.isStringVr(a))o=t.string(i);else{if("AT"==a){var s=t.uint32(i);if(void 0===s)return;return s<0&&(s=4294967295+s+1),"x"+s.toString(16).toUpperCase()}"US"==a?o=r(n.length/2,t.uint16):"SS"===a?o=r(n.length/2,t.int16):"UL"==a?o=r(n.length/4,t.uint32):"SL"===a?o=r(n.length/4,t.int32):"FD"==a?o=r(n.length/8,t.double):"FL"==a&&(o=r(n.length/4,t.float))}return o},e}(e=function(e){"use strict";return void 0===e&&(e={}),e.explicitDataSetToJS=function(t,n){if(void 0===t)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";n=n||{omitPrivateAttibutes:!0,maxElementLength:128};var r={};for(var o in t.elements){var a=t.elements[o];if(!0!==n.omitPrivateAttibutes||!e.isPrivateTag(o))if(a.items){for(var i=[],s=0;s<a.items.length;s++)i.push(e.explicitDataSetToJS(a.items[s].dataSet,n));r[o]=i}else{var l;l=void 0,a.length<n.maxElementLength&&(l=e.explicitElementToString(t,a)),r[o]=void 0!==l?l:{dataOffset:a.dataOffset,length:a.length}}}return r},e}(e=function(e){"use strict";function t(e,t){return 255===e.byteArray[t]&&217===e.byteArray[t+1]}function n(e,n,r){var o=n.fragments[r];return!(!t(e,o.position+o.length-2)&&!t(e,o.position+o.length-3))}function r(e,t,r){for(var o=r;o<t.fragments.length;o++)if(n(e,t,o))return o}return void 0===e&&(e={}),e.createJPEGBasicOffsetTable=function(e,t,n){if(void 0===e)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===t)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==t.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==t.encapsulatedPixelData)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(n&&n.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";n=n||t.fragments;for(var o=[],a=0;;){o.push(t.fragments[a].offset);var i=r(e,t,a);if(void 0===i||i===t.fragments.length-1)return o;a=i+1}},e}(e))))))))))))))))))))))))))))}),"undefined"==typeof cornerstone&&(cornerstone={}),"undefined"==typeof cornerstoneWADOImageLoader&&(cornerstoneWADOImageLoader={internal:{options:{beforeSend:function(e){},imageCreated:function(e){}}}}),function(e,t,n){"use strict";function r(e){e.decache=function(){var t=n.parseImageId(e.imageId);n.dataSetCacheManager.unload(t.url)}}function o(t,o,a,i){var s=e.Deferred();return t.then(function(e){n.createImageObject(e,o,a,i).then(function(e){r(e),s.resolve(e)},function(e){s.reject(e)})},function(e){s.reject(e)}),s}function a(e){return"dicomweb"===e||"wadouri"===e?n.internal.xhrRequest:"dicomfile"===e?n.internal.loadFileRequest:void 0}n.internal.loadImage=function(t){var i=n.parseImageId(t),s=a(i.scheme);if(n.dataSetCacheManager.isLoaded(i.url))return o(n.dataSetCacheManager.load(i.url,s),t,i.frame,i.url);if(void 0!==i.frame)return o(n.dataSetCacheManager.load(i.url,s),t,i.frame,i.url);var l=e.Deferred();return s(i.url,t).then(function(e){n.createImageObject(e,t,i.frame).then(function(e){r(e),l.resolve(e)},function(e){l.reject(e)})},function(e){l.reject(e)}),l}}($,cornerstone,cornerstoneWADOImageLoader),function(e){"use strict";function t(t,n,r){0===t.uint16("x00280006")?e.convertRGBColorByPixel(n,r):e.convertRGBColorByPlane(n,r)}function n(t,n,r){0===t.uint16("x00280006")?e.convertYBRFullByPixel(n,r):e.convertYBRFullByPlane(n,r)}e.convertColorSpace=function(r,o,a){var i=o.uint16("x00280010"),s=o.uint16("x00280011"),l=o.string("x00280004");r.height=i,r.width=s;var u=r.getContext("2d").createImageData(s,i),c=$.Deferred();try{if("RGB"===l)t(o,a,u.data);else if("YBR_RCT"===l)t(o,a,u.data);else if("YBR_ICT"===l)t(o,a,u.data);else if("PALETTE COLOR"===l)e.convertPALETTECOLOR(a,u.data,o);else if("YBR_FULL_422"===l)n(o,a,u.data);else{if("YBR_FULL"!==l)throw"no color space conversion for photometric interpretation "+l;n(o,a,u.data)}return c.resolve(u),c.promise()}catch(e){return c.reject(e),c.promise()}}}(cornerstoneWADOImageLoader),function(e){"use strict";e.convertPALETTECOLOR=function(e,t,n){var r=n.int16("x00281101",0);r||(r=65536);for(var o=n.int16("x00281101",1),a=8===n.int16("x00281101",2)?0:8,i=n.byteArray.buffer,s=new Uint16Array(i,n.elements.x00281201.dataOffset,r),l=new Uint16Array(i,n.elements.x00281202.dataOffset,r),u=new Uint16Array(i,n.elements.x00281203.dataOffset,r),c=n.uint16("x00280010")*n.uint16("x00280011"),d=0,f=0,h=0;h<c;++h){var m=e[d++];m<o?m=0:m>o+r-1?m=r-1:m-=o,t[f++]=s[m]>>a,t[f++]=l[m]>>a,t[f++]=u[m]>>a,t[f++]=255}}}(cornerstoneWADOImageLoader),function(e){"use strict";e.convertRGBColorByPixel=function(e,t){if(void 0===e)throw"decodeRGB: rgbBuffer must not be undefined";if(e.length%3!=0)throw"decodeRGB: rgbBuffer length must be divisible by 3";for(var n=e.length/3,r=0,o=0,a=0;a<n;a++)t[o++]=e[r++],t[o++]=e[r++],t[o++]=e[r++],t[o++]=255}}(cornerstoneWADOImageLoader),function(e){"use strict";e.convertRGBColorByPlane=function(e,t){if(void 0===e)throw"decodeRGB: rgbBuffer must not be undefined";if(e.length%3!=0)throw"decodeRGB: rgbBuffer length must be divisible by 3";for(var n=e.length/3,r=0,o=0,a=n,i=2*n,s=0;s<n;s++)t[r++]=e[o++],t[r++]=e[a++],t[r++]=e[i++],t[r++]=255}}(cornerstoneWADOImageLoader),function(e){"use strict";e.convertYBRFullByPixel=function(e,t){if(void 0===e)throw"decodeRGB: ybrBuffer must not be undefined";if(e.length%3!=0)throw"decodeRGB: ybrBuffer length must be divisble by 3";for(var n=e.length/3,r=0,o=0,a=0;a<n;a++){var i=e[r++],s=e[r++],l=e[r++];t[o++]=i+1.402*(l-128),t[o++]=i-.34414*(s-128)-.71414*(l-128),t[o++]=i+1.772*(s-128),t[o++]=255}}}(cornerstoneWADOImageLoader),function(e){"use strict";e.convertYBRFullByPlane=function(e,t){if(void 0===e)throw"decodeRGB: ybrBuffer must not be undefined";if(e.length%3!=0)throw"decodeRGB: ybrBuffer length must be divisble by 3";for(var n=e.length/3,r=0,o=0,a=n,i=2*n,s=0;s<n;s++){var l=e[o++],u=e[a++],c=e[i++];t[r++]=l+1.402*(c-128),t[r++]=l-.34414*(u-128)-.71414*(c-128),t[r++]=l+1.772*(u-128),t[r++]=255}}}(cornerstoneWADOImageLoader),function(e){"use strict";e.configure=function(t){e.internal.options=t}}(cornerstoneWADOImageLoader),function(e){"use strict";e.createImageObject=function(t,n,r,o){void 0===r&&(r=0);var a=t.string("x00280004");return!1===e.isColorImage(a)?e.makeGrayscaleImage(n,t,r,o):e.makeColorImage(n,t,r,o)}}(cornerstoneWADOImageLoader),function(e){"use strict";var t={},n={};e.dataSetCacheManager={isLoaded:function(e){return void 0!==t[e]},load:function(e,r){if(t[e]){var o=$.Deferred();return t[e].cacheCount++,o.resolve(t[e].dataSet),o}if(n[e])return n[e];var a=r(e);return n[e]=a,a.then(function(r){t[e]={dataSet:r,cacheCount:1},delete n[e]},function(){}).always(function(){delete n[e]}),a},unload:function(e){t[e]&&(t[e].cacheCount--,0===t[e].cacheCount&&delete t[e])},purge:function(){t={},n={}}}}(cornerstoneWADOImageLoader),function(e,t,n){"use strict";function r(e,t){var r=e.uint16("x00280010"),o=e.uint16("x00280011"),a=n.getEncodedImageFrame(e,t),i=new JpxImage;i.parse(a);var s=i.width,l=i.height;if(s!==o)throw"JPEG2000 decoder returned width of "+s+", when "+o+" is expected";if(l!==r)throw"JPEG2000 decoder returned width of "+l+", when "+r+" is expected";var u=i.tiles.length;if(1!==u)throw"JPEG2000 decoder returned a tileCount of "+u+", when 1 is expected";return i.tiles[0].items}function o(e,t,n){var r=i._malloc(e.length);i.writeArrayToMemory(e,r);var o=i._malloc(4),a=i._malloc(4),s=i._malloc(4),l=i._malloc(4),u=i._malloc(4),c=Date.now();if(0!==i.ccall("jp2_decode","number",["number","number","number","number","number","number","number"],[r,e.length,o,a,s,l,u]))return console.log("[opj_decode] decoding failed!"),i._free(r),i._free(i.getValue(o,"*")),i._free(s),i._free(l),i._free(a),void i._free(u);var d=i.getValue(o,"*"),f={length:i.getValue(a,"i32"),sx:i.getValue(s,"i32"),sy:i.getValue(l,"i32"),nbChannels:i.getValue(u,"i32"),perf_timetodecode:void 0,pixelData:void 0},h=f.sx*f.sy*f.nbChannels,m=new Uint32Array(i.HEAP32.buffer,d,h);if(1===t)if(Uint8Array.from)f.pixelData=Uint8Array.from(m);else{f.pixelData=new Uint8Array(h);for(p=0;p<h;p++)f.pixelData[p]=m[p]}else if(n)if(Int16Array.from)f.pixelData=Int16Array.from(m);else{f.pixelData=new Int16Array(h);for(p=0;p<h;p++)f.pixelData[p]=m[p]}else if(Uint16Array.from)f.pixelData=Uint16Array.from(m);else{f.pixelData=new Uint16Array(h);for(var p=0;p<h;p++)f.pixelData[p]=m[p]}var g=Date.now();return f.perf_timetodecode=g-c,i._free(r),i._free(o),i._free(d),i._free(a),i._free(s),i._free(l),i._free(u),f}function a(e,t){var r=e.uint16("x00280010"),a=e.uint16("x00280011"),i=o(n.getEncodedImageFrame(e,t),e.uint16("x00280100")<=8?1:2,!!e.uint16("x00280103")),s=i.sx,l=i.sy;if(s!==a)throw"JPEG2000 decoder returned width of "+s+", when "+a+" is expected";if(l!==r)throw"JPEG2000 decoder returned width of "+l+", when "+r+" is expected";return i.pixelData}var i;n.decodeJPEG2000=function(e,t){if(!("undefined"==typeof OpenJPEG||i||(i=OpenJPEG())&&i._jp2_decode))throw"OpenJPEG failed to initialize";if(i&&i._jp2_decode)return a(e,t);if("undefined"!=typeof JpxImage)return r(e,t);throw"No JPEG2000 decoder loaded"}}($,cornerstone,cornerstoneWADOImageLoader),function(e,t,n){"use strict";n.decodeJPEGBaseline=function(e,t){var r=e.uint16("x00280010"),o=e.uint16("x00280011"),a=e.uint16("x00280100"),i=n.getEncodedImageFrame(e,t),s=new JpegImage;return s.parse(i),8===a?s.getData(o,r):16===a?s.getData16(o,r):void 0}}($,cornerstone,cornerstoneWADOImageLoader),function(e){"use strict";function t(e){return n(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(e))))}function n(e){var t;try{return decodeURIComponent(escape(e))}catch(n){if((t=n)instanceof URIError)return e;throw t}}e.decodeJPEGBaseline8Bit=function(n,r,o){var a=$.Deferred(),i=r.uint16("x00280010"),s=r.uint16("x00280011");n.height=i,n.width=s;var l=e.getEncodedImageFrame(r,o),u=new Blob([l],{type:"image/jpeg"}),c=new FileReader;return void 0===c.readAsBinaryString?c.readAsArrayBuffer(u):c.readAsBinaryString(u),c.onload=function(){var e=new Image;e.onload=function(){var e=n.getContext("2d");e.drawImage(this,0,0);var t=e.getImageData(0,0,s,i);a.resolve(t)},e.onerror=function(e){a.reject(e)},void 0===c.readAsBinaryString?e.src="data:image/jpeg;base64,"+window.btoa(t(c.result)):e.src="data:image/jpeg;base64,"+window.btoa(c.result)},a.promise()},e.isJPEGBaseline8Bit=function(e){var t=e.string("x00020010");if(8===e.uint16("x00280100")&&"1.2.840.10008.1.2.4.50"===t)return!0}}(cornerstoneWADOImageLoader),function(e){function t(e){var t=n._malloc(e.length);n.writeArrayToMemory(e,t);var r=n._malloc(4),o=n._malloc(4),a=n._malloc(4),i=n._malloc(4),s=n._malloc(4),l=n._malloc(4),u=n._malloc(4),c=n._malloc(4),d=n._malloc(4),f={result:n.ccall("jpegls_decode","number",["number","number","number","number","number","number","number","number","number","number","number"],[t,e.length,r,o,a,i,s,l,c,u,d]),width:n.getValue(a,"i32"),height:n.getValue(i,"i32"),bitsPerSample:n.getValue(s,"i32"),stride:n.getValue(l,"i32"),components:n.getValue(c,"i32"),allowedLossyError:n.getValue(u,"i32"),interleaveMode:n.getValue(d,"i32"),pixelData:void 0},h=n.getValue(r,"*");if(f.bitsPerSample<=8){f.pixelData=new Uint8Array(f.width*f.height*f.components);var m=new Uint8Array(n.HEAP8.buffer,h,f.pixelData.length);f.pixelData.set(m)}else{f.pixelData=new Int16Array(f.width*f.height*f.components);var p=new Int16Array(n.HEAP16.buffer,h,f.pixelData.length);f.pixelData.set(p)}return n._free(t),n._free(h),n._free(r),n._free(o),n._free(a),n._free(i),n._free(s),n._free(l),n._free(c),n._free(d),f}var n;e.decodeJPEGLS=function(r,o){if(CharLS&&!n&&(n=CharLS()),!n||!n._jpegls_decode)throw"No JPEG-LS decoder loaded";var a=r.uint16("x00280010"),i=r.uint16("x00280011"),s=t(e.getEncodedImageFrame(r,o));if(0!==s.result&&6!==s.result)throw"JPEG-LS decoder failed to decode frame (error code "+s.result+")";if(s.width!==i)throw"JPEG-LS decoder returned width of "+s.width+", when "+i+" is expected";if(s.height!==a)throw"JPEG-LS decoder returned width of "+s.height+", when "+a+" is expected";return s.pixelData}}(cornerstoneWADOImageLoader),function(e){e.decodeJPEGLossless=function(t,n){var r=t.uint16("x00280100"),o=t.uint16("x00280103"),a=e.getEncodedImageFrame(t,n),i=r<=8?1:2,s=(new jpeg.lossless.Decoder).decode(a.buffer,a.byteOffset,a.length,i);return 0===o?2===i?new Uint16Array(s.buffer):new Uint8Array(s.buffer):new Int16Array(s.buffer)}}(cornerstoneWADOImageLoader),function(e){function t(e,t,n,r){for(var o=new DataView(e.buffer,e.byteOffset),a=new DataView(e.buffer,e.byteOffset),i=new DataView(t),s=0,l=o.getInt32(0,!0),u=0;u<l;++u){s=u;var c=o.getInt32(4*(u+1),!0),d=o.getInt32(4*(u+2),!0);0===d&&(d=e.length);for(var f=n*l;c<d;){var h=a.getInt8(c++);if(h>=0&&h<=127)for(var m=0;m<h+1&&s<f;++m)i.setInt8(s,a.getInt8(c++)),s+=r;else if(h<=-1&&h>=-127)for(var p=a.getInt8(c++),g=0;g<1-h&&s<f;++g)i.setInt8(s,p),s+=r}}}function n(e,t,n){for(var r=new DataView(e.buffer,e.byteOffset),o=new DataView(e.buffer,e.byteOffset),a=new DataView(t),i=r.getInt32(0,!0),s=0;s<i;++s){var l=0,u=0===s?1:0,c=r.getInt32(4*(s+1),!0),d=r.getInt32(4*(s+2),!0);for(0===d&&(d=e.length);c<d;){var f=o.getInt8(c++);if(f>=0&&f<=127)for(var h=0;h<f+1&&l<n;++h)a.setInt8(2*l+u,o.getInt8(c++)),l++;else if(f<=-1&&f>=-127)for(var m=o.getInt8(c++),p=0;p<1-f&&l<n;++p)a.setInt8(2*l+u,m),l++}}}e.decodeRLE=function(r,o){var a,i=r.uint16("x00280010"),s=r.uint16("x00280011"),l=r.uint16("x00280002"),u=r.elements.x7fe00010,c=dicomParser.readEncapsulatedPixelDataFromFragments(r,u,o),d=e.getPixelFormat(r),f=s*i;return 1===d?(a=new ArrayBuffer(f*l),t(c,a,f,l),new Uint8Array(a)):2===d?(a=new ArrayBuffer(f*l*2),n(c,a,f),new Uint16Array(a)):3===d?(a=new ArrayBuffer(f*l*2),n(c,a,f),new Int16Array(a)):void 0}}(cornerstoneWADOImageLoader),function(e){"use strict";e.decodeTransferSyntax=function(t,n){var r=t.string("x00020010");if("1.2.840.10008.1.2"===r)return e.extractUncompressedPixels(t,n);if("1.2.840.10008.1.2.1"===r)return e.extractUncompressedPixels(t,n);if("1.2.840.10008.1.2.2"===r)return e.extractUncompressedPixels(t,n,!0);if("1.2.840.10008.1.2.5"===r)return e.decodeRLE(t,n);if("1.2.840.10008.1.2.4.50"===r)return e.decodeJPEGBaseline(t,n);if("1.2.840.10008.1.2.4.51"===r)return e.decodeJPEGBaseline(t,n);if("1.2.840.10008.1.2.4.57"===r)return e.decodeJPEGLossless(t,n);if("1.2.840.10008.1.2.4.70"===r)return e.decodeJPEGLossless(t,n);if("1.2.840.10008.1.2.4.80"===r)return e.decodeJPEGLS(t,n);if("1.2.840.10008.1.2.4.81"===r)return e.decodeJPEGLS(t,n);if("1.2.840.10008.1.2.4.90"===r)return e.decodeJPEG2000(t,n);if("1.2.840.10008.1.2.4.91"===r)return e.decodeJPEG2000(t,n);throw console&&console.log&&console.log("Image cannot be decoded due to Unsupported transfer syntax "+r),"no decoder for transfer syntax "+r}}(cornerstoneWADOImageLoader);var ColorSpace={Unkown:0,Grayscale:1,AdobeRGB:2,RGB:3,CYMK:4},JpegImage=function(){"use strict";function e(){}function t(e,t){for(var n,r,o=0,a=[],i=16;i>0&&!e[i-1];)i--;a.push({children:[],index:0});var s,l=a[0];for(n=0;n<i;n++){for(r=0;r<e[n];r++){for((l=a.pop()).children[l.index]=t[o];l.index>0;)l=a.pop();for(l.index++,a.push(l);a.length<=n;)a.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;o++}n+1<i&&(a.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return a[0].children}function n(e,t,n){return 64*((e.blocksPerLine+1)*t+n)}function r(e,t,r,o,a,i,l,u,c){function d(){if(S>0)return S--,M>>S&1;if(255==(M=e[t++])){var n=e[t++];if(n)throw"unexpected marker: "+(M<<8|n).toString(16)}return S=7,M>>>7}function f(e){for(var t,n=e;null!==(t=d());){if("number"==typeof(n=n[t]))return n;if("object"!=typeof n)throw"invalid huffman sequence"}return null}function h(e){for(var t=0;e>0;){var n=d();if(null===n)return;t=t<<1|n,e--}return t}function m(e){var t=h(e);return t>=1<<e-1?t:t+(-1<<e)+1}r.precision,r.samplesPerLine,r.scanLines;var p,g,v,y,b,x,w,T=r.mcusPerLine,C=r.progressive,P=(r.maxH,r.maxV,t),M=0,S=0,I=0,D=0,E=o.length;w=C?0===i?0===u?function(e,t){var n=f(e.huffmanTableDC),r=0===n?0:m(n)<<c;e.blockData[t]=e.pred+=r}:function(e,t){e.blockData[t]|=d()<<c}:0===u?function(e,t){if(I>0)I--;else for(var n=i,r=l;n<=r;){var o=f(e.huffmanTableAC),a=15&o,u=o>>4;if(0!==a){var d=s[n+=u];e.blockData[t+d]=m(a)*(1<<c),n++}else{if(u<15){I=h(u)+(1<<u)-1;break}n+=16}}}:function(e,t){for(var n=i,r=l,o=0;n<=r;){var a=s[n];switch(D){case 0:var u=f(e.huffmanTableAC),g=15&u;if(o=u>>4,0===g)o<15?(I=h(o)+(1<<o),D=4):(o=16,D=1);else{if(1!==g)throw"invalid ACn encoding";p=m(g),D=o?2:3}continue;case 1:case 2:e.blockData[t+a]?e.blockData[t+a]+=d()<<c:0==--o&&(D=2==D?3:0);break;case 3:e.blockData[t+a]?e.blockData[t+a]+=d()<<c:(e.blockData[t+a]=p<<c,D=0);break;case 4:e.blockData[t+a]&&(e.blockData[t+a]+=d()<<c)}n++}4===D&&0==--I&&(D=0)}:function(e,t){var n=f(e.huffmanTableDC),r=0===n?0:m(n);e.blockData[t]=e.pred+=r;for(var o=1;o<64;){var a=f(e.huffmanTableAC),i=15&a,l=a>>4;if(0!==i){var u=s[o+=l];e.blockData[t+u]=m(i),o++}else{if(l<15)break;o+=16}}};var O,_,k=0;_=1==E?o[0].blocksPerLine*o[0].blocksPerColumn:T*r.mcusPerColumn,a||(a=_);for(var A,j;k<_;){for(v=0;v<E;v++)o[v].pred=0;if(I=0,1==E)for(g=o[0],x=0;x<a;x++)!function(e,t,r){t(e,n(e,r/e.blocksPerLine|0,r%e.blocksPerLine))}(g,w,k),k++;else for(x=0;x<a;x++){for(v=0;v<E;v++)for(A=(g=o[v]).h,j=g.v,y=0;y<j;y++)for(b=0;b<A;b++)!function(e,t,r,o,a){var i=r%T;t(e,n(e,(r/T|0)*e.v+o,i*e.h+a))}(g,w,k,y,b);k++}if(S=0,(O=e[t]<<8|e[t+1])<=65280)throw"marker was not found";if(!(O>=65488&&O<=65495))break;t+=2}return t-P}function o(e,t,n){var r,o,a,i,s,g,v,y,b,x,w=e.quantizationTable;for(x=0;x<64;x++)n[x]=e.blockData[t+x]*w[x];for(x=0;x<8;++x){var T=8*x;0!==n[1+T]||0!==n[2+T]||0!==n[3+T]||0!==n[4+T]||0!==n[5+T]||0!==n[6+T]||0!==n[7+T]?(r=m*n[0+T]+128>>8,o=m*n[4+T]+128>>8,a=n[2+T],i=n[6+T],s=p*(n[1+T]-n[7+T])+128>>8,y=p*(n[1+T]+n[7+T])+128>>8,g=n[3+T]<<4,v=n[5+T]<<4,b=r-o+1>>1,r=r+o+1>>1,o=b,b=a*h+i*f+128>>8,a=a*f-i*h+128>>8,i=b,b=s-v+1>>1,s=s+v+1>>1,v=b,b=y+g+1>>1,g=y-g+1>>1,y=b,b=r-i+1>>1,r=r+i+1>>1,i=b,b=o-a+1>>1,o=o+a+1>>1,a=b,b=s*d+y*c+2048>>12,s=s*c-y*d+2048>>12,y=b,b=g*u+v*l+2048>>12,g=g*l-v*u+2048>>12,v=b,n[0+T]=r+y,n[7+T]=r-y,n[1+T]=o+v,n[6+T]=o-v,n[2+T]=a+g,n[5+T]=a-g,n[3+T]=i+s,n[4+T]=i-s):(b=m*n[0+T]+512>>10,n[0+T]=b,n[1+T]=b,n[2+T]=b,n[3+T]=b,n[4+T]=b,n[5+T]=b,n[6+T]=b,n[7+T]=b)}for(x=0;x<8;++x){var C=x;0!==n[8+C]||0!==n[16+C]||0!==n[24+C]||0!==n[32+C]||0!==n[40+C]||0!==n[48+C]||0!==n[56+C]?(r=m*n[0+C]+2048>>12,o=m*n[32+C]+2048>>12,a=n[16+C],i=n[48+C],s=p*(n[8+C]-n[56+C])+2048>>12,y=p*(n[8+C]+n[56+C])+2048>>12,g=n[24+C],v=n[40+C],b=r-o+1>>1,r=r+o+1>>1,o=b,b=a*h+i*f+2048>>12,a=a*f-i*h+2048>>12,i=b,b=s-v+1>>1,s=s+v+1>>1,v=b,b=y+g+1>>1,g=y-g+1>>1,y=b,b=r-i+1>>1,r=r+i+1>>1,i=b,b=o-a+1>>1,o=o+a+1>>1,a=b,b=s*d+y*c+2048>>12,s=s*c-y*d+2048>>12,y=b,b=g*u+v*l+2048>>12,g=g*l-v*u+2048>>12,v=b,n[0+C]=r+y,n[56+C]=r-y,n[8+C]=o+v,n[48+C]=o-v,n[16+C]=a+g,n[40+C]=a-g,n[24+C]=i+s,n[32+C]=i-s):(b=m*n[x+0]+8192>>14,n[0+C]=b,n[8+C]=b,n[16+C]=b,n[24+C]=b,n[32+C]=b,n[40+C]=b,n[48+C]=b,n[56+C]=b)}for(x=0;x<64;++x){var P=t+x,M=n[x];M=M<=-2056/e.bitConversion?0:M>=2024/e.bitConversion?255/e.bitConversion:M+2056/e.bitConversion>>4,e.blockData[P]=M}}function a(e,t){for(var r=t.blocksPerLine,a=t.blocksPerColumn,i=new Int32Array(64),s=0;s<a;s++)for(var l=0;l<r;l++)o(t,n(t,s,l),i);return t.blockData}function i(e){return e<=0?0:e>=255?255:0|e}var s=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),l=4017,u=799,c=3406,d=2276,f=1567,h=3784,m=5793,p=2896;return e.prototype={load:function(e){var t=function(e){this.parse(e),this.onload&&this.onload()}.bind(this);if(e.indexOf("data:")>-1){for(var n=e.indexOf("base64,")+7,r=atob(e.substring(n)),o=new Uint8Array(r.length),a=r.length-1;a>=0;a--)o[a]=r.charCodeAt(a);t(r)}else{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){var e=new Uint8Array(i.response);t(e)}.bind(this),i.send(null)}},parse:function(e){function n(){var t=e[l]<<8|e[l+1];return l+=2,t}var o,i,l=0,u=(e.length,null),c=null,d=[],f=[],h=[],m=n();if(65496!=m)throw"SOI not found";for(m=n();65497!=m;){var p,g;switch(m){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=function(){var t=n(),r=e.subarray(l,l+t-2);return l+=r.length,r}();65504===m&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(u={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65518===m&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(c={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var y=n()+l-2;l<y;){var b=e[l++],x=new Int32Array(64);if(b>>4==0)for(p=0;p<64;p++)x[s[p]]=e[l++];else{if(b>>4!=1)throw"DQT: invalid table spec";for(p=0;p<64;p++)x[s[p]]=n()}d[15&b]=x}break;case 65472:case 65473:case 65474:if(o)throw"Only single frame JPEGs supported";n(),(o={}).extended=65473===m,o.progressive=65474===m,o.precision=e[l++],o.scanLines=n(),o.samplesPerLine=n(),o.components=[],o.componentIds={};var w,T=e[l++],C=0,P=0;for(z=0;z<T;z++){w=e[l];var M=e[l+1]>>4,S=15&e[l+1];C<M&&(C=M),P<S&&(P=S);var I=e[l+2];g=o.components.push({h:M,v:S,quantizationTable:d[I],quantizationTableId:I,bitConversion:255/((1<<o.precision)-1)}),o.componentIds[w]=g-1,l+=3}o.maxH=C,o.maxV=P,function(e){for(var t=Math.ceil(e.samplesPerLine/8/e.maxH),n=Math.ceil(e.scanLines/8/e.maxV),r=0;r<e.components.length;r++){A=e.components[r];var o=Math.ceil(Math.ceil(e.samplesPerLine/8)*A.h/e.maxH),a=Math.ceil(Math.ceil(e.scanLines/8)*A.v/e.maxV),i=t*A.h,s=n*A.v*64*(i+1);A.blockData=new Int16Array(s),A.blocksPerLine=o,A.blocksPerColumn=a}e.mcusPerLine=t,e.mcusPerColumn=n}(o);break;case 65476:var D=n();for(z=2;z<D;){var E=e[l++],O=new Uint8Array(16),_=0;for(p=0;p<16;p++,l++)_+=O[p]=e[l];var k=new Uint8Array(_);for(p=0;p<_;p++,l++)k[p]=e[l];z+=17+_,(E>>4==0?h:f)[15&E]=t(O,k)}break;case 65501:n(),i=n();break;case 65498:n();var A,j=e[l++],R=[];for(z=0;z<j;z++){var $=o.componentIds[e[l++]];A=o.components[$];var L=e[l++];A.huffmanTableDC=h[L>>4],A.huffmanTableAC=f[15&L],R.push(A)}var B=e[l++],N=e[l++],F=e[l++],U=r(e,l,o,R,i,B,N,F>>4,15&F);l+=U;break;default:if(255==e[l-3]&&e[l-2]>=192&&e[l-2]<=254){l-=3;break}throw"unknown JPEG marker "+m.toString(16)}m=n()}switch(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=u,this.adobe=c,this.components=[],o.components.length){case 1:this.colorspace=ColorSpace.Grayscale;break;case 3:this.adobe?this.colorspace=ColorSpace.AdobeRGB:this.colorspace=ColorSpace.RGB;break;case 4:this.colorspace=ColorSpace.CYMK;break;default:this.colorspace=ColorSpace.Unknown}for(var z=0;z<o.components.length;z++)(A=o.components[z]).quantizationTable||null===A.quantizationTableId||(A.quantizationTable=d[A.quantizationTableId]),this.components.push({output:a(0,A),scaleX:A.h/o.maxH,scaleY:A.v/o.maxV,blocksPerLine:A.blocksPerLine,blocksPerColumn:A.blocksPerColumn,bitConversion:A.bitConversion})},getData16:function(e,t){if(1!==this.components.length)throw"Unsupported color mode";var r,o,a,i,s,l,u=this.width/e,c=this.height/t,d=0,f=this.components.length,h=e*t*f,m=new Uint16Array(h),p=new Uint16Array((this.components[0].blocksPerLine<<3)*this.components[0].blocksPerColumn*8);for(l=0;l<f;l++){for(var g,v,y=(r=this.components[l]).blocksPerLine,b=r.blocksPerColumn,x=y<<3,w=0,T=0;T<b;T++)for(var C=T<<3,P=0;P<y;P++){var M=n(r,T,P),d=0,S=P<<3;for(g=0;g<8;g++){w=(C+g)*x;for(v=0;v<8;v++)p[w+S+v]=r.output[M+d++]}}o=r.scaleX*u,a=r.scaleY*c,d=l;var I;for(s=0;s<t;s++)for(i=0;i<e;i++)I=(0|s*a)*x+(0|i*o),m[d]=p[I],d+=f}return m},getData:function(e,t){var r,o,a,s,l,u,c,d,f,h,m,p,g,v,y,b=this.width/e,x=this.height/t,w=0,T=this.components.length,C=e*t*T,P=new Uint8Array(C),M=new Uint8Array((this.components[0].blocksPerLine<<3)*this.components[0].blocksPerColumn*8);for(u=0;u<T;u++){for(var S,I,D=(r=this.components[u]).blocksPerLine,E=r.blocksPerColumn,O=D<<3,_=0,k=0;k<E;k++)for(var A=k<<3,j=0;j<D;j++){var R=n(r,k,j),w=0,$=j<<3;for(S=0;S<8;S++){_=(A+S)*O;for(I=0;I<8;I++)M[_+$+I]=r.output[R+w++]*r.bitConversion}}o=r.scaleX*b,a=r.scaleY*x,w=u;var L;for(l=0;l<t;l++)for(s=0;s<e;s++)L=(0|l*a)*O+(0|s*o),P[w]=M[L],w+=T}switch(T){case 1:case 2:break;case 3:if(y=!0,this.adobe&&this.adobe.transformCode?y=!0:void 0!==this.colorTransform&&(y=!!this.colorTransform),y)for(u=0;u<C;u+=T)c=P[u],d=P[u+1],p=i(c-179.456+1.402*(f=P[u+2])),g=i(c+135.459-.344*d-.714*f),v=i(c-226.816+1.772*d),P[u]=p,P[u+1]=g,P[u+2]=v;break;case 4:if(!this.adobe)throw"Unsupported color mode (4 components)";if(y=!1,this.adobe&&this.adobe.transformCode?y=!0:void 0!==this.colorTransform&&(y=!!this.colorTransform),y)for(u=0;u<C;u+=T)c=P[u],d=P[u+1],h=i(434.456-c-1.402*(f=P[u+2])),m=i(119.541-c+.344*d+.714*f),c=i(481.816-c-1.772*d),P[u]=h,P[u+1]=m,P[u+2]=c;break;default:throw"Unsupported color mode"}return P}},e}();!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).jpeg=e()}}(function(){return function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n||e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.ComponentSpec=r.lossless.ComponentSpec||function(){this.hSamp=0,this.quantTableSel=0,this.vSamp=0},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.ComponentSpec)},{}],2:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.DataStream=r.lossless.DataStream||function(e,t,n){this.buffer=new DataView(e,t,n),this.index=0},r.lossless.DataStream.prototype.get16=function(){var e=this.buffer.getUint16(this.index,!1);return this.index+=2,e},r.lossless.DataStream.prototype.get8=function(){var e=this.buffer.getUint8(this.index);return this.index+=1,e},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.DataStream)},{}],3:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.DataStream=r.lossless.DataStream||(void 0!==e?e("./data-stream.js"):null),r.lossless.HuffmanTable=r.lossless.HuffmanTable||(void 0!==e?e("./huffman-table.js"):null),r.lossless.QuantizationTable=r.lossless.QuantizationTable||(void 0!==e?e("./quantization-table.js"):null),r.lossless.ScanHeader=r.lossless.ScanHeader||(void 0!==e?e("./scan-header.js"):null),r.lossless.FrameHeader=r.lossless.FrameHeader||(void 0!==e?e("./frame-header.js"):null),r.lossless.Utils=r.lossless.Utils||(void 0!==e?e("./utils.js"):null),r.lossless.Decoder=r.lossless.Decoder||function(e,t){this.buffer=e,this.frame=new r.lossless.FrameHeader,this.huffTable=new r.lossless.HuffmanTable,this.quantTable=new r.lossless.QuantizationTable,this.scan=new r.lossless.ScanHeader,this.DU=r.lossless.Utils.createArray(10,4,64),this.HuffTab=r.lossless.Utils.createArray(4,2,12800),this.IDCT_Source=[],this.nBlock=[],this.acTab=r.lossless.Utils.createArray(10,1),this.dcTab=r.lossless.Utils.createArray(10,1),this.qTab=r.lossless.Utils.createArray(10,1),this.marker=0,this.markerIndex=0,this.numComp=0,this.restartInterval=0,this.selection=0,this.xDim=0,this.yDim=0,this.xLoc=0,this.yLoc=0,this.numBytes=0,this.outputData=null,this.restarting=!1,this.mask=0,void 0!==t&&(this.numBytes=t)},r.lossless.Decoder.IDCT_P=[0,5,40,16,45,2,7,42,21,56,8,61,18,47,1,4,41,23,58,13,32,24,37,10,63,17,44,3,6,43,20,57,15,34,29,48,53,26,39,9,60,19,46,22,59,12,33,31,50,55,25,36,11,62,14,35,28,49,52,27,38,30,51,54],r.lossless.Decoder.TABLE=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],r.lossless.Decoder.MAX_HUFFMAN_SUBTREE=50,r.lossless.Decoder.MSB=2147483648,r.lossless.Decoder.RESTART_MARKER_BEGIN=65488,r.lossless.Decoder.RESTART_MARKER_END=65495,r.lossless.Decoder.prototype.decompress=function(e,t,n){return this.decode(e,t,n).buffer},r.lossless.Decoder.prototype.decode=function(e,t,n,o){var a,i,s,l,u=0,c=[],d=[],f=[];if(void 0!==e&&(this.buffer=e),void 0!==o&&(this.numBytes=o),this.stream=new r.lossless.DataStream(this.buffer,t,n),this.buffer=null,this.xLoc=0,this.yLoc=0,65496!==(a=this.stream.get16()))throw new Error("Not a JPEG file");for(a=this.stream.get16();a>>4!=4092||65476===a;){switch(a){case 65476:this.huffTable.read(this.stream,this.HuffTab);break;case 65484:throw new Error("Program doesn't support arithmetic coding. (format throw new IOException)");case 65499:this.quantTable.read(this.stream,r.lossless.Decoder.TABLE);break;case 65501:this.restartInterval=this.readNumber();break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:this.readApp();break;case 65534:this.readComment();break;default:if(a>>8!=255)throw new Error("ERROR: format throw new IOException! (decode)")}a=this.stream.get16()}if(a<65472||a>65479)throw new Error("ERROR: could not handle arithmetic code!");this.frame.read(this.stream),a=this.stream.get16();do{for(;65498!==a;){switch(a){case 65476:this.huffTable.read(this.stream,this.HuffTab);break;case 65484:throw new Error("Program doesn't support arithmetic coding. (format throw new IOException)");case 65499:this.quantTable.read(this.stream,r.lossless.Decoder.TABLE);break;case 65501:this.restartInterval=this.readNumber();break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:this.readApp();break;case 65534:this.readComment();break;default:if(a>>8!=255)throw new Error("ERROR: format throw new IOException! (Parser.decode)")}a=this.stream.get16()}switch(this.precision=this.frame.precision,this.components=this.frame.components,this.numBytes||(this.numBytes=parseInt(Math.ceil(this.precision/8))),1==this.numBytes?this.mask=255:this.mask=65535,this.scan.read(this.stream),this.numComp=this.scan.numComp,this.selection=this.scan.selection,1===this.numBytes?3===this.numComp?(this.getter=this.getValueRGB,this.setter=this.setValueRGB,this.output=this.outputRGB):(this.getter=this.getValue8,this.setter=this.setValue8,this.output=this.outputSingle):(this.getter=this.getValue16,this.setter=this.setValue16,this.output=this.outputSingle),this.selection){case 2:this.selector=this.select2;break;case 3:this.selector=this.select3;break;case 4:this.selector=this.select4;break;case 5:this.selector=this.select5;break;case 6:this.selector=this.select6;break;case 7:this.selector=this.select7;break;default:this.selector=this.select1}for(this.scanComps=this.scan.components,this.quantTables=this.quantTable.quantTables,i=0;i<this.numComp;i+=1)s=this.scanComps[i].scanCompSel,this.qTab[i]=this.quantTables[this.components[s].quantTableSel],this.nBlock[i]=this.components[s].vSamp*this.components[s].hSamp,this.dcTab[i]=this.HuffTab[this.scanComps[i].dcTabSel][0],this.acTab[i]=this.HuffTab[this.scanComps[i].acTabSel][1];for(this.xDim=this.frame.dimX,this.yDim=this.frame.dimY,this.outputData=new DataView(new ArrayBuffer(this.xDim*this.yDim*this.numBytes*this.numComp)),u+=1;;){for(d[0]=0,f[0]=0,i=0;i<10;i+=1)c[i]=1<<this.precision-1;if(0===this.restartInterval){for(a=this.decodeUnit(c,d,f);0===a&&this.xLoc<this.xDim&&this.yLoc<this.yDim;)this.output(c),a=this.decodeUnit(c,d,f);break}for(l=0;l<this.restartInterval&&(this.restarting=0==l,a=this.decodeUnit(c,d,f),this.output(c),0===a);l+=1);if(0===a&&(0!==this.markerIndex?(a=65280|this.marker,this.markerIndex=0):a=this.stream.get16()),!(a>=r.lossless.Decoder.RESTART_MARKER_BEGIN&&a<=r.lossless.Decoder.RESTART_MARKER_END))break}65500===a&&1===u&&(this.readNumber(),a=this.stream.get16())}while(65497!==a&&this.xLoc<this.xDim&&this.yLoc<this.yDim&&0===u);return this.outputData},r.lossless.Decoder.prototype.decodeUnit=function(e,t,n){return 1==this.numComp?this.decodeSingle(e,t,n):3==this.numComp?this.decodeRGB(e,t,n):-1},r.lossless.Decoder.prototype.select1=function(e){return this.getPreviousX(e)},r.lossless.Decoder.prototype.select2=function(e){return this.getPreviousY(e)},r.lossless.Decoder.prototype.select3=function(e){return this.getPreviousXY(e)},r.lossless.Decoder.prototype.select4=function(e){return this.getPreviousX(e)+this.getPreviousY(e)-this.getPreviousXY(e)},r.lossless.Decoder.prototype.select5=function(e){return this.getPreviousX(e)+(this.getPreviousY(e)-this.getPreviousXY(e)>>1)},r.lossless.Decoder.prototype.select6=function(e){return this.getPreviousY(e)+(this.getPreviousX(e)-this.getPreviousXY(e)>>1)},r.lossless.Decoder.prototype.select7=function(e){return(this.getPreviousX(e)+this.getPreviousY(e))/2},r.lossless.Decoder.prototype.decodeRGB=function(e,t,n){var o,a,i,s,l,u,c,d;for(e[0]=this.selector(0),e[1]=this.selector(1),e[2]=this.selector(2),l=0;l<this.numComp;l+=1)for(s=this.qTab[l],a=this.acTab[l],i=this.dcTab[l],u=0;u<this.nBlock[l];u+=1){for(c=0;c<this.IDCT_Source.length;c+=1)this.IDCT_Source[c]=0;if((o=this.getHuffmanValue(i,t,n))>=65280)return o;for(e[l]=this.IDCT_Source[0]=e[l]+this.getn(n,o,t,n),this.IDCT_Source[0]*=s[0],d=1;d<64;d+=1){if((o=this.getHuffmanValue(a,t,n))>=65280)return o;if(d+=o>>4,0==(15&o)){if(o>>4==0)break}else this.IDCT_Source[r.lossless.Decoder.IDCT_P[d]]=this.getn(n,15&o,t,n)*s[d]}}return 0},r.lossless.Decoder.prototype.decodeSingle=function(e,t,n){var o,a,i,s;for(this.restarting?(this.restarting=!1,e[0]=1<<this.frame.precision-1):e[0]=this.selector(),a=0;a<this.nBlock[0];a+=1){if((o=this.getHuffmanValue(this.dcTab[0],t,n))>=65280)return o;if(i=this.getn(e,o,t,n),(s=i>>8)>=r.lossless.Decoder.RESTART_MARKER_BEGIN&&s<=r.lossless.Decoder.RESTART_MARKER_END)return s;e[0]+=i}return 0},r.lossless.Decoder.prototype.getHuffmanValue=function(e,t,n){var o,a;if(65535,n[0]<8?(t[0]<<=8,255===(a=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),t[0]|=a):n[0]-=8,0!=((o=e[t[0]>>n[0]])&r.lossless.Decoder.MSB)){if(0!==this.markerIndex)return this.markerIndex=0,65280|this.marker;t[0]&=65535>>16-n[0],t[0]<<=8,255===(a=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),t[0]|=a,o=e[256*(255&o)+(t[0]>>n[0])],n[0]+=8}if(n[0]+=8-(o>>8),n[0]<0)throw new Error("index="+n[0]+" temp="+t[0]+" code="+o+" in HuffmanValue()");return n[0]<this.markerIndex?(this.markerIndex=0,65280|this.marker):(t[0]&=65535>>16-n[0],255&o)},r.lossless.Decoder.prototype.getn=function(e,t,n,r){var o,a;if(1,-1,65535,0===t)return 0;if(16===t)return e[0]>=0?-32768:32768;if(r[0]-=t,r[0]>=0){if(r[0]<this.markerIndex&&!this.isLastPixel())return this.markerIndex=0,(65280|this.marker)<<8;o=n[0]>>r[0],n[0]&=65535>>16-r[0]}else{if(n[0]<<=8,255===(a=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),n[0]|=a,r[0]+=8,r[0]<0){if(0!==this.markerIndex)return this.markerIndex=0,(65280|this.marker)<<8;n[0]<<=8,255===(a=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),n[0]|=a,r[0]+=8}if(r[0]<0)throw new Error("index="+r[0]+" in getn()");if(r[0]<this.markerIndex)return this.markerIndex=0,(65280|this.marker)<<8;o=n[0]>>r[0],n[0]&=65535>>16-r[0]}return o<1<<t-1&&(o+=1+(-1<<t)),o},r.lossless.Decoder.prototype.getPreviousX=function(e){return this.xLoc>0?this.getter(this.yLoc*this.xDim+this.xLoc-1,e):this.yLoc>0?this.getPreviousY(e):1<<this.frame.precision-1},r.lossless.Decoder.prototype.getPreviousXY=function(e){return this.xLoc>0&&this.yLoc>0?this.getter((this.yLoc-1)*this.xDim+this.xLoc-1,e):this.getPreviousY(e)},r.lossless.Decoder.prototype.getPreviousY=function(e){return this.yLoc>0?this.getter((this.yLoc-1)*this.xDim+this.xLoc,e):this.getPreviousX(e)},r.lossless.Decoder.prototype.isLastPixel=function(){return this.xLoc===this.xDim-1&&this.yLoc===this.yDim-1},r.lossless.Decoder.prototype.outputSingle=function(e){this.xLoc<this.xDim&&this.yLoc<this.yDim&&(this.setter(this.yLoc*this.xDim+this.xLoc,this.mask&e[0]),this.xLoc+=1,this.xLoc>=this.xDim&&(this.yLoc+=1,this.xLoc=0))},r.lossless.Decoder.prototype.outputRGB=function(e){var t=this.yLoc*this.xDim+this.xLoc;this.xLoc<this.xDim&&this.yLoc<this.yDim&&(this.setter(t,e[0],0),this.setter(t,e[1],1),this.setter(t,e[2],2),this.xLoc+=1,this.xLoc>=this.xDim&&(this.yLoc+=1,this.xLoc=0))},r.lossless.Decoder.prototype.setValue16=function(e,t){this.outputData.setInt16(2*e,t,!0)},r.lossless.Decoder.prototype.getValue16=function(e){return this.outputData.getInt16(2*e,!0)&this.mask},r.lossless.Decoder.prototype.setValue8=function(e,t){this.outputData.setInt8(e,t)},r.lossless.Decoder.prototype.getValue8=function(e){return this.outputData.getInt8(e)&this.mask},r.lossless.Decoder.prototype.setValueRGB=function(e,t,n){this.outputData.setUint8(3*e+n,t)},r.lossless.Decoder.prototype.getValueRGB=function(e,t){return this.outputData.getUint8(3*e+t)},r.lossless.Decoder.prototype.readApp=function(){var e=0,t=this.stream.get16();for(e+=2;e<t;)this.stream.get8(),e+=1;return t},r.lossless.Decoder.prototype.readComment=function(){var e,t="",n=0;for(e=this.stream.get16(),n+=2;n<e;)t+=this.stream.get8(),n+=1;return t},r.lossless.Decoder.prototype.readNumber=function(){if(4!==this.stream.get16())throw new Error("ERROR: Define number format throw new IOException [Ld!=4]");return this.stream.get16()},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.Decoder)},{"./data-stream.js":2,"./frame-header.js":4,"./huffman-table.js":5,"./quantization-table.js":7,"./scan-header.js":9,"./utils.js":10}],4:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.ComponentSpec=r.lossless.ComponentSpec||(void 0!==e?e("./component-spec.js"):null),r.lossless.DataStream=r.lossless.DataStream||(void 0!==e?e("./data-stream.js"):null),r.lossless.FrameHeader=r.lossless.FrameHeader||function(){this.components=[],this.dimX=0,this.dimY=0,this.numComp=0,this.precision=0},r.lossless.FrameHeader.prototype.read=function(e){var t,n,o,a,i=0;for(t=e.get16(),i+=2,this.precision=e.get8(),i+=1,this.dimY=e.get16(),i+=2,this.dimX=e.get16(),i+=2,this.numComp=e.get8(),i+=1,n=1;n<=this.numComp;n+=1){if(i>t)throw new Error("ERROR: frame format error");if(o=e.get8(),(i+=1)>=t)throw new Error("ERROR: frame format error [c>=Lf]");a=e.get8(),i+=1,this.components[o]||(this.components[o]=new r.lossless.ComponentSpec),this.components[o].hSamp=a>>4,this.components[o].vSamp=15&a,this.components[o].quantTableSel=e.get8(),i+=1}if(i!==t)throw new Error("ERROR: frame format error [Lf!=count]");return 1},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.FrameHeader)},{"./component-spec.js":1,"./data-stream.js":2}],5:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.DataStream=r.lossless.DataStream||(void 0!==e?e("./data-stream.js"):null),r.lossless.Utils=r.lossless.Utils||(void 0!==e?e("./utils.js"):null),r.lossless.HuffmanTable=r.lossless.HuffmanTable||function(){this.l=r.lossless.Utils.createArray(4,2,16),this.th=[],this.v=r.lossless.Utils.createArray(4,2,16,200),this.tc=r.lossless.Utils.createArray(4,2),this.tc[0][0]=0,this.tc[1][0]=0,this.tc[2][0]=0,this.tc[3][0]=0,this.tc[0][1]=0,this.tc[1][1]=0,this.tc[2][1]=0,this.tc[3][1]=0,this.th[0]=0,this.th[1]=0,this.th[2]=0,this.th[3]=0},r.lossless.HuffmanTable.MSB=2147483648,r.lossless.HuffmanTable.prototype.read=function(e,t){var n,r,o,a,i,s,l=0;for(n=e.get16(),l+=2;l<n;){if(r=e.get8(),l+=1,(o=15&r)>3)throw new Error("ERROR: Huffman table ID > 3");if((a=r>>4)>2)throw new Error("ERROR: Huffman table [Table class > 2 ]");for(this.th[o]=1,this.tc[o][a]=1,i=0;i<16;i+=1)this.l[o][a][i]=e.get8(),l+=1;for(i=0;i<16;i+=1)for(s=0;s<this.l[o][a][i];s+=1){if(l>n)throw new Error("ERROR: Huffman table format error [count>Lh]");this.v[o][a][i][s]=e.get8(),l+=1}}if(l!==n)throw new Error("ERROR: Huffman table format error [count!=Lf]");for(i=0;i<4;i+=1)for(s=0;s<2;s+=1)0!==this.tc[i][s]&&this.buildHuffTable(t[i][s],this.l[i][s],this.v[i][s]);return 1},r.lossless.HuffmanTable.prototype.buildHuffTable=function(e,t,n){var o,a,i,s,l;for(256,a=0,i=0;i<8;i+=1)for(s=0;s<t[i];s+=1)for(l=0;l<256>>i+1;l+=1)e[a]=n[i][s]|i+1<<8,a+=1;for(i=1;a<256;i+=1,a+=1)e[a]=i|r.lossless.HuffmanTable.MSB;for(o=1,a=0,i=8;i<16;i+=1)for(s=0;s<t[i];s+=1){for(l=0;l<256>>i-7;l+=1)e[256*o+a]=n[i][s]|i+1<<8,a+=1;if(a>=256){if(a>256)throw new Error("ERROR: Huffman table error(1)!");a=0,o+=1}}},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.HuffmanTable)},{"./data-stream.js":2,"./utils.js":10}],6:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.ComponentSpec=r.lossless.ComponentSpec||(void 0!==e?e("./component-spec.js"):null),r.lossless.DataStream=r.lossless.DataStream||(void 0!==e?e("./data-stream.js"):null),r.lossless.Decoder=r.lossless.Decoder||(void 0!==e?e("./decoder.js"):null),r.lossless.FrameHeader=r.lossless.FrameHeader||(void 0!==e?e("./frame-header.js"):null),r.lossless.HuffmanTable=r.lossless.HuffmanTable||(void 0!==e?e("./huffman-table.js"):null),r.lossless.QuantizationTable=r.lossless.QuantizationTable||(void 0!==e?e("./quantization-table.js"):null),r.lossless.ScanComponent=r.lossless.ScanComponent||(void 0!==e?e("./scan-component.js"):null),r.lossless.ScanHeader=r.lossless.ScanHeader||(void 0!==e?e("./scan-header.js"):null),r.lossless.Utils=r.lossless.Utils||(void 0!==e?e("./utils.js"):null),"undefined"!==typeof t&&t.exports&&(t.exports=r)},{"./component-spec.js":1,"./data-stream.js":2,"./decoder.js":3,"./frame-header.js":4,"./huffman-table.js":5,"./quantization-table.js":7,"./scan-component.js":8,"./scan-header.js":9,"./utils.js":10}],7:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.DataStream=r.lossless.DataStream||(void 0!==e?e("./data-stream.js"):null),r.lossless.Utils=r.lossless.Utils||(void 0!==e?e("./utils.js"):null),r.lossless.QuantizationTable=r.lossless.QuantizationTable||function(){this.precision=[],this.tq=[],this.quantTables=r.lossless.Utils.createArray(4,64),this.tq[0]=0,this.tq[1]=0,this.tq[2]=0,this.tq[3]=0},r.lossless.QuantizationTable.enhanceQuantizationTable=function(e,t){var n;for(n=0;n<8;n+=1)e[t[0+n]]*=90,e[t[32+n]]*=90,e[t[16+n]]*=118,e[t[48+n]]*=49,e[t[40+n]]*=71,e[t[8+n]]*=126,e[t[56+n]]*=25,e[t[24+n]]*=106;for(n=0;n<8;n+=1)e[t[0+8*n]]*=90,e[t[4+8*n]]*=90,e[t[2+8*n]]*=118,e[t[6+8*n]]*=49,e[t[5+8*n]]*=71,e[t[1+8*n]]*=126,e[t[7+8*n]]*=25,e[t[3+8*n]]*=106;for(n=0;n<64;n+=1)e[n]>>=6},r.lossless.QuantizationTable.prototype.read=function(e,t){var n,o,a,i,s=0;for(n=e.get16(),s+=2;s<n;){if(o=e.get8(),s+=1,(a=15&o)>3)throw new Error("ERROR: Quantization table ID > 3");if(this.precision[a]=o>>4,0===this.precision[a])this.precision[a]=8;else{if(1!==this.precision[a])throw new Error("ERROR: Quantization table precision error");this.precision[a]=16}if(this.tq[a]=1,8===this.precision[a]){for(i=0;i<64;i+=1){if(s>n)throw new Error("ERROR: Quantization table format error");this.quantTables[a][i]=e.get8(),s+=1}r.lossless.QuantizationTable.enhanceQuantizationTable(this.quantTables[a],t)}else{for(i=0;i<64;i+=1){if(s>n)throw new Error("ERROR: Quantization table format error");this.quantTables[a][i]=e.get16(),s+=2}r.lossless.QuantizationTable.enhanceQuantizationTable(this.quantTables[a],t)}}if(s!==n)throw new Error("ERROR: Quantization table error [count!=Lq]");return 1},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.QuantizationTable)},{"./data-stream.js":2,"./utils.js":10}],8:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.ScanComponent=r.lossless.ScanComponent||function(){this.acTabSel=0,this.dcTabSel=0,this.scanCompSel=0},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.ScanComponent)},{}],9:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.DataStream=r.lossless.DataStream||(void 0!==e?e("./data-stream.js"):null),r.lossless.ScanComponent=r.lossless.ScanComponent||(void 0!==e?e("./scan-component.js"):null),r.lossless.ScanHeader=r.lossless.ScanHeader||function(){this.ah=0,this.al=0,this.numComp=0,this.selection=0,this.spectralEnd=0,this.components=[]},r.lossless.ScanHeader.prototype.read=function(e){var t,n,o,a=0;for(t=e.get16(),a+=2,this.numComp=e.get8(),a+=1,n=0;n<this.numComp;n+=1){if(this.components[n]=new r.lossless.ScanComponent,a>t)throw new Error("ERROR: scan header format error");this.components[n].scanCompSel=e.get8(),a+=1,o=e.get8(),a+=1,this.components[n].dcTabSel=o>>4,this.components[n].acTabSel=15&o}if(this.selection=e.get8(),a+=1,this.spectralEnd=e.get8(),a+=1,o=e.get8(),this.ah=o>>4,this.al=15&o,(a+=1)!==t)throw new Error("ERROR: scan header format error [count!=Ns]");return 1},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.ScanHeader)},{"./data-stream.js":2,"./scan-component.js":8}],10:[function(e,t,n){"use strict";var r=r||{};r.lossless=r.lossless||{},r.lossless.Utils=r.lossless.Utils||{},r.lossless.Utils.createArray=function(e){var t=new Array(e||0),n=e;if(arguments.length>1)for(var o=Array.prototype.slice.call(arguments,1);n--;)t[e-1-n]=r.lossless.Utils.createArray.apply(this,o);return t},r.lossless.Utils.makeCRCTable=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t},r.lossless.Utils.crc32=function(e){for(var t=r.lossless.Utils.crcTable||(r.lossless.Utils.crcTable=r.lossless.Utils.makeCRCTable()),n=-1,o=0;o<e.byteLength;o++)n=n>>>8^t[255&(n^e.getUint8(o))];return(-1^n)>>>0},"undefined"!==typeof t&&t.exports&&(t.exports=r.lossless.Utils)},{}]},{},[6])(6)}),function(e,t,n){"use strict";function r(e){return(255&e)<<8|e>>8&255}function o(e,t,n){var r=e.elements.x7fe00010,o=e.uint16("x00280010"),a=e.uint16("x00280011"),i=e.uint16("x00280002"),s=r.dataOffset,l=a*o*i;if(!l)throw"Sanity check failed when calculating the number of pixels";var u=0;if(1===n){if((u=s+t*l)>=e.byteArray.length)throw"frame exceeds size of pixelData";return new Uint8Array(e.byteArray.buffer,u,l)}if(2===n){if((u=s+t*l*2)>=e.byteArray.length)throw"frame exceeds size of pixelData";return new Uint16Array(e.byteArray.buffer,u,l)}if(3===n){if((u=s+t*l*2)>=e.byteArray.length)throw"frame exceeds size of pixelData";return new Int16Array(e.byteArray.buffer,u,l)}throw"Unknown pixel format"}n.extractUncompressedPixels=function(e,t,a){var i=n.getPixelFormat(e),s=o(e,t,i);if(a&&(2===i||3===i))for(var l=0;l<s.length;l++)s[l]=r(s[l]);return s}}($,cornerstone,cornerstoneWADOImageLoader),function(e,t,n){"use strict";function r(e){return e.intString("x00280008")>1}function o(e){if(e.intString("x00280008")!=e.elements.x7fe00010.fragments.length)return!0}function a(e,t){var n=e.elements.x7fe00010;if(r(e)){if(o(e))throw"multi-frame sop instance with no basic offset table is not currently supported";return dicomParser.readEncapsulatedPixelDataFromFragments(e,n,t)}var a=n.fragments.length;return dicomParser.readEncapsulatedPixelDataFromFragments(e,n,0,a)}n.getEncodedImageFrame=function(e,t){return e.elements.x7fe00010.basicOffsetTable.length?dicomParser.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t):a(e,t)}}($,cornerstone,cornerstoneWADOImageLoader),function(e){"use strict";e.getMinMax=function(e){for(var t=65535,n=-32768,r=e.length,o=e,a=0;a<r;a++){var i=o[a];t=Math.min(t,i),n=Math.max(n,i)}return{min:t,max:n}}}(cornerstoneWADOImageLoader),function(e){"use strict";e.getPixelFormat=function(e){var t=e.uint16("x00280103"),n=e.uint16("x00280100");return 0===t&&8===n?1:0===t&&16===n?2:1===t&&16===n?3:void 0}}(cornerstoneWADOImageLoader),function(e){"use strict";e.getPixelSpacing=function(e){var t=e.string("x00280030");if(t&&t.length>0){var n=t.split("\\");if(parseFloat(n[0])&&parseFloat(n[1]))return{row:parseFloat(n[0]),column:parseFloat(n[1])}}return{row:void 0,column:void 0}}}(cornerstoneWADOImageLoader),function(e){"use strict";e.getRescaleSlopeAndIntercept=function(e){var t={intercept:0,slope:1};return e.elements.x00281052&&e.elements.x00281053&&(t.intercept=e.floatString("x00281052")||t.intercept,t.slope=e.floatString("x00281053")||t.slope),t}}(cornerstoneWADOImageLoader),function(e){"use strict";e.getWindowWidthAndCenter=function(e){var t={windowCenter:void 0,windowWidth:void 0};return e.elements.x00281050&&e.elements.x00281051&&(t.windowCenter=e.floatString("x00281050"),t.windowWidth=e.floatString("x00281051")),t}}(cornerstoneWADOImageLoader),function(e,t,n){"use strict";t.registerImageLoader("dicomfile",n.internal.loadImage)}($,cornerstone,cornerstoneWADOImageLoader),function(e){"use strict";var t=[];e.fileManager={add:function(e){return"dicomfile:"+(t.push(e)-1)},get:function(e){return t[e]},remove:function(e){t[e]=void 0},purge:function(){t=[]}}}(cornerstoneWADOImageLoader),function(e,t,n){"use strict";n.internal.loadFileRequest=function(t){var r=n.parseImageId(t),o=parseInt(r.url),a=n.fileManager.get(o),i=e.Deferred(),s=new FileReader;return s.onload=function(e){var t=e.target.result,n=new Uint8Array(t),r=dicomParser.parseDicom(n);i.resolve(r)},s.readAsArrayBuffer(a),i.promise()}}($,cornerstone,cornerstoneWADOImageLoader),function(e){function t(e,t,n){if(n+e.length>t.length)return!1;for(var r=n,o=0;o<e.length;o++)if(e[o]!==t[r++])return!1;return!0}function n(e){for(var t=new Uint8Array(e.length),n=0,r=e.length;n<r;n++)t[n]=e.charCodeAt(n);return t}e.internal.findIndexOfString=function(e,r,o){o=o||0;for(var a=n(r),i=o;i<e.length;i++)if(a[0]===e[i]&&t(a,e,i))return i;return-1}}(cornerstoneWADOImageLoader),function(e){"use strict";function t(e){for(var t=0;t<e.length;t++)if("--"===e[t].substr(0,2))return e[t]}function n(e){for(var t=0;t<e.length;t++)if("Content-Type:"===e[t].substr(0,13))return e[t].substr(13).trim()}function r(e,t,n){t=t||0,n=n||e.length-t;for(var r="",o=t;o<t+n;o++)r+=String.fromCharCode(e[o]);return r}e.internal.getImageFrame=function(o,a){a=a||"application/octet-stream";var i=$.Deferred(),s=new XMLHttpRequest;return s.responseType="arraybuffer",s.open("get",o,!0),s.setRequestHeader("Accept","multipart/related;type="+a),s.onreadystatechange=function(o){if(4===s.readyState)if(200===s.status){var a=s.response,l=new Uint8Array(s.response),u=e.internal.findIndexOfString(l,"\n\r\n");-1===u&&i.reject("invalid response - no multipart mime header");var c=r(l,0,u).split("\r\n"),d=t(c);d||i.reject("invalid response - no boundary marker");var f=u+4,h=e.internal.findIndexOfString(l,d,f);-1===h&&i.reject("invalid response - terminating boundary not found");var m=h-f-1;i.resolve({contentType:n(c),arrayBuffer:a,offset:f,length:m})}else i.reject(s.response)},s.send(),i.promise()}}(cornerstoneWADOImageLoader),function(e){"use strict";var t=[];e.imageManager={add:function(e){return"wadors:"+(t.push(e)-1)},get:function(e){return t[e]},remove:function(e){t[e]=void 0},purge:function(){t=[]}}}(cornerstoneWADOImageLoader),function(e,t,n){"use strict";t.registerImageLoader("wadors",function(r){var o=e.Deferred(),a=r.substring(7),i=n.imageManager.get(a);if(void 0===i)return o.reject("unknown imageId"),o.promise();return n.internal.getImageFrame(i.uri,void 0).then(function(e){var a;16===i.instance.bitsAllocated?a=0===i.instance.pixelRepresentation?new Uint16Array(e.arrayBuffer,e.offset,e.length/2):new Int16Array(e.arrayBuffer,e.offset,e.length/2):8===i.instance.bitsAllocated&&(a=new Uint8Array(e.arrayBuffer,e.offset,e.length));var s=n.getMinMax(a);i.imageId=r,i.minPixelValue=s.min,i.maxPixelValue=s.max,i.render=t.renderGrayscaleImage,i.getPixelData=function(){return a},o.resolve(i)}).fail(function(e){o.reject(e)}),o.promise()})}($,cornerstone,cornerstoneWADOImageLoader),function(e,t,n){"use strict";t.registerImageLoader("dicomweb",n.internal.loadImage),t.registerImageLoader("wadouri",n.internal.loadImage)}($,cornerstone,cornerstoneWADOImageLoader),function(e){"use strict";e.isColorImage=function(e){return"RGB"===e||"PALETTE COLOR"===e||"YBR_FULL"===e||"YBR_FULL_422"===e||"YBR_PARTIAL_422"===e||"YBR_PARTIAL_420"===e||"YBR_RCT"===e||"YBR_ICT"===e}}(cornerstoneWADOImageLoader),function(e,t,n){"use strict";function r(e,t){if(!0===n.isJPEGBaseline8Bit(e))return n.decodeJPEGBaseline8Bit(o,e,t);var r=n.decodeTransferSyntax(e,t);return n.convertColorSpace(o,e,r)}var o=document.createElement("canvas"),a="";n.makeColorImage=function(i,s,l,u){var c=n.getPixelSpacing(s),d=s.uint16("x00280010"),f=s.uint16("x00280011"),h=n.getRescaleSlopeAndIntercept(s),m=s.byteArray.length,p=n.getWindowWidthAndCenter(s);a=void 0;var g,v=e.Deferred();try{g=r(s,l)}catch(e){return v.reject(e),v.promise()}return g.then(function(e){var r={imageId:i,minPixelValue:0,maxPixelValue:255,slope:h.slope,intercept:h.intercept,windowCenter:p.windowCenter,windowWidth:p.windowWidth,render:t.renderColorImage,getPixelData:function(){return e.data},getImageData:function(){return e},getCanvas:function(){return a===i?o:(o.height=d,o.width=f,o.getContext("2d").putImageData(e,0,0),a=i,o)},rows:d,columns:f,height:d,width:f,color:!0,columnPixelSpacing:c.column,rowPixelSpacing:c.row,data:s,invert:!1,sizeInBytes:m,sharedCacheKey:u};(void 0===r.windowCenter||isNaN(r.windowCenter)||void 0===r.windowWidth||isNaN(r.windowWidth))&&(r.windowWidth=255,r.windowCenter=128),n.internal.options.imageCreated&&n.internal.options.imageCreated(r),v.resolve(r)},function(e){v.reject(e)}),v.promise()}}($,cornerstone,cornerstoneWADOImageLoader),function(e,t,n){"use strict";function r(e){var t=n.getPixelFormat(e);if(1===t)return 1;if(2===t||3===t)return 2;throw"unknown pixel format"}function o(e,t,n){var r=n.uint16("x00283002",0);0===r&&(r=65535);for(var o=0,a={id:"1",firstValueMapped:o=0===t?n.uint16("x00283002",1):n.int16("x00283002",1),numBitsPerEntry:n.uint16("x00283002",2),lut:[]},i=0;i<r;i++)a.lut[i]=0===t?n.uint16("x00283006",i):n.int16("x00283006",i);return a}function a(e){var t=e.string("x00080016");return"1.2.840.10008.5.1.4.1.1.12.1"!==t&&"1.2.840.10008.5.1.4.1.1.12.2.1 "!==t}n.makeGrayscaleImage=function(i,s,l,u){var c=e.Deferred(),d=n.getPixelSpacing(s),f=s.uint16("x00280010"),h=s.uint16("x00280011"),m=n.getRescaleSlopeAndIntercept(s);try{r(s)}catch(e){return c.reject(e),c.promise()}var p,g=s.byteArray.length,v="MONOCHROME1"===s.string("x00280004"),y=n.getWindowWidthAndCenter(s);try{p=n.decodeTransferSyntax(s,l)}catch(e){return c.reject(e),c.promise()}var b=n.getMinMax(p),x={imageId:i,minPixelValue:b.min,maxPixelValue:b.max,slope:m.slope,intercept:m.intercept,windowCenter:y.windowCenter,windowWidth:y.windowWidth,render:t.renderGrayscaleImage,getPixelData:function(){return p},rows:f,columns:h,height:f,width:h,color:!1,columnPixelSpacing:d.column,rowPixelSpacing:d.row,data:s,invert:v,sizeInBytes:g,sharedCacheKey:u},w=s.uint16("x00280103");if(s.elements.x00283000&&a(s)&&(x.modalityLUT=o(x,w,s.elements.x00283000.items[0].dataSet)),s.elements.x00283010&&(w=0,x.minPixelValue*x.slope+x.intercept<0&&(w=1),x.voiLUT=o(x,w,s.elements.x00283010.items[0].dataSet)),void 0===x.windowCenter||isNaN(x.windowCenter)||void 0===x.windowWidth||isNaN(x.windowWidth)){var T=x.maxPixelValue*x.slope+x.intercept,C=x.minPixelValue*x.slope+x.intercept;x.windowWidth=T-C,x.windowCenter=(T+C)/2}return n.internal.options.imageCreated&&n.internal.options.imageCreated(x),c.resolve(x),c.promise()}}($,cornerstone,cornerstoneWADOImageLoader),function(e){"use strict";e.parseImageId=function(e){var t,n=e.indexOf(":"),r=e.substring(n+1),o=r.indexOf("frame=");if(-1!==o){var a=r.substr(o+6);t=parseInt(a),r=r.substr(0,o-1)}return{scheme:e.substr(0,n),url:r,frame:t}}}(cornerstoneWADOImageLoader),function(e){"use strict";e.version="0.13.3"}(cornerstoneWADOImageLoader),function(e,t,n){"use strict";n.internal.xhrRequest=function(r,o){var a=e.Deferred(),i=new XMLHttpRequest;return i.open("get",r,!0),i.responseType="arraybuffer",n.internal.options.beforeSend(i),i.onreadystatechange=function(e){if(4===i.readyState)if(200===i.status){var t=i.response,n=new Uint8Array(t),r=dicomParser.parseDicom(n);a.resolve(r)}else a.reject(i)},i.onprogress=function(n){if(n.lengthComputable){var r=n.loaded,a=n.total,i=Math.round(r/a*100);e(t).trigger("CornerstoneImageLoadProgress",{imageId:o,loaded:r,total:a,percentComplete:i})}},i.send(),a.promise()}}($,cornerstone,cornerstoneWADOImageLoader),function(e,t){"function"==typeof define&&define.amd?define([],function(){return{isoContours:t()}}):"object"==typeof module&&module.exports?module.exports={isoContours:t()}:e.MarchingSquaresJS={isoContours:t(),isoBands:e.MarchingSquaresJS?e.MarchingSquaresJS.isoBands:null}}(this,function(){function e(e,t,n){return(e-t)/(n-t)}function t(t,n){for(var r=t.length-1,o=t[0].length-1,a={rows:r,cols:o,cells:[]},i=0;i<r;++i){a.cells[i]=[];for(var s=0;s<o;++s){var l=0,u=t[i+1][s],c=t[i+1][s+1],d=t[i][s+1],f=t[i][s];if(!(isNaN(u)||isNaN(c)||isNaN(d)||isNaN(f))){l|=u>=n?8:0,l|=c>=n?4:0,l|=d>=n?2:0;var h=!1;if(5===(l|=f>=n?1:0)||10===l){var m=(u+c+d+f)/4;5===l&&m<n?(l=10,h=!0):10===l&&m<n&&(l=5,h=!0)}if(0!=l&&15!=l){var p,g,v,y;p=g=v=y=.5,1===l?(v=1-e(n,u,f),g=1-e(n,d,f)):2===l?(g=e(n,f,d),y=1-e(n,c,d)):3===l?(v=1-e(n,u,f),y=1-e(n,c,d)):4===l?(p=e(n,u,c),y=e(n,d,c)):5===l?(p=e(n,u,c),y=e(n,d,c),g=1-e(n,d,f),v=1-e(n,u,f)):6===l?(g=e(n,f,d),p=e(n,u,c)):7===l?(v=1-e(n,u,f),p=e(n,u,c)):8===l?(v=e(n,f,u),p=1-e(n,c,u)):9===l?(g=1-e(n,d,f),p=1-e(n,c,u)):10===l?(p=1-e(n,c,u),y=1-e(n,c,d),g=e(n,f,d),v=e(n,f,u)):11===l?(p=1-e(n,c,u),y=1-e(n,c,d)):12===l?(v=e(n,f,u),y=e(n,d,c)):13===l?(g=1-e(n,d,f),y=e(n,d,c)):14===l?(v=e(n,f,u),g=e(n,f,d)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+l),a.cells[i][s]={cval:l,flipped:h,top:p,right:y,bottom:g,left:v}}}}}return a}function n(e){return 5===e.cval||10===e.cval}function r(e){return 0===e.cval||15===e.cval}function o(e){r(e)||5===e.cval||10===e.cval||(e.cval=15)}function a(e,t){return"top"===t?[e.top,1]:"bottom"===t?[e.bottom,0]:"right"===t?[1,e.right]:"left"===t?[0,e.left]:void 0}function i(e){var t=[],o=0;e.rows,e.cols;return e.cells.forEach(function(a,i){a.forEach(function(a,l){if(void 0!==a&&!n(a)&&!r(a)){var u=s(e.cells,i,l),c=!1;if("mergeable"===u.info)for(var d=u.path[u.path.length-1][0],f=u.path[u.path.length-1][1],h=o-1;h>=0;h--)if(Math.abs(t[h][0][0]-d)<=1e-7&&Math.abs(t[h][0][1]-f)<=1e-7){for(var m=u.path.length-2;m>=0;--m)t[h].unshift(u.path[m]);c=!0;break}c||(t[o++]=u.path)}})}),t}function s(e,t,n){var r,i,s,l=e.length,u=[],c=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],d=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],f=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],h=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],m=(e[t][n],e[t][n]),p=m.cval,g=a(m,s=f[p]);u.push([n+g[0],t+g[1]]),g=a(m,s=h[p]),u.push([n+g[0],t+g[1]]),o(m);for(var v=n+c[p],y=t+d[p],b=p;v>=0&&y>=0&&y<l&&(v!=n||y!=t)&&void 0!==(m=e[y][v]);){if(0===(p=m.cval)||15===p)return{path:u,info:"mergeable"};s=h[p],r=c[p],i=d[p],5!==p&&10!==p||(5===p?m.flipped?-1===d[b]?(s="left",r=-1,i=0):(s="right",r=1,i=0):-1===c[b]&&(s="bottom",r=0,i=-1):10===p&&(m.flipped?-1===c[b]?(s="top",r=0,i=1):(s="bottom",r=0,i=-1):1===d[b]&&(s="left",r=-1,i=0))),g=a(m,s),u.push([v+g[0],y+g[1]]),o(m),v+=r,y+=i,b=p}return{path:u,info:"closed"}}var l={successCallback:null,verbose:!1},u={};return function(e,n,r){r=r||{};for(var o=Object.keys(l),a=0;a<o.length;a++){var s=o[a],c=r[s];c=void 0!==c&&null!==c?c:l[s],u[s]=c}u.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+n);var d=i(t(e,n));return"function"==typeof u.successCallback&&u.successCallback(d),d}}),function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):e.jQuery)}(this,function(e){"use strict";function t(t,n){-1===e.inArray(n,["horizontal","vertical","both"])&&e.error("Flip value must be one of horizontal, vertical or both");var r,o=e("<canvas />")[0];return o.width=t.width,o.height=t.height,r=o.getContext("2d"),"horizontal"!==n&&"both"!==n||(r.translate(t.width,0),r.scale(-1,1)),"vertical"!==n&&"both"!==n||(r.translate(0,t.height),r.scale(1,-1)),r.drawImage(t,0,0,t.width,t.height),o}var n=function(t,n){var r=0,o=0;return"string"!=typeof t&&e.error("Hotspot value is not a string and could not be parsed"),"number"!=typeof n&&e.error("Cursor size must be a number"),t.split(" ").forEach(function(e){switch(e){case"center":r=n/2,o=n/2;break;case"top":o=0;break;case"bottom":o=n-1;break;case"left":r=0;break;case"right":r=n-1}}),[r,o]};e.fn.extend({awesomeCursor:function(r,o){o=e.extend({},e.fn.awesomeCursor.defaults,o),"string"==typeof r&&r||e.error("First parameter must be the icon name, e.g. 'pencil'"),o.size="string"==typeof o.size?parseInt(o.size,10):o.size,"string"==typeof o.hotspot&&(o.hotspot=n(o.hotspot,o.size)),o.hotspot=e.map(o.hotspot,function(e){return Math.min(o.size-1,Math.max(0,e))});var a=function(e,t){return"string"==typeof t?t.replace(/%s/g,e):"function"==typeof t?t(e):e}(r,o.font.cssClass),i=e("<i />",{class:a,style:"display: inline; font-size: "+o.size+"px;"}),s=e("<div />",{style:"position: absolute; left: -9999px; top: -9999px;"}).append(i);e("body").append(s);var l,u,c,d=window.getComputedStyle(i[0],":before").getPropertyValue("content"),f=i[0].getBoundingClientRect(),h=e("<canvas />")[0],m=Math.max(f.width,f.height);return i.remove(),o.outline&&(m+=2),o.rotate?(l=((m=Math.ceil(Math.sqrt(Math.pow(m,2)+Math.pow(m,2))))-o.size)/2,h.width=m,h.height=m,(c=h.getContext("2d")).translate(h.width/2,h.height/2),c.rotate(o.rotate*Math.PI/180),c.translate(-h.width/2,-h.height/2),o.hotspot[0]+=o.hotspot[0]!==h.width/2?l:0,o.hotspot[1]+=o.hotspot[1]!==h.height/2?l:0):(h.height=m,h.width=m,c=h.getContext("2d")),d=d.replace(/['"]/g,""),c.fillStyle=o.color,c.font=o.size+"px "+o.font.family,c.textAlign="center",c.textBaseline="middle",c.fillText(d,m/2,m/2),o.outline&&(c.lineWidth=.5,c.strokeStyle=o.outline,c.strokeText(d,m/2,m/2)),o.flip&&(h=t(h,o.flip)),u=h.toDataURL("image/png"),e(this).css("cursor","").css("cursor",["url("+u+")",o.hotspot[0],o.hotspot[1],",","auto"].join(" ")),this}}),e.fn.awesomeCursor.defaults={color:"#000000",size:18,hotspot:[0,0],flip:"",rotate:0,outline:null,font:{family:"iconfont",cssClass:"iconfont icon-%s"}}});